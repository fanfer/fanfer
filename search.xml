<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>QGControl</title>
      <link href="/2024/12/04/Fine-Turn-BLIP2%20copy/"/>
      <url>/2024/12/04/Fine-Turn-BLIP2%20copy/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.notion.so/14bf894c1a27810b8ae6e23c1d668e06?pvs=21">Code Docs</a></p><p><a href="https://www.notion.so/Documentation-14bf894c1a2780a6a7c6c80eb0ff334a?pvs=21">Documentation</a></p><h1 id="documentation">Documentation</h1><h1 id="å›¾åƒç›¸å…³">å›¾åƒç›¸å…³</h1><blockquote><p>ğŸ“˜ ImageProtocolManageræ˜¯ä¸€ä¸ªç”¨äºå¤„ç†MAVLinkå›¾åƒä¼ è¾“åè®®çš„ç±»ï¼Œä¸»è¦ç”¨äºæ¥æ”¶å’Œå¤„ç†æ¥è‡ªå…‰æµç›¸æœºç­‰è®¾å¤‡çš„å›¾åƒæ•°æ®ã€‚ä»¥ä¸‹æ˜¯å…¶ä¸»è¦å·¥ä½œæµç¨‹ï¼š</p></blockquote><h3 id="1-åŸºæœ¬ç»„æˆ">1. åŸºæœ¬ç»„æˆ</h3><ul><li>ä¸¤ä¸ªä¸»è¦æˆå‘˜å˜é‡ï¼š<ul><li><code>_imageHandshake</code>: å­˜å‚¨å›¾åƒä¼ è¾“æ¡æ‰‹ä¿¡æ¯</li><li><code>_imageBytes</code>: å­˜å‚¨æ¥æ”¶åˆ°çš„å›¾åƒæ•°æ®</li></ul></li></ul><h3 id="2-å›¾åƒæ¥æ”¶æµç¨‹">2. å›¾åƒæ¥æ”¶æµç¨‹</h3><ol><li><strong>æ¡æ‰‹é˜¶æ®µ</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> MAVLINK_MSG_ID_DATA_TRANSMISSION_HANDSHAKE:</span><br></pre></td></tr></table></figure><ul><li>æ¥æ”¶<code>DATA_TRANSMISSION_HANDSHAKE</code>æ¶ˆæ¯</li><li>æ¸…ç©ºä¹‹å‰çš„å›¾åƒæ•°æ®</li><li>è®°å½•æ–°å›¾åƒçš„åŸºæœ¬ä¿¡æ¯ï¼ˆç±»å‹ã€å®½åº¦ã€é«˜åº¦ç­‰ï¼‰</li></ul><ol><li><strong>æ•°æ®ä¼ è¾“é˜¶æ®µ</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> MAVLINK_MSG_ID_ENCAPSULATED_DATA:</span><br></pre></td></tr></table></figure><ul><li>æ¥æ”¶<code>ENCAPSULATED_DATA</code>æ¶ˆæ¯</li><li>æ ¹æ®åºå·(<code>seqnr</code>)å°†æ•°æ®æ”¾å…¥æ­£ç¡®çš„ä½ç½®</li><li>é€šè¿‡<code>_imageHandshake.packets</code>è®¡æ•°è¿½è¸ªä¼ è¾“å®Œæˆæƒ…å†µ</li><li>å½“æ‰€æœ‰æ•°æ®åŒ…æ¥æ”¶å®Œæˆæ—¶ï¼Œå‘å‡º<code>imageReady</code>ä¿¡å·</li></ul><ol><li><strong>å›¾åƒè·å–</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QImage <span class="title">ImageProtocolManager::getImage</span><span class="params">(<span class="type">void</span>)</span></span></span><br></pre></td></tr></table></figure><p>æ”¯æŒå¤šç§å›¾åƒæ ¼å¼ï¼š</p><ul><li>RAW8U/RAW32Uï¼šæ„å»ºPGMæ ¼å¼</li><li>BMP/JPEG/PGM/PNGï¼šç›´æ¥åŠ è½½</li><li>è¿”å›QImageå¯¹è±¡</li></ul><h3 id="3-ä½¿ç”¨ç¤ºä¾‹">3. ä½¿ç”¨ç¤ºä¾‹</h3><p>å‡è®¾æ‚¨è¦åœ¨ä»£ç ä¸­ä½¿ç”¨è¿™ä¸ªç±»ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºå®ä¾‹</span></span><br><span class="line">ImageProtocolManager* imageManager = <span class="keyword">new</span> <span class="built_in">ImageProtocolManager</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿æ¥ä¿¡å·</span></span><br><span class="line"><span class="built_in">connect</span>(imageManager, &amp;ImageProtocolManager::imageReady, <span class="keyword">this</span>, [=]() &#123;</span><br><span class="line">    QImage image = imageManager-&gt;<span class="built_in">getImage</span>();</span><br><span class="line">    <span class="comment">// å¤„ç†æ¥æ”¶åˆ°çš„å›¾åƒ</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¥æ”¶MAVLinkæ¶ˆæ¯æ—¶</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">onMavlinkMessageReceived</span><span class="params">(<span class="type">mavlink_message_t</span> message)</span> </span>&#123;</span><br><span class="line">    imageManager-&gt;<span class="built_in">mavlinkMessageReceived</span>(message);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="4-é”™è¯¯å¤„ç†">4. é”™è¯¯å¤„ç†</h3><p>è¯¥ç±»åŒ…å«å¤šä¸ªé”™è¯¯æ£€æŸ¥ï¼š</p><ul><li>æ£€æŸ¥æ˜¯å¦æœ‰æœªå®Œæˆçš„å‰åºä¼ è¾“</li><li>éªŒè¯æ•°æ®åŒ…åºå·æ˜¯å¦æœ‰æ•ˆ</li><li>æ£€æŸ¥å›¾åƒæ•°æ®å®Œæ•´æ€§</li><li>æ”¯æŒçš„å›¾åƒæ ¼å¼éªŒè¯</li></ul><h3 id="5-æ³¨æ„äº‹é¡¹">5. æ³¨æ„äº‹é¡¹</h3><ul><li>å›¾åƒä¼ è¾“å¿…é¡»æŒ‰ç…§é¡ºåºï¼šå…ˆæ¡æ‰‹ï¼Œåæ•°æ®</li><li>åœ¨è°ƒç”¨<code>getImage()</code>ä¹‹å‰ç¡®ä¿å›¾åƒä¼ è¾“å®Œæˆ</li><li>æ”¯æŒå¤šç§å›¾åƒæ ¼å¼ï¼Œä½†å¯¹äºRAWæ ¼å¼éœ€è¦ç‰¹æ®Šå¤„ç†</li></ul><p>è¿™ä¸ªç±»çš„è®¾è®¡éµå¾ªäº†MAVLinkå›¾åƒä¼ è¾“åè®®è§„èŒƒ</p><ol><li><strong>ImageProtocolManagerçš„å±€é™æ€§</strong></li></ol><ul><li>ImageProtocolManageråªæ˜¯ä¸€ä¸ªæ¥æ”¶å’Œå¤„ç†å›¾åƒæ•°æ®çš„å·¥å…·</li><li>å®ƒä¸èƒ½ä¸»åŠ¨è§¦å‘æ‹ç…§æ“ä½œ</li><li>å®ƒåªè´Ÿè´£æ¥æ”¶å’Œå¤„ç†MAVLinkä¼ è¾“çš„å›¾åƒæ•°æ®</li></ul><ol><li><strong>æ­£ç¡®çš„æ‹ç…§æµç¨‹</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PhotoCapture</span> : <span class="keyword">public</span> QObject &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">PhotoCapture</span>(Vehicle* vehicle) &#123;</span><br><span class="line">        <span class="comment">// 1. åˆ›å»ºç›¸æœºæ§åˆ¶å™¨ï¼ˆç”¨äºè§¦å‘æ‹ç…§ï¼‰</span></span><br><span class="line">        _cameraControl = vehicle-&gt;<span class="built_in">cameraManager</span>()-&gt;<span class="built_in">currentCameraInstance</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. åˆ›å»ºå›¾åƒæ¥æ”¶å™¨ï¼ˆç”¨äºæ¥æ”¶å›¾åƒæ•°æ®ï¼‰</span></span><br><span class="line">        _imageManager = <span class="keyword">new</span> <span class="built_in">ImageProtocolManager</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. è¿æ¥vehicleçš„æ¶ˆæ¯åˆ°å›¾åƒç®¡ç†å™¨</span></span><br><span class="line">        <span class="built_in">connect</span>(vehicle, &amp;Vehicle::mavlinkMessageReceived,</span><br><span class="line">                _imageManager, &amp;ImageProtocolManager::mavlinkMessageReceived);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4. å¤„ç†æ¥æ”¶åˆ°çš„å›¾åƒ</span></span><br><span class="line">        <span class="built_in">connect</span>(_imageManager, &amp;ImageProtocolManager::imageReady,</span><br><span class="line">                <span class="keyword">this</span>, &amp;PhotoCapture::handleImageReceived);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">capturePhoto</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (_cameraControl) &#123;</span><br><span class="line">            _cameraControl-&gt;<span class="built_in">takePhoto</span>();  <span class="comment">// è§¦å‘æ‹ç…§</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">handleImageReceived</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        QImage image = _imageManager-&gt;<span class="built_in">getImage</span>();</span><br><span class="line">        <span class="keyword">if</span> (!image.<span class="built_in">isNull</span>()) &#123;</span><br><span class="line">            QString filename = <span class="built_in">QString</span>(<span class="string">&quot;photo_%1.jpg&quot;</span>)</span><br><span class="line">                .<span class="built_in">arg</span>(QDateTime::<span class="built_in">currentDateTime</span>().<span class="built_in">toString</span>(<span class="string">&quot;yyyyMMdd_hhmmss&quot;</span>));</span><br><span class="line">            image.<span class="built_in">save</span>(filename);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    QGCCameraControl* _cameraControl;</span><br><span class="line">    ImageProtocolManager* _imageManager;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li><strong>ä¸ºä»€ä¹ˆéœ€è¦ç›¸æœºæ§åˆ¶</strong></li></ol><ul><li>ç›¸æœºéœ€è¦æ¥æ”¶æ‹ç…§å‘½ä»¤æ‰ä¼šå¼€å§‹æ‹ç…§</li><li>ç›¸æœºæ§åˆ¶å™¨å¤„ç†ç›¸æœºçš„çŠ¶æ€å’Œå‚æ•°è®¾ç½®</li><li>ç›¸æœºæ§åˆ¶å™¨æä¾›æ‹ç…§åé¦ˆå’ŒçŠ¶æ€æ›´æ–°</li></ul><ol><li><strong>å®Œæ•´çš„æœ€å°å®ç°</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœ€ç®€å•çš„æ‹ç…§å®ç°</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MinimalPhotoCapture</span> : <span class="keyword">public</span> QObject &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MinimalPhotoCapture</span>(Vehicle* vehicle) : _vehicle(vehicle) &#123;</span><br><span class="line">        <span class="comment">// è®¾ç½®å›¾åƒæ¥æ”¶å™¨</span></span><br><span class="line">        _imageManager = <span class="keyword">new</span> <span class="built_in">ImageProtocolManager</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¿æ¥å¿…è¦çš„ä¿¡å·</span></span><br><span class="line">        <span class="built_in">connect</span>(_vehicle, &amp;Vehicle::mavlinkMessageReceived,</span><br><span class="line">                _imageManager, &amp;ImageProtocolManager::mavlinkMessageReceived);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">connect</span>(_imageManager, &amp;ImageProtocolManager::imageReady,</span><br><span class="line">                <span class="keyword">this</span>, &amp;MinimalPhotoCapture::onImageReady);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">takePhoto</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// å¿…é¡»é€šè¿‡ç›¸æœºæ§åˆ¶å‘é€æ‹ç…§å‘½ä»¤</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">auto</span> camera = _vehicle-&gt;<span class="built_in">cameraManager</span>()-&gt;<span class="built_in">currentCameraInstance</span>()) &#123;</span><br><span class="line">            camera-&gt;<span class="built_in">takePhoto</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">onImageReady</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ä¿å­˜æ¥æ”¶åˆ°çš„å›¾åƒ</span></span><br><span class="line">        QImage image = _imageManager-&gt;<span class="built_in">getImage</span>();</span><br><span class="line">        <span class="keyword">if</span> (!image.<span class="built_in">isNull</span>()) &#123;</span><br><span class="line">            image.<span class="built_in">save</span>(<span class="string">&quot;captured_photo.jpg&quot;</span>);</span><br><span class="line">            <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;Photo saved successfully&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Vehicle* _vehicle;</span><br><span class="line">    ImageProtocolManager* _imageManager;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li><strong>ä½¿ç”¨ç¤ºä¾‹</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨æ–¹æ³•</span></span><br><span class="line">Vehicle* vehicle = ...;  <span class="comment">// è·å–vehicleå®ä¾‹</span></span><br><span class="line">MinimalPhotoCapture* photoCapture = <span class="keyword">new</span> <span class="built_in">MinimalPhotoCapture</span>(vehicle);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‹ç…§</span></span><br><span class="line">photoCapture-&gt;<span class="built_in">takePhoto</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æ€»ç»“æ¥è¯´ï¼š</p><ul><li>ä¸èƒ½åªä½¿ç”¨ImageProtocolManageræ¥å®Œæˆæ‹ç…§</li><li>éœ€è¦é€šè¿‡ç›¸æœºæ§åˆ¶å™¨å‘é€æ‹ç…§å‘½ä»¤</li><li>ImageProtocolManagerè´Ÿè´£æ¥æ”¶å’Œå¤„ç†å›¾åƒæ•°æ®</li><li>ä¸¤è€…é…åˆæ‰èƒ½å®Œæˆå®Œæ•´çš„æ‹ç…§æµç¨‹</li></ul><p>å»ºè®®ï¼š</p><ol><li>å¦‚æœåªéœ€è¦ç®€å•æ‹ç…§åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨ä¸Šé¢çš„MinimalPhotoCaptureå®ç°</li><li>å¦‚æœéœ€è¦æ›´å¤šç›¸æœºæ§åˆ¶åŠŸèƒ½ï¼ˆå¦‚è®¾ç½®å‚æ•°ã€æ¨¡å¼ç­‰ï¼‰ï¼Œåˆ™ä½¿ç”¨å®Œæ•´çš„ç›¸æœºæ§åˆ¶ç³»ç»Ÿ</li><li>å§‹ç»ˆéœ€è¦åŒæ—¶ä½¿ç”¨ç›¸æœºæ§åˆ¶å’ŒImageProtocolManager</li></ol><h1 id="å¤šæ™ºèƒ½ä½“">å¤šæ™ºèƒ½ä½“</h1><p>MultiVehicleManageræ˜¯ä¸€ä¸ªæ ¸å¿ƒç®¡ç†ç±»ï¼Œè´Ÿè´£ç®¡ç†å’Œåè°ƒå¤šä¸ªè½¦è¾†(Vehicle)ã€‚</p><h3 id="1-æ ¸å¿ƒåŠŸèƒ½">1. æ ¸å¿ƒåŠŸèƒ½</h3><ol><li><strong>è½¦è¾†ç®¡ç†</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MultiVehicleManager</span> : <span class="keyword">public</span> QGCTool &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    QList&lt;Vehicle*&gt;    _vehicles;           <span class="comment">// ç®¡ç†æ‰€æœ‰è½¦è¾†</span></span><br><span class="line">    Vehicle*           _activeVehicle;      <span class="comment">// å½“å‰æ´»åŠ¨è½¦è¾†</span></span><br><span class="line">    <span class="type">bool</span>              _activeVehicleAvailable;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li><strong>é€šä¿¡ç®¡ç†</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> MultiVehicleManager::_sendGCSHeartbeat(<span class="type">void</span>) &#123;</span><br><span class="line">    <span class="comment">// å‘æ‰€æœ‰è¿æ¥çš„è½¦è¾†å‘é€å¿ƒè·³åŒ…</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;sharedLinks.<span class="built_in">count</span>(); i++) &#123;</span><br><span class="line">        LinkInterface* link = sharedLinks[i].<span class="built_in">get</span>();</span><br><span class="line">        <span class="keyword">if</span> (link-&gt;<span class="built_in">isConnected</span>()) &#123;</span><br><span class="line">            <span class="type">mavlink_message_t</span> message;</span><br><span class="line">            <span class="built_in">mavlink_msg_heartbeat_pack_chan</span>(...);</span><br><span class="line">            link-&gt;<span class="built_in">writeBytesThreadSafe</span>((<span class="type">const</span> <span class="type">char</span>*)buffer, len);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li><strong>ç¼–é˜Ÿæ§åˆ¶åè°ƒ</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> MultiVehicleManager::_mainWork(<span class="type">void</span>) &#123;</span><br><span class="line">    <span class="comment">// å¤„ç†ä¸åŒç¼–é˜Ÿæ¨¡å¼</span></span><br><span class="line">    <span class="keyword">switch</span>(bs_multi_model) &#123;</span><br><span class="line">        <span class="keyword">case</span> Single:</span><br><span class="line">            <span class="comment">// å•èˆ¹æ¨¡å¼</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> Multi8:</span><br><span class="line">            <span class="comment">// å¤šèˆ¹ç¼–é˜Ÿæ¨¡å¼</span></span><br><span class="line">            <span class="keyword">if</span>(multi_start_flag) &#123;</span><br><span class="line">                <span class="comment">// æ”¶é›†æ‰€æœ‰èˆ¹åªä¿¡æ¯</span></span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i&lt;_vehicles.<span class="built_in">count</span>(); i++) &#123;</span><br><span class="line">                    Vehicle *v = <span class="built_in">qobject_cast</span>&lt;Vehicle*&gt;(_vehicles[i]);</span><br><span class="line">                    LBAgent agent;</span><br><span class="line">                    agent.id = v-&gt;<span class="built_in">id</span>();</span><br><span class="line">                    agent.lat = v-&gt;lat;</span><br><span class="line">                    agent.lon = v-&gt;lon;</span><br><span class="line">                    <span class="comment">// ... å…¶ä»–å‚æ•°</span></span><br><span class="line">                    _allagent.<span class="built_in">push_back</span>(agent);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// æ‰§è¡Œç¼–é˜Ÿæ§åˆ¶</span></span><br><span class="line">                vector&lt;LBActor&gt; all_actor =</span><br><span class="line">                    _multiAgentController.<span class="built_in">FaultFormationControl2</span>(_allagent, formation_gap);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// åˆ†å‘æ§åˆ¶æŒ‡ä»¤</span></span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i&lt;_vehicles.<span class="built_in">count</span>(); i++) &#123;</span><br><span class="line">                    Vehicle *v = <span class="built_in">qobject_cast</span>&lt;Vehicle*&gt;(_vehicles[i]);</span><br><span class="line">                    v-&gt;<span class="built_in">receiveMultiParameters</span>(control_data);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-å…³é”®èŒè´£">2. å…³é”®èŒè´£</h3><ol><li><strong>çŠ¶æ€ç®¡ç†</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç®¡ç†å„ç§æ§åˆ¶æ¨¡å¼æ ‡å¿—</span></span><br><span class="line"><span class="type">bool</span> _manipulate_connect_flag;  <span class="comment">// æ“æ§æ¨¡å¼</span></span><br><span class="line"><span class="type">bool</span> _logic_connect_flag;       <span class="comment">// é€»è¾‘æ¨¡å¼</span></span><br><span class="line"><span class="type">bool</span> _virtual_connect_flag;     <span class="comment">// è™šæ‹Ÿæ¨¡å¼</span></span><br><span class="line"><span class="type">bool</span> multi_start_flag;          <span class="comment">// ç¼–é˜Ÿå¯åŠ¨æ ‡å¿—</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li><strong>ä»»åŠ¡åè°ƒ</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">MultiVehicleManager::setMissionItems</span><span class="params">(<span class="type">const</span> QList&lt;MissionItem*&gt;&amp; items)</span> </span>&#123;</span><br><span class="line">    _allMissionItems = items;</span><br><span class="line">    set_mission_flag = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€šçŸ¥ç¼–é˜Ÿæ§åˆ¶å™¨</span></span><br><span class="line">    vector&lt;LBMission&gt; missions;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i&lt;_allMissionItems.<span class="built_in">count</span>(); i++) &#123;</span><br><span class="line">        MissionItem* item = _allMissionItems[i];</span><br><span class="line">        LBMission mis;</span><br><span class="line">        mis.lat = item-&gt;<span class="built_in">param5</span>();</span><br><span class="line">        mis.lon = item-&gt;<span class="built_in">param6</span>();</span><br><span class="line">        missions.<span class="built_in">push_back</span>(mis);</span><br><span class="line">    &#125;</span><br><span class="line">    _multiAgentController.<span class="built_in">MissionGet</span>(missions);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li><strong>æ¨¡å¼åˆ‡æ¢ç®¡ç†</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">MultiVehicleManager::switchControlMode</span><span class="params">(ControlMode mode)</span> </span>&#123;</span><br><span class="line">    bs_control_model = mode;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ–­å¼€å…¶ä»–æ¨¡å¼è¿æ¥</span></span><br><span class="line">    <span class="keyword">if</span>(_manipulate_connect_flag) <span class="built_in">manipulateDisconnect</span>();</span><br><span class="line">    <span class="keyword">if</span>(_logic_connect_flag) <span class="built_in">logicDisconnect</span>();</span><br><span class="line">    <span class="keyword">if</span>(_virtual_connect_flag) <span class="built_in">virtualDisconnect</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å»ºç«‹æ–°æ¨¡å¼è¿æ¥</span></span><br><span class="line">    <span class="keyword">switch</span>(mode) &#123;</span><br><span class="line">        <span class="keyword">case</span> Manipulate:</span><br><span class="line">            <span class="built_in">manipulateConnect</span>();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> Logic:</span><br><span class="line">            <span class="built_in">logicConnect</span>();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> Virtual:</span><br><span class="line">            <span class="built_in">virtualConnect</span>();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-ä½¿ç”¨ç¤ºä¾‹">3. ä½¿ç”¨ç¤ºä¾‹</h3><ol><li><strong>åˆå§‹åŒ–å¤šèˆ¹ç³»ç»Ÿ</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºç®¡ç†å™¨</span></span><br><span class="line">MultiVehicleManager* manager = <span class="keyword">new</span> <span class="built_in">MultiVehicleManager</span>(app, toolbox);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®ç¼–é˜Ÿæ¨¡å¼</span></span><br><span class="line">manager-&gt;<span class="built_in">setMultiModel</span>(Multi8);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®æ§åˆ¶æ¨¡å¼</span></span><br><span class="line">manager-&gt;<span class="built_in">setControlModel</span>(Manipulate);</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li><strong>æ‰§è¡Œç¼–é˜Ÿä»»åŠ¡</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¾ç½®ä»»åŠ¡ç‚¹</span></span><br><span class="line">QList&lt;MissionItem*&gt; missionItems;</span><br><span class="line"><span class="comment">// ... æ·»åŠ ä»»åŠ¡ç‚¹</span></span><br><span class="line">manager-&gt;<span class="built_in">setMissionItems</span>(missionItems);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯åŠ¨ç¼–é˜Ÿ</span></span><br><span class="line">manager-&gt;<span class="built_in">startMultiFormation</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="4-é‡è¦æ¥å£">4. é‡è¦æ¥å£</h3><ol><li><strong>è½¦è¾†ç®¡ç†æ¥å£</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Vehicle* <span class="title">getVehicleById</span><span class="params">(<span class="type">int</span> vehicleId)</span></span>;</span><br><span class="line"><span class="function">Vehicle* <span class="title">activeVehicle</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function">QList&lt;Vehicle*&gt; <span class="title">vehicles</span><span class="params">()</span></span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li><strong>æ§åˆ¶æ¥å£</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">setMultiModel</span><span class="params">(MultiModel model)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setControlModel</span><span class="params">(ControlModel model)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">startMultiFormation</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">stopMultiFormation</span><span class="params">()</span></span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li><strong>çŠ¶æ€ç›‘æ§æ¥å£</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isMultiFormationActive</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isVehicleAvailable</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">vehicleAdded</span><span class="params">(Vehicle* vehicle)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">vehicleRemoved</span><span class="params">(Vehicle* vehicle)</span></span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="5-æ³¨æ„äº‹é¡¹">5. æ³¨æ„äº‹é¡¹</h3><ol><li>ç¡®ä¿æ‰€æœ‰è½¦è¾†éƒ½å·²æ­£ç¡®è¿æ¥å’Œåˆå§‹åŒ–</li><li>åœ¨åˆ‡æ¢æ¨¡å¼å‰æ£€æŸ¥å½“å‰çŠ¶æ€</li><li>å¤„ç†é€šä¿¡å»¶è¿Ÿå’Œä¸¢å¤±æƒ…å†µ</li><li>ä¿æŒå¿ƒè·³åŒ…çš„å®šæœŸå‘é€</li><li>æ­£ç¡®å¤„ç†å¼‚å¸¸æƒ…å†µå’Œé”™è¯¯æ¢å¤</li></ol><p>MultiVehicleManageræ˜¯æ•´ä¸ªå¤šè½¦è¾†ç³»ç»Ÿçš„ä¸­æ¢ï¼Œå®ƒåè°ƒå„ä¸ªå­ç³»ç»Ÿçš„å·¥ä½œï¼Œç¡®ä¿æ•´ä¸ªç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œã€‚åœ¨è¿›è¡Œç¼–é˜Ÿæ§åˆ¶æ—¶ï¼Œå®ƒæ‰®æ¼”ç€&quot;æŒ‡æŒ¥å®˜&quot;çš„è§’è‰²ï¼Œè´Ÿè´£åè°ƒå„ä¸ªè½¦è¾†çš„è¡ŒåŠ¨ã€‚</p><h1 id="ç¼–é˜Ÿæ§åˆ¶">ç¼–é˜Ÿæ§åˆ¶</h1><h3 id="1-æ ¸å¿ƒç±»çš„åŠŸèƒ½">1. æ ¸å¿ƒç±»çš„åŠŸèƒ½</h3><ol><li><strong>MultiAgentFormation</strong></li></ol><ul><li>ä½œä¸ºç¼–é˜Ÿæ§åˆ¶çš„ä¸»è¦æ¥å£ç±»</li><li>ç®¡ç†ä¸åŒç±»å‹çš„ç¼–é˜Ÿæ§åˆ¶å™¨</li><li>æä¾›å¤šç§ç¼–é˜Ÿæ¨¡å¼çš„åˆ‡æ¢åŠŸèƒ½</li></ul><ol><li><strong>VSFormationControl</strong></li></ol><ul><li>å®ç°åŸºç¡€çš„ç¼–é˜Ÿæ§åˆ¶ç®—æ³•</li><li>æ”¯æŒå¤šç§ç¼–é˜Ÿå½¢çŠ¶ï¼ˆæ–¹å½¢ã€Cå­—å‹ã€çºµæ’ã€ä¸‰è§’å½¢ç­‰ï¼‰</li><li>å¤„ç†ç›®æ ‡ç‚¹è®¡ç®—å’Œé€Ÿåº¦æ§åˆ¶</li></ul><h3 id="2-ç¼–é˜Ÿæ¨¡å¼">2. ç¼–é˜Ÿæ¨¡å¼</h3><p>ä»ä»£ç ä¸­å¯ä»¥çœ‹åˆ°å¤šç§ç¼–é˜Ÿæ¨¡å¼ï¼š</p><ol><li><strong>åŸºç¡€ç¼–é˜Ÿæ¨¡å¼</strong> (VSFormationControl::VSFormationCalculate)</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span>(formationModel) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>: <span class="comment">// æ–¹å½¢ç¼–é˜Ÿ</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>: <span class="comment">// Cå­—å‹ç¼–é˜Ÿ</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>: <span class="comment">// çºµæ’ç¼–é˜Ÿ</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>: <span class="comment">// ä¸‰è§’å½¢ç¼–é˜Ÿ</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li><strong>ç‰¹æ®Šç¼–é˜Ÿæ¨¡å¼</strong></li></ol><ul><li>HUSTMoveFormation: ç§»åŠ¨ç¼–é˜Ÿ</li><li>HUSTSearchFormation: æœç´¢ç¼–é˜Ÿ</li><li>HUSTExpelFormation: é©±ç¦»ç¼–é˜Ÿ</li><li>FaultFormation: å®¹é”™ç¼–é˜Ÿ</li></ul><h3 id="3-ç¼–é˜Ÿåˆ‡æ¢æ–¹æ³•">3. ç¼–é˜Ÿåˆ‡æ¢æ–¹æ³•</h3><p>è¦å®Œæˆç¼–é˜Ÿåˆ‡æ¢ï¼Œéœ€è¦ï¼š</p><ol><li><strong>è®¾ç½®ç¼–é˜Ÿæ¨¡å¼</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨MultiVehicleManagerä¸­</span></span><br><span class="line"><span class="keyword">if</span>(bs_multi_model == Multi3) &#123;  <span class="comment">// é€‰æ‹©ç¼–é˜Ÿæ¨¡å¼</span></span><br><span class="line">    <span class="comment">// è®¾ç½®ç¼–é˜Ÿå‚æ•°</span></span><br><span class="line">    control_data.work_model = Mission;</span><br><span class="line">    control_data.formation_flag = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨å¯¹åº”çš„ç¼–é˜Ÿæ§åˆ¶å™¨</span></span><br><span class="line">    all_missions = _multiAgentController.<span class="built_in">HUSTMoveFormationControl</span>(_allagent, formation_gap);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li><strong>åˆ‡æ¢æ­¥éª¤</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. åˆ›å»ºç¼–é˜Ÿæ§åˆ¶å™¨</span></span><br><span class="line">MultiAgentFormation _multiAgentController;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. è®¾ç½®ä»»åŠ¡ç‚¹</span></span><br><span class="line">vector&lt;LBMission&gt; missions;</span><br><span class="line"><span class="comment">// æ·»åŠ ä»»åŠ¡ç‚¹...</span></span><br><span class="line">_multiAgentController.<span class="built_in">MissionGet</span>(missions);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. é€‰æ‹©ç¼–é˜Ÿæ¨¡å¼å¹¶æ‰§è¡Œ</span></span><br><span class="line"><span class="comment">// ä¾‹å¦‚åˆ‡æ¢åˆ°ç§»åŠ¨ç¼–é˜Ÿ:</span></span><br><span class="line">vector&lt;vector&lt;LBMission&gt;&gt; all_missions = _multiAgentController.<span class="built_in">HUSTMoveFormationControl</span>(_allagent, formation_gap);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–åˆ‡æ¢åˆ°æœç´¢ç¼–é˜Ÿ:</span></span><br><span class="line">all_missions = _multiAgentController.<span class="built_in">HUSTSearchFormationControl</span>(_allagent, formation_gap);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="4-ç¼–é˜Ÿåˆ‡æ¢çš„å…³é”®å‚æ•°">4. ç¼–é˜Ÿåˆ‡æ¢çš„å…³é”®å‚æ•°</h3><ol><li><strong>æ§åˆ¶æ ‡å¿—</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">control_data.work_model    <span class="comment">// å·¥ä½œæ¨¡å¼</span></span><br><span class="line">control_data.work_state   <span class="comment">// å·¥ä½œçŠ¶æ€</span></span><br><span class="line">control_data.formation_flag <span class="comment">// ç¼–é˜Ÿæ ‡å¿—</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li><strong>ç¼–é˜Ÿå‚æ•°</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">formation_gap  <span class="comment">// ç¼–é˜Ÿé—´è·</span></span><br><span class="line">refreshFlag    <span class="comment">// åˆ·æ–°æ ‡å¿—</span></span><br><span class="line">multi_start_flag <span class="comment">// ç¼–é˜Ÿå¯åŠ¨æ ‡å¿—</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="5-å®é™…ä½¿ç”¨ç¤ºä¾‹">5. å®é™…ä½¿ç”¨ç¤ºä¾‹</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ‡æ¢åˆ°ç§»åŠ¨ç¼–é˜Ÿ</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">switchToMoveFormation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1. è®¾ç½®æ§åˆ¶å‚æ•°</span></span><br><span class="line">    control_data.work_model = Mission;</span><br><span class="line">    control_data.work_state = USVRun;</span><br><span class="line">    control_data.formation_flag = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. è®¾ç½®ä»»åŠ¡ç‚¹</span></span><br><span class="line">    <span class="keyword">if</span>(set_mission_flag) &#123;</span><br><span class="line">        vector&lt;LBMission&gt; missions;</span><br><span class="line">        <span class="comment">// æ·»åŠ ä»»åŠ¡ç‚¹...</span></span><br><span class="line">        _multiAgentController.<span class="built_in">MissionGet</span>(missions);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. æ‰§è¡Œç¼–é˜Ÿæ§åˆ¶</span></span><br><span class="line">    vector&lt;vector&lt;LBMission&gt;&gt; all_missions =</span><br><span class="line">        _multiAgentController.<span class="built_in">HUSTMoveFormationControl</span>(_allagent, formation_gap);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. ä¸ºæ¯ä¸ªèˆ¹åªåˆ†é…ä»»åŠ¡</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; _vehicles.<span class="built_in">count</span>(); i++) &#123;</span><br><span class="line">        Vehicle *v = <span class="built_in">qobject_cast</span>&lt;Vehicle*&gt;(_vehicles[i]);</span><br><span class="line">        <span class="keyword">if</span>(all_missions.<span class="built_in">size</span>() &gt; i) &#123;</span><br><span class="line">            v-&gt;<span class="built_in">MissionGet</span>(<span class="built_in">convertToMissionItems</span>(all_missions[i]));</span><br><span class="line">        &#125;</span><br><span class="line">        v-&gt;<span class="built_in">receiveMultiParameters</span>(control_data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ç›´æ¥é€šè¿‡grabimage-æ–¹æ³•å®ç°">ç›´æ¥é€šè¿‡grabImage()æ–¹æ³•å®ç°</h1><p>å¯ä»¥ç›´æ¥ä½¿ç”¨VideoManagerçš„grabImage()æ–¹æ³•æ¥è·å–å›¾ç‰‡ã€‚è¿™ä¸ªæ–¹æ³•ç›¸å¯¹ç®€å•,ä¸éœ€è¦ç›´æ¥æ“ä½œæ‘„åƒå¤´æ§åˆ¶ã€‚</p><h3 id="1-grabimage-æ–¹æ³•åˆ†æ">1. grabImage() æ–¹æ³•åˆ†æ</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">VideoManager::grabImage</span><span class="params">(<span class="type">const</span> QString&amp; imageFile)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 1. æ£€æŸ¥è§†é¢‘æ¥æ”¶å™¨æ˜¯å¦å¯ç”¨</span></span><br><span class="line">    <span class="keyword">if</span> (!_videoReceiver[<span class="number">0</span>] &amp;&amp; !_videoReceiver[<span class="number">2</span>]) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. è®¾ç½®ä¿å­˜è·¯å¾„</span></span><br><span class="line">    <span class="keyword">if</span> (imageFile.<span class="built_in">isEmpty</span>()) &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨é»˜è®¤è·¯å¾„å’Œæ–‡ä»¶å</span></span><br><span class="line">        _imageFile = <span class="built_in">qgcApp</span>()-&gt;<span class="built_in">toolbox</span>()-&gt;<span class="built_in">settingsManager</span>()-&gt;<span class="built_in">appSettings</span>()-&gt;<span class="built_in">photoSavePath</span>();</span><br><span class="line">        _imageFile += <span class="string">&quot;/&quot;</span> + QDateTime::<span class="built_in">currentDateTime</span>().<span class="built_in">toString</span>(<span class="string">&quot;yyyy-MM-dd_hh.mm.ss.zzz&quot;</span>) + <span class="string">&quot;.jpg&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        _imageFile = imageFile;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">emit <span class="title">imageFileChanged</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. æ•è·å›¾åƒ</span></span><br><span class="line">    _videoReceiver[<span class="number">0</span>]-&gt;<span class="built_in">takeScreenshot</span>(_imageFile);</span><br><span class="line">    _videoReceiver[<span class="number">2</span>]-&gt;<span class="built_in">takeScreenshot</span>(_imageFile);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-ä½¿ç”¨ç¤ºä¾‹">2. ä½¿ç”¨ç¤ºä¾‹</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨MultiVehicleManagerä¸­æ·»åŠ æ‹ç…§æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MultiVehicleManager::captureImage</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    VideoManager* videoManager = <span class="built_in">qgcApp</span>()-&gt;<span class="built_in">toolbox</span>()-&gt;<span class="built_in">videoManager</span>();</span><br><span class="line">    <span class="keyword">if</span> (videoManager) &#123;</span><br><span class="line">        <span class="comment">// æ–¹å¼1: ä½¿ç”¨é»˜è®¤è·¯å¾„</span></span><br><span class="line">        videoManager-&gt;<span class="built_in">grabImage</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ–¹å¼2: æŒ‡å®šä¿å­˜è·¯å¾„</span></span><br><span class="line">        QString customPath = <span class="string">&quot;path/to/your/photo.jpg&quot;</span>;</span><br><span class="line">        videoManager-&gt;<span class="built_in">grabImage</span>(customPath);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="4-ä½¿ç”¨æ³¨æ„äº‹é¡¹">4. ä½¿ç”¨æ³¨æ„äº‹é¡¹</h3><ol><li><strong>ç¡®ä¿è§†é¢‘æµå·²å¯åŠ¨</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!videoManager-&gt;<span class="built_in">streaming</span>()) &#123;</span><br><span class="line">    videoManager-&gt;<span class="built_in">startVideo</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li><strong>æ£€æŸ¥ä¿å­˜è·¯å¾„</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">QString photoPath = <span class="built_in">qgcApp</span>()-&gt;<span class="built_in">toolbox</span>()-&gt;<span class="built_in">settingsManager</span>()-&gt;<span class="built_in">appSettings</span>()-&gt;<span class="built_in">photoSavePath</span>();</span><br><span class="line"><span class="function">QDir <span class="title">dir</span><span class="params">(photoPath)</span></span>;</span><br><span class="line"><span class="keyword">if</span> (!dir.<span class="built_in">exists</span>()) &#123;</span><br><span class="line">    dir.<span class="built_in">mkpath</span>(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li><strong>å¤„ç†é”™è¯¯æƒ…å†µ</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">connect</span>(videoManager, &amp;VideoManager::imageFileChanged, <span class="keyword">this</span>, [=]() &#123;</span><br><span class="line">    QString imageFile = videoManager-&gt;<span class="built_in">imageFile</span>();</span><br><span class="line">    <span class="keyword">if</span> (QFile::<span class="built_in">exists</span>(imageFile)) &#123;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;Image saved successfully:&quot;</span> &lt;&lt; imageFile;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">qWarning</span>() &lt;&lt; <span class="string">&quot;Failed to save image&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="5-å»ºè®®çš„å®Œæ•´å®ç°">5. å»ºè®®çš„å®Œæ•´å®ç°</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PhotoCapture</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">PhotoCapture</span>() &#123;</span><br><span class="line">        _videoManager = <span class="built_in">qgcApp</span>()-&gt;<span class="built_in">toolbox</span>()-&gt;<span class="built_in">videoManager</span>();</span><br><span class="line">        <span class="built_in">connect</span>(_videoManager, &amp;VideoManager::imageFileChanged,</span><br><span class="line">                <span class="keyword">this</span>, &amp;PhotoCapture::_handleImageCaptured);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">capturePhoto</span><span class="params">(<span class="type">const</span> QString&amp; customPath = QString())</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!_videoManager) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç¡®ä¿è§†é¢‘æµå·²å¯åŠ¨</span></span><br><span class="line">        <span class="keyword">if</span> (!_videoManager-&gt;<span class="built_in">streaming</span>()) &#123;</span><br><span class="line">            _videoManager-&gt;<span class="built_in">startVideo</span>();</span><br><span class="line">            <span class="comment">// ç­‰å¾…è§†é¢‘æµå¯åŠ¨</span></span><br><span class="line">            QTimer::<span class="built_in">singleShot</span>(<span class="number">1000</span>, <span class="keyword">this</span>, [=]() &#123;</span><br><span class="line">                _videoManager-&gt;<span class="built_in">grabImage</span>(customPath);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            _videoManager-&gt;<span class="built_in">grabImage</span>(customPath);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">void</span> _handleImageCaptured() &#123;</span><br><span class="line">        QString imageFile = _videoManager-&gt;<span class="built_in">imageFile</span>();</span><br><span class="line">        <span class="keyword">if</span> (QFile::<span class="built_in">exists</span>(imageFile)) &#123;</span><br><span class="line">            <span class="function">emit <span class="title">photoCaptured</span><span class="params">(imageFile)</span></span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            emit <span class="built_in">photoCaptureFailed</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    VideoManager* _videoManager;</span><br><span class="line"></span><br><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">photoCaptured</span><span class="params">(<span class="type">const</span> QString&amp; path)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">photoCaptureFailed</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹å¼æ¯”ç›´æ¥æ§åˆ¶ç›¸æœºè¦ç®€å•å¾—å¤š,é€‚åˆåªéœ€è¦è·å–å½“å‰è§†é¢‘ç”»é¢çš„åœºæ™¯ã€‚å¦‚æœæ‚¨éœ€è¦æ›´å¤šçš„ç›¸æœºæ§åˆ¶åŠŸèƒ½(å¦‚è°ƒæ•´æ›å…‰ã€ç„¦è·ç­‰),é‚£ä¹ˆå¯èƒ½è¿˜æ˜¯éœ€è¦ä½¿ç”¨ç›¸æœºæ§åˆ¶æ¥å£ã€‚</p><hr><aside><img src="https://prod-files-secure.s3.us-west-2.amazonaws.com/be8acdfb-cfd7-4e1c-b948-49d6460a6dcd/c0096a68-4fde-441f-a7ba-51b66943c29b/profile-circle.png" alt="https://prod-files-secure.s3.us-west-2.amazonaws.com/be8acdfb-cfd7-4e1c-b948-49d6460a6dcd/c0096a68-4fde-441f-a7ba-51b66943c29b/profile-circle.png" width="40px" /> **ğŸ‘‹Â hello****</aside><p>Table of Contents</p><hr>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LangGraph æ ¸å¿ƒæ¦‚å¿µ</title>
      <link href="/2024/11/25/LangGraph0/"/>
      <url>/2024/11/25/LangGraph0/</url>
      
        <content type="html"><![CDATA[<h1 id="æ ¸å¿ƒæ¦‚å¿µ">æ ¸å¿ƒæ¦‚å¿µ</h1><p>LangGraph çš„æ ¸å¿ƒæ˜¯å°†ä»£ç†å·¥ä½œæµç¨‹å»ºæ¨¡ä¸ºå›¾è¡¨ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä¸‰ä¸ªå…³é”®ç»„ä»¶å®šä¹‰ä»£ç†çš„è¡Œä¸ºï¼š</p><ol><li><a href="https://langchain-ai.github.io/langgraph/concepts/low_level/#state"><code>State</code></a>ï¼šè¡¨ç¤ºåº”ç”¨ç¨‹åºå½“å‰å¿«ç…§çš„å…±äº«æ•°æ®ç»“æ„ã€‚å®ƒå¯ä»¥æ˜¯ä»»ä½• Python ç±»å‹ï¼Œä½†é€šå¸¸æ˜¯<code>TypedDict</code>æˆ– PydanticÂ <code>BaseModel</code>ã€‚</li><li><a href="https://langchain-ai.github.io/langgraph/concepts/low_level/#nodes"><code>Nodes</code></a>ï¼šå¯¹ä»£ç†é€»è¾‘è¿›è¡Œç¼–ç çš„ Python å‡½æ•°ã€‚å®ƒä»¬æ¥æ”¶å½“å‰å€¼<code>State</code>ä½œä¸ºè¾“å…¥ï¼Œæ‰§è¡Œä¸€äº›è®¡ç®—æˆ–å‰¯ä½œç”¨ï¼Œå¹¶è¿”å›æ›´æ–°çš„<code>State</code>ã€‚</li><li>[<code>Edges](https://langchain-ai.github.io/langgraph/concepts/low_level/#edges)Node</code>ï¼šæ ¹æ®å½“å‰æƒ…å†µç¡®å®šä¸‹ä¸€æ­¥æ‰§è¡Œå“ªä¸ªæ“ä½œçš„ Python å‡½æ•°<code>State</code>ã€‚å®ƒä»¬å¯ä»¥æ˜¯æ¡ä»¶åˆ†æ”¯æˆ–å›ºå®šè½¬æ¢ã€‚</li></ol><p>é€šè¿‡ç»„åˆ<code>Nodes</code>å’Œ<code>Edges</code>ï¼Œæ‚¨å¯ä»¥åˆ›å»ºå¤æ‚çš„å¾ªç¯å·¥ä½œæµï¼Œä½¿å·¥ä½œæµéšæ—¶é—´æ¨ç§»è€Œæ¼”å˜<code>State</code>ã€‚ç„¶è€Œï¼ŒçœŸæ­£çš„å¼ºå¤§ä¹‹å¤„åœ¨äº LangGraph å¦‚ä½•ç®¡ç†å·¥ä½œæµ<code>State</code>ã€‚éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼š<code>Nodes</code>å’Œ<code>Edges</code>åªä¸è¿‡æ˜¯ Python å‡½æ•° - å®ƒä»¬å¯ä»¥åŒ…å« LLM æˆ–åªæ˜¯å¥½çš„ Python ä»£ç ã€‚</p><h2 id="çŠ¶æ€">çŠ¶æ€<a href="https://langchain-ai.github.io/langgraph/concepts/low_level/#state">Â¶</a></h2><p>å®šä¹‰å›¾å½¢æ—¶è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯å®šä¹‰<code>State</code>å›¾å½¢çš„ã€‚<code>State</code>ç”±<a href="https://langchain-ai.github.io/langgraph/concepts/low_level/#schema">å›¾å½¢çš„æ¨¡å¼</a>ä»¥åŠæŒ‡å®šå¦‚ä½•å°†æ›´æ–°åº”ç”¨äºçŠ¶æ€çš„<a href="https://langchain-ai.github.io/langgraph/concepts/low_level/#reducers"><code>reducer</code>å‡½æ•°</a><code>State</code>ç»„æˆã€‚æ¨¡å¼å°†æ˜¯å›¾å½¢ä¸­æ‰€æœ‰<code>Nodes</code>å’Œçš„è¾“å…¥æ¨¡å¼<code>Edges</code>ï¼Œå¯ä»¥æ˜¯<code>TypedDict</code>æˆ–<code>Pydantic</code>æ¨¡å‹ã€‚</p><p>è¾“å…¥è¾“å‡ºå¯ä»¥æ˜¯ä¸åŒçš„ç±»å‹</p><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ª<code>StateGraph</code>ã€‚<code>StateGraph</code>å¯¹è±¡å°†æˆ‘ä»¬çš„èŠå¤©æœºå™¨äººçš„ç»“æ„å®šä¹‰ä¸ºâ€œçŠ¶æ€å›¾â€ã€‚æˆ‘ä»¬å°†æ·»åŠ <code>nodes</code>ä»¥è¡¨ç¤ºæˆ‘ä»¬çš„èŠå¤©æœºå™¨äººå¯ä»¥è°ƒç”¨çš„ llm å’Œå‡½æ•°ï¼Œå¹¶<code>edges</code>æŒ‡å®šæœºå™¨äººåº”å¦‚ä½•åœ¨è¿™äº›å‡½æ•°ä¹‹é—´è½¬æ¢ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Annotated</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> typing_extensions <span class="keyword">import</span> TypedDict</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> langgraph.graph <span class="keyword">import</span> StateGraph, START, END</span><br><span class="line"><span class="keyword">from</span> langgraph.graph.message <span class="keyword">import</span> add_messages</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">State</span>(<span class="title class_ inherited__">TypedDict</span>):</span><br><span class="line">    <span class="comment"># Messages have the type &quot;list&quot;. The `add_messages` function</span></span><br><span class="line">    <span class="comment"># in the annotation defines how this state key should be updated</span></span><br><span class="line">    <span class="comment"># (in this case, it appends messages to the list, rather than overwriting them)</span></span><br><span class="line">    messages: Annotated[<span class="built_in">list</span>, add_messages]</span><br><span class="line"></span><br><span class="line">graph_builder = StateGraph(State)</span><br></pre></td></tr></table></figure><p>Reducer æ˜¯ç†è§£èŠ‚ç‚¹æ›´æ–°å¦‚ä½•åº”ç”¨äº<code>State</code> çš„å…³é”®ã€‚ ä¸­çš„æ¯ä¸ªé”®<code>State</code>éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„ Reducer å‡½æ•°ã€‚ å¦‚æœæœªæ˜ç¡®æŒ‡å®š Reducer å‡½æ•°ï¼Œåˆ™å‡å®šå¯¹è¯¥é”®çš„æ‰€æœ‰æ›´æ–°éƒ½åº”è¦†ç›–å®ƒã€‚ Reducer æœ‰å‡ ç§ä¸åŒçš„ç±»å‹ï¼Œé¦–å…ˆæ˜¯é»˜è®¤ç±»å‹çš„ Reducerï¼š</p><h3 id="é»˜è®¤-reducer"><strong>é»˜è®¤ Reducer<a href="https://langchain-ai.github.io/langgraph/concepts/low_level/#default-reducer">Â¶</a></strong></h3><p>è¿™ä¸¤ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨é»˜è®¤çš„ Reducerï¼š</p><p><strong>ç¤ºä¾‹ Aï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing_extensions <span class="keyword">import</span> TypedDict</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">State</span>(<span class="title class_ inherited__">TypedDict</span>):</span><br><span class="line">    foo: <span class="built_in">int</span></span><br><span class="line">    bar: <span class="built_in">list</span>[<span class="built_in">str</span>]</span><br></pre></td></tr></table></figure><p>åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæœªä¸ºä»»ä½•é”®æŒ‡å®šä»»ä½• Reducer å‡½æ•°ã€‚æˆ‘ä»¬å‡è®¾å›¾çš„è¾“å…¥æ˜¯<code>&#123;&quot;foo&quot;: 1, &quot;bar&quot;: [&quot;hi&quot;]&#125;</code>ã€‚ç„¶åæˆ‘ä»¬å‡è®¾ç¬¬ä¸€ä¸ª<code>Node</code>è¿”å›<code>&#123;&quot;foo&quot;: 2&#125;</code>ã€‚è¿™è¢«è§†ä¸ºå¯¹çŠ¶æ€çš„æ›´æ–°ã€‚è¯·æ³¨æ„ï¼Œ<code>Node</code>ä¸éœ€è¦è¿”å›æ•´ä¸ª<code>State</code>æ¶æ„ - åªéœ€è¿”å›æ›´æ–°ã€‚åº”ç”¨æ­¤æ›´æ–°åï¼Œ<code>State</code>å°†æ˜¯<code>&#123;&quot;foo&quot;: 2, &quot;bar&quot;: [&quot;hi&quot;]&#125;</code>ã€‚å¦‚æœç¬¬äºŒä¸ªèŠ‚ç‚¹è¿”å›ï¼Œ<code>&#123;&quot;bar&quot;: [&quot;bye&quot;]&#125;</code>åˆ™å°†<code>State</code>æ˜¯<code>&#123;&quot;foo&quot;: 2, &quot;bar&quot;: [&quot;bye&quot;]&#125;</code></p><p><strong>ç¤ºä¾‹ Bï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Annotated</span><br><span class="line"><span class="keyword">from</span> typing_extensions <span class="keyword">import</span> TypedDict</span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> add</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">State</span>(<span class="title class_ inherited__">TypedDict</span>):</span><br><span class="line">    foo: <span class="built_in">int</span></span><br><span class="line">    bar: Annotated[<span class="built_in">list</span>[<span class="built_in">str</span>], add]</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†Annotatedç±»å‹ä¸ºç¬¬äºŒä¸ªé”®ï¼ˆbarï¼‰æŒ‡å®šä¸€ä¸ªå½’çº¦å‡½æ•°ï¼ˆoperator.addï¼‰ã€‚æ³¨æ„ï¼Œç¬¬ä¸€ä¸ªé”®ä¿æŒä¸å˜ã€‚å‡è®¾å›¾çš„è¾“å…¥æ˜¯{â€œfooâ€: 1, â€œbarâ€: [â€œhiâ€]}ã€‚ç„¶åå‡è®¾ç¬¬ä¸€ä¸ªèŠ‚ç‚¹è¿”å›{â€œfooâ€: 2}ã€‚è¿™è¢«è§†ä¸ºå¯¹çŠ¶æ€çš„æ›´æ–°ã€‚è¯·æ³¨æ„ï¼ŒèŠ‚ç‚¹ä¸éœ€è¦è¿”å›æ•´ä¸ªStateæ¨¡å¼â€”â€”åªéœ€æ›´æ–°å³å¯ã€‚åœ¨åº”ç”¨æ­¤æ›´æ–°åï¼ŒçŠ¶æ€å°†å˜ä¸º{â€œfooâ€: 2, â€œbarâ€: [â€œhiâ€]}ã€‚å¦‚æœç¬¬äºŒä¸ªèŠ‚ç‚¹è¿”å›{â€œbarâ€: [â€œbyeâ€]}ï¼Œé‚£ä¹ˆçŠ¶æ€å°†å˜ä¸º{â€œfooâ€: 2, â€œbarâ€: [â€œhiâ€, â€œbyeâ€]}ã€‚è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œé€šè¿‡å°†ä¸¤ä¸ªåˆ—è¡¨ç›¸åŠ æ¥æ›´æ–°baré”®ã€‚</p><p>add_messages(left: Messages, right: Messages) -&gt; Messages Â¶<br>åˆå¹¶ä¸¤æ¡æ¶ˆæ¯åˆ—è¡¨ï¼Œé€šè¿‡IDæ›´æ–°ç°æœ‰æ¶ˆæ¯ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ç¡®ä¿çŠ¶æ€æ˜¯â€œä»…è¿½åŠ â€ï¼Œé™¤éæ–°æ¶ˆæ¯ä¸ç°æœ‰æ¶ˆæ¯å…·æœ‰ç›¸åŒçš„IDã€‚</p><p>å‚æ•°ï¼š</p><p>left (Messages) â€“ åŸºç¡€æ¶ˆæ¯åˆ—è¡¨ã€‚<br>right (Messages) â€“ è¦åˆå¹¶åˆ°åŸºç¡€åˆ—è¡¨ä¸­çš„æ¶ˆæ¯ï¼ˆæˆ–å•ä¸ªæ¶ˆæ¯ï¼‰åˆ—è¡¨ã€‚<br>è¿”å›å€¼ï¼š</p><p>Messages â€“ ä¸€ä¸ªæ–°çš„æ¶ˆæ¯åˆ—è¡¨ï¼Œå…¶ä¸­åŒ…å«ä»rightåˆå¹¶åˆ°leftçš„æ¶ˆæ¯ã€‚<br>Messages â€“ å¦‚æœrightä¸­çš„ä¸€æ¡ä¿¡æ¯ä¸leftä¸­çš„ä¸€æ¡ä¿¡æ¯å…·æœ‰ç›¸åŒçš„IDï¼Œ<br>Messages â€“ åˆ™æ¥è‡ªrightçš„ä¿¡æ¯å°†æ›¿æ¢æ¥è‡ªleftçš„ä¿¡æ¯ã€‚</p><h2 id="èŠ‚ç‚¹">èŠ‚ç‚¹<a href="https://langchain-ai.github.io/langgraph/concepts/low_level/#nodes">Â¶</a></h2><p>åœ¨ LangGraph ä¸­ï¼ŒèŠ‚ç‚¹é€šå¸¸æ˜¯ Python å‡½æ•°ï¼ˆsync æˆ–<code>async</code>ï¼‰ï¼Œå…¶ä¸­<strong>ç¬¬ä¸€ä¸ª</strong>ä½ç½®å‚æ•°æ˜¯<a href="https://langchain-ai.github.io/langgraph/concepts/low_level/#state">çŠ¶æ€</a>ï¼Œå¹¶ä¸”ï¼ˆå¯é€‰ï¼‰<strong>ç¬¬äºŒä¸ª</strong>ä½ç½®å‚æ•°æ˜¯â€œconfigâ€ï¼ŒåŒ…å«å¯é€‰çš„<a href="https://langchain-ai.github.io/langgraph/concepts/low_level/#configuration">å¯é…ç½®å‚æ•°</a>ï¼ˆä¾‹å¦‚<code>thread_id</code>ï¼‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_anthropic <span class="keyword">import</span> ChatAnthropic</span><br><span class="line"></span><br><span class="line">llm = ChatAnthropic(model=<span class="string">&quot;claude-3-5-sonnet-20240620&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chatbot</span>(<span class="params">state: State</span>):</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;messages&quot;</span>: [llm.invoke(state[<span class="string">&quot;messages&quot;</span>])]&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># The first argument is the unique node name</span></span><br><span class="line"><span class="comment"># The second argument is the function or object that will be called whenever</span></span><br><span class="line"><span class="comment"># the node is used.</span></span><br><span class="line">graph_builder.add_node(<span class="string">&quot;chatbot&quot;</span>, chatbot)</span><br></pre></td></tr></table></figure><p>åœ¨åå°ï¼Œå‡½æ•°è¢«è½¬æ¢ä¸º<a href="https://api.python.langchain.com/en/latest/runnables/langchain_core.runnables.base.RunnableLambda.html#langchain_core.runnables.base.RunnableLambda">RunnableLambda</a></p><p><code>Runnable</code> å¯¹è±¡çš„ç‰¹ç‚¹åŒ…æ‹¬ï¼š</p><ol><li><strong>å¯æ‰§è¡Œæ€§</strong>ï¼š<code>Runnable</code> å¯¹è±¡å¯ä»¥è¢«è°ƒç”¨æ¥æ‰§è¡ŒæŸäº›æ“ä½œã€‚</li><li><strong>ç±»å‹å¤šæ ·æ€§</strong>ï¼šå¯ä»¥æ˜¯åŒæ­¥å‡½æ•°ã€å¼‚æ­¥å‡½æ•°ã€ç”Ÿæˆå™¨å‡½æ•°ã€å¼‚æ­¥ç”Ÿæˆå™¨å‡½æ•°ç­‰ã€‚</li><li><strong>å·¥å…·ç»‘å®š</strong>ï¼šå¯ä»¥ç»‘å®šå·¥å…·æ¥æ‰©å±•å…¶åŠŸèƒ½ã€‚</li><li><strong>é“¾å¼æ“ä½œ</strong>ï¼šå¯ä»¥é€šè¿‡ç®¡é“æ“ä½œç¬¦ <code>|</code> å°†å¤šä¸ª <code>Runnable</code> å¯¹è±¡ç»„åˆåœ¨ä¸€èµ·ã€‚</li><li><strong>é…ç½®æ”¯æŒ</strong>ï¼šå¯ä»¥æ¥å—é…ç½®å‚æ•°æ¥å®šåˆ¶å…¶è¡Œä¸ºã€‚</li></ol><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼Œå±•ç¤ºäº†å¦‚ä½•å®šä¹‰å’Œä½¿ç”¨ <code>Runnable</code> å¯¹è±¡ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.runnables <span class="keyword">import</span> Runnable, RunnableLambda</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Callable</span>, <span class="type">Any</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ä¸€ä¸ªç®€å•çš„åŒæ­¥å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">simple_function</span>(<span class="params"><span class="built_in">input</span>: <span class="type">Any</span></span>) -&gt; <span class="type">Any</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;Processed: <span class="subst">&#123;<span class="built_in">input</span>&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†å‡½æ•°è½¬æ¢ä¸º Runnable å¯¹è±¡</span></span><br><span class="line">simple_runnable = RunnableLambda(simple_function)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è°ƒç”¨ Runnable å¯¹è±¡</span></span><br><span class="line">result = simple_runnable.invoke(<span class="string">&quot;Test Input&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># è¾“å‡º: Processed: Test Input</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•å°†ä¸€ä¸ªç®€å•çš„å‡½æ•°è½¬æ¢ä¸º <code>Runnable</code> å¯¹è±¡ï¼Œå¹¶è°ƒç”¨å®ƒæ¥å¤„ç†è¾“å…¥ã€‚</p><p>è¡¥å……</p><h3 id="åŒæ­¥å‡½æ•°">åŒæ­¥å‡½æ•°</h3><p>åŒæ­¥å‡½æ•°æ˜¯æœ€å¸¸è§çš„å‡½æ•°ç±»å‹ï¼Œå®ƒä»¬æŒ‰é¡ºåºæ‰§è¡Œä»£ç ï¼Œç›´åˆ°å®Œæˆæ‰€æœ‰æ“ä½œã€‚è°ƒç”¨åŒæ­¥å‡½æ•°æ—¶ï¼Œç¨‹åºä¼šç­‰å¾…å‡½æ•°æ‰§è¡Œå®Œæ¯•åå†ç»§ç»­æ‰§è¡Œåç»­ä»£ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sync_function</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;This is a synchronous function&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="å¼‚æ­¥å‡½æ•°">å¼‚æ­¥å‡½æ•°</h3><p>å¼‚æ­¥å‡½æ•°ä½¿ç”¨ <code>async</code> å…³é”®å­—å®šä¹‰ï¼Œå…è®¸åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æš‚åœå¹¶ç­‰å¾…å…¶ä»–æ“ä½œå®Œæˆï¼ˆä¾‹å¦‚ I/O æ“ä½œï¼‰ï¼Œè€Œä¸é˜»å¡æ•´ä¸ªç¨‹åºã€‚è°ƒç”¨å¼‚æ­¥å‡½æ•°æ—¶ï¼Œè¿”å›ä¸€ä¸ª <code>coroutine</code> å¯¹è±¡ï¼Œéœ€è¦ä½¿ç”¨ <code>await</code> å…³é”®å­—ç­‰å¾…å…¶å®Œæˆã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">async_function</span>():</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;This is an asynchronous function&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ç”Ÿæˆå™¨å‡½æ•°">ç”Ÿæˆå™¨å‡½æ•°</h3><p>ç”Ÿæˆå™¨å‡½æ•°ä½¿ç”¨ <code>yield</code> å…³é”®å­—è¿”å›ä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡ï¼Œå¯ä»¥åœ¨è¿­ä»£è¿‡ç¨‹ä¸­é€æ­¥ç”Ÿæˆå€¼ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§è¿”å›æ‰€æœ‰å€¼ã€‚ç”Ÿæˆå™¨å‡½æ•°åœ¨æ¯æ¬¡ <code>yield</code> æ—¶æš‚åœï¼Œå¹¶åœ¨ä¸‹ä¸€æ¬¡è¿­ä»£æ—¶ç»§ç»­æ‰§è¡Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">generator_function</span>():</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&quot;This is&quot;</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&quot;a generator&quot;</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&quot;function&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="å¼‚æ­¥ç”Ÿæˆå™¨å‡½æ•°">å¼‚æ­¥ç”Ÿæˆå™¨å‡½æ•°</h3><p>å¼‚æ­¥ç”Ÿæˆå™¨å‡½æ•°ç»“åˆäº†å¼‚æ­¥å‡½æ•°å’Œç”Ÿæˆå™¨å‡½æ•°çš„ç‰¹æ€§ï¼Œä½¿ç”¨ <code>async</code> å’Œ <code>yield</code> å…³é”®å­—å®šä¹‰ã€‚å®ƒä»¬å¯ä»¥åœ¨å¼‚æ­¥è¿­ä»£è¿‡ç¨‹ä¸­é€æ­¥ç”Ÿæˆå€¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">async_generator_function</span>():</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&quot;This is&quot;</span></span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&quot;an asynchronous&quot;</span></span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&quot;generator function&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="è¾¹">è¾¹<a href="https://langchain-ai.github.io/langgraph/concepts/low_level/#edges">Â¶</a></h2><p>è¾¹å®šä¹‰äº†é€»è¾‘çš„è·¯ç”±æ–¹å¼ä»¥åŠå›¾å†³å®šåœæ­¢çš„æ–¹å¼ã€‚è¿™æ˜¯ä»£ç†å¦‚ä½•å·¥ä½œä»¥åŠä¸åŒèŠ‚ç‚¹å¦‚ä½•ç›¸äº’é€šä¿¡çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚æœ‰å‡ ç§ä¸»è¦çš„è¾¹ç±»å‹ï¼š</p><ul><li>æ™®é€šè¾¹ï¼šç›´æ¥ä»ä¸€ä¸ªèŠ‚ç‚¹åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚</li><li>æ¡ä»¶è¾¹ï¼šè°ƒç”¨ä¸€ä¸ªå‡½æ•°æ¥ç¡®å®šä¸‹ä¸€æ­¥è¦å»å“ªä¸ªèŠ‚ç‚¹ã€‚</li><li>å…¥å£ç‚¹ï¼šç”¨æˆ·è¾“å…¥åˆ°è¾¾æ—¶é¦–å…ˆè°ƒç”¨å“ªä¸ªèŠ‚ç‚¹ã€‚</li><li>æ¡ä»¶å…¥å£ç‚¹ï¼šè°ƒç”¨ä¸€ä¸ªå‡½æ•°æ¥ç¡®å®šå½“ç”¨æˆ·è¾“å…¥åˆ°è¾¾æ—¶é¦–å…ˆè°ƒç”¨å“ªä¸ªèŠ‚ç‚¹ã€‚</li></ul><p>ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ªä¼ å‡ºè¾¹ã€‚å¦‚æœä¸€ä¸ªèŠ‚ç‚¹æœ‰å¤šä¸ªä¼ å‡ºè¾¹ï¼Œåˆ™<strong>æ‰€æœ‰</strong>è¿™äº›ç›®æ ‡èŠ‚ç‚¹éƒ½å°†ä½œä¸ºä¸‹ä¸€ä¸ªè¶…çº§æ­¥éª¤çš„ä¸€éƒ¨åˆ†å¹¶è¡Œæ‰§è¡Œã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬”è®° </tag>
            
            <tag> LLM </tag>
            
            <tag> LangGraph </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¹¦ç”ŸÂ·æµ¦è¯­å¤§æ¨¡å‹å®æˆ˜è¥ï¼ˆä¸ƒï¼‰ï¼šOpenCompass å¤§æ¨¡å‹è¯„æµ‹å®æˆ˜</title>
      <link href="/2024/04/22/InternLM2OpenCompass%20/"/>
      <url>/2024/04/22/InternLM2OpenCompass%20/</url>
      
        <content type="html"><![CDATA[<p>è¯¾ç¨‹æ–‡æ¡£ï¼š<a href="https://github.com/InternLM/Tutorial/blob/camp2/opencompass/readme.md">https://github.com/InternLM/Tutorial/blob/camp2/opencompass/readme.md</a></p><p>è§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1Pm41127jU/?spm_id_from=333.788&amp;vd_source=3194af3e77968cb10b1d50711d07106a">https://www.bilibili.com/video/BV1Pm41127jU/?spm_id_from=333.788&amp;vd_source=3194af3e77968cb10b1d50711d07106a</a></p><h2 id="opencompass"><strong>OpenCompass</strong></h2><p>ä¸Šæµ·äººå·¥æ™ºèƒ½å®éªŒå®¤ç§‘å­¦å®¶å›¢é˜Ÿæ­£å¼å‘å¸ƒäº†å¤§æ¨¡å‹å¼€æºå¼€æ”¾è¯„æµ‹ä½“ç³» â€œå¸å—â€ (OpenCompass2.0)ï¼Œç”¨äºä¸ºå¤§è¯­è¨€æ¨¡å‹ã€å¤šæ¨¡æ€æ¨¡å‹ç­‰æä¾›ä¸€ç«™å¼è¯„æµ‹æœåŠ¡ã€‚å…¶ä¸»è¦ç‰¹ç‚¹å¦‚ä¸‹ï¼š</p><ul><li>å¼€æºå¯å¤ç°ï¼šæä¾›å…¬å¹³ã€å…¬å¼€ã€å¯å¤ç°çš„å¤§æ¨¡å‹è¯„æµ‹æ–¹æ¡ˆ</li><li>å…¨é¢çš„èƒ½åŠ›ç»´åº¦ï¼šäº”å¤§ç»´åº¦è®¾è®¡ï¼Œæä¾› 70+ ä¸ªæ•°æ®é›†çº¦ 40 ä¸‡é¢˜çš„çš„æ¨¡å‹è¯„æµ‹æ–¹æ¡ˆï¼Œå…¨é¢è¯„ä¼°æ¨¡å‹èƒ½åŠ›</li><li>ä¸°å¯Œçš„æ¨¡å‹æ”¯æŒï¼šå·²æ”¯æŒ 20+ HuggingFace åŠ API æ¨¡å‹</li><li>åˆ†å¸ƒå¼é«˜æ•ˆè¯„æµ‹ï¼šä¸€è¡Œå‘½ä»¤å®ç°ä»»åŠ¡åˆ†å‰²å’Œåˆ†å¸ƒå¼è¯„æµ‹ï¼Œæ•°å°æ—¶å³å¯å®Œæˆåƒäº¿æ¨¡å‹å…¨é‡è¯„æµ‹</li><li>å¤šæ ·åŒ–è¯„æµ‹èŒƒå¼ï¼šæ”¯æŒé›¶æ ·æœ¬ã€å°æ ·æœ¬åŠæ€ç»´é“¾è¯„æµ‹ï¼Œç»“åˆæ ‡å‡†å‹æˆ–å¯¹è¯å‹æç¤ºè¯æ¨¡æ¿ï¼Œè½»æ¾æ¿€å‘å„ç§æ¨¡å‹æœ€å¤§æ€§èƒ½</li><li>çµæ´»åŒ–æ‹“å±•ï¼šæƒ³å¢åŠ æ–°æ¨¡å‹æˆ–æ•°æ®é›†ï¼Ÿæƒ³è¦è‡ªå®šä¹‰æ›´é«˜çº§çš„ä»»åŠ¡åˆ†å‰²ç­–ç•¥ï¼Œç”šè‡³æ¥å…¥æ–°çš„é›†ç¾¤ç®¡ç†ç³»ç»Ÿï¼ŸOpenCompass çš„ä¸€åˆ‡å‡å¯è½»æ¾æ‰©å±•ï¼</li></ul><p><img src="https://picture.fanfer.top/img/intern72.png" alt="Untitled"></p><ul><li>æ¨¡å‹å±‚ï¼šå¤§æ¨¡å‹è¯„æµ‹æ‰€æ¶‰åŠçš„ä¸»è¦æ¨¡å‹ç§ç±»ï¼ŒOpenCompassä»¥åŸºåº§æ¨¡å‹å’Œå¯¹è¯æ¨¡å‹ä½œä¸ºé‡ç‚¹è¯„æµ‹å¯¹è±¡ã€‚</li><li>èƒ½åŠ›å±‚ï¼šOpenCompassä»æœ¬æ–¹æ¡ˆä»é€šç”¨èƒ½åŠ›å’Œç‰¹è‰²èƒ½åŠ›ä¸¤ä¸ªæ–¹é¢æ¥è¿›è¡Œè¯„æµ‹ç»´åº¦è®¾è®¡ã€‚åœ¨æ¨¡å‹é€šç”¨èƒ½åŠ›æ–¹é¢ï¼Œä»è¯­è¨€ã€çŸ¥è¯†ã€ç†è§£ã€æ¨ç†ã€å®‰å…¨ç­‰å¤šä¸ªèƒ½åŠ›ç»´åº¦è¿›è¡Œè¯„æµ‹ã€‚åœ¨ç‰¹è‰²èƒ½åŠ›æ–¹é¢ï¼Œä»é•¿æ–‡æœ¬ã€ä»£ç ã€å·¥å…·ã€çŸ¥è¯†å¢å¼ºç­‰ç»´åº¦è¿›è¡Œè¯„æµ‹ã€‚</li><li>æ–¹æ³•å±‚ï¼šOpenCompassé‡‡ç”¨å®¢è§‚è¯„æµ‹ä¸ä¸»è§‚è¯„æµ‹ä¸¤ç§è¯„æµ‹æ–¹å¼ã€‚å®¢è§‚è¯„æµ‹èƒ½ä¾¿æ·åœ°è¯„ä¼°æ¨¡å‹åœ¨å…·æœ‰ç¡®å®šç­”æ¡ˆï¼ˆå¦‚é€‰æ‹©ï¼Œå¡«ç©ºï¼Œå°é—­å¼é—®ç­”ç­‰ï¼‰çš„ä»»åŠ¡ä¸Šçš„èƒ½åŠ›ï¼Œä¸»è§‚è¯„æµ‹èƒ½è¯„ä¼°ç”¨æˆ·å¯¹æ¨¡å‹å›å¤çš„çœŸå®æ»¡æ„åº¦ï¼ŒOpenCompassé‡‡ç”¨åŸºäºæ¨¡å‹è¾…åŠ©çš„ä¸»è§‚è¯„æµ‹å’ŒåŸºäºäººç±»åé¦ˆçš„ä¸»è§‚è¯„æµ‹ä¸¤ç§æ–¹å¼ã€‚</li><li>å·¥å…·å±‚ï¼šOpenCompassæä¾›ä¸°å¯Œçš„åŠŸèƒ½æ”¯æŒè‡ªåŠ¨åŒ–åœ°å¼€å±•å¤§è¯­è¨€æ¨¡å‹çš„é«˜æ•ˆè¯„æµ‹ã€‚åŒ…æ‹¬åˆ†å¸ƒå¼è¯„æµ‹æŠ€æœ¯ï¼Œæç¤ºè¯å·¥ç¨‹ï¼Œå¯¹æ¥è¯„æµ‹æ•°æ®åº“ï¼Œè¯„æµ‹æ¦œå•å‘å¸ƒï¼Œè¯„æµ‹æŠ¥å‘Šç”Ÿæˆç­‰è¯¸å¤šåŠŸèƒ½ã€‚</li></ul><p><img src="https://picture.fanfer.top/img/intern73.png" alt="Untitled"></p><p>åœ¨ OpenCompass ä¸­è¯„ä¼°ä¸€ä¸ªæ¨¡å‹é€šå¸¸åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªé˜¶æ®µï¼šé…ç½® -&gt; æ¨ç† -&gt; è¯„ä¼° -&gt; å¯è§†åŒ–ã€‚</p><ul><li>é…ç½®ï¼šè¿™æ˜¯æ•´ä¸ªå·¥ä½œæµçš„èµ·ç‚¹ã€‚æ‚¨éœ€è¦é…ç½®æ•´ä¸ªè¯„ä¼°è¿‡ç¨‹ï¼Œé€‰æ‹©è¦è¯„ä¼°çš„æ¨¡å‹å’Œæ•°æ®é›†ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥é€‰æ‹©è¯„ä¼°ç­–ç•¥ã€è®¡ç®—åç«¯ç­‰ï¼Œå¹¶å®šä¹‰æ˜¾ç¤ºç»“æœçš„æ–¹å¼ã€‚</li><li>æ¨ç†ä¸è¯„ä¼°ï¼šåœ¨è¿™ä¸ªé˜¶æ®µï¼ŒOpenCompass å°†ä¼šå¼€å§‹å¯¹æ¨¡å‹å’Œæ•°æ®é›†è¿›è¡Œå¹¶è¡Œæ¨ç†å’Œè¯„ä¼°ã€‚æ¨ç†é˜¶æ®µä¸»è¦æ˜¯è®©æ¨¡å‹ä»æ•°æ®é›†äº§ç”Ÿè¾“å‡ºï¼Œè€Œè¯„ä¼°é˜¶æ®µåˆ™æ˜¯è¡¡é‡è¿™äº›è¾“å‡ºä¸æ ‡å‡†ç­”æ¡ˆçš„åŒ¹é…ç¨‹åº¦ã€‚è¿™ä¸¤ä¸ªè¿‡ç¨‹ä¼šè¢«æ‹†åˆ†ä¸ºå¤šä¸ªåŒæ—¶è¿è¡Œçš„â€œä»»åŠ¡â€ä»¥æé«˜æ•ˆç‡ï¼Œä½†è¯·æ³¨æ„ï¼Œå¦‚æœè®¡ç®—èµ„æºæœ‰é™ï¼Œè¿™ç§ç­–ç•¥å¯èƒ½ä¼šä½¿è¯„æµ‹å˜å¾—æ›´æ…¢ã€‚å¦‚æœéœ€è¦äº†è§£è¯¥é—®é¢˜åŠè§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥å‚è€ƒ FAQ: æ•ˆç‡ã€‚</li><li>å¯è§†åŒ–ï¼šè¯„ä¼°å®Œæˆåï¼ŒOpenCompass å°†ç»“æœæ•´ç†æˆæ˜“è¯»çš„è¡¨æ ¼ï¼Œå¹¶å°†å…¶ä¿å­˜ä¸º CSV å’Œ TXT æ–‡ä»¶ã€‚ä½ ä¹Ÿå¯ä»¥æ¿€æ´»é£ä¹¦çŠ¶æ€ä¸ŠæŠ¥åŠŸèƒ½ï¼Œæ­¤åå¯ä»¥åœ¨é£ä¹¦å®¢æˆ·ç«¯ä¸­åŠæ—¶è·å¾—è¯„æµ‹çŠ¶æ€æŠ¥å‘Šã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å±•ç¤º OpenCompass çš„åŸºç¡€ç”¨æ³•ï¼Œå±•ç¤ºä¹¦ç”Ÿæµ¦è¯­åœ¨Â <code>C-Eval</code>Â åŸºå‡†ä»»åŠ¡ä¸Šçš„è¯„ä¼°ã€‚å®ƒä»¬çš„é…ç½®æ–‡ä»¶å¯ä»¥åœ¨Â <code>configs/eval_demo.py</code>Â ä¸­æ‰¾åˆ°ã€‚</li></ul><h2 id="ä½œä¸š">ä½œä¸š</h2><p><img src="https://picture.fanfer.top/img/intern71.png" alt="untitled"></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬”è®° </tag>
            
            <tag> InternLM2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¹¦ç”ŸÂ·æµ¦è¯­å¤§æ¨¡å‹å®æˆ˜è¥ï¼ˆå…­ï¼‰ï¼šLagent &amp; AgentLego æ™ºèƒ½ä½“åº”ç”¨æ­å»º</title>
      <link href="/2024/04/22/InternLM2Agent/"/>
      <url>/2024/04/22/InternLM2Agent/</url>
      
        <content type="html"><![CDATA[<p>æ–‡æ¡£ï¼š<a href="https://github.com/InternLM/Tutorial/tree/camp2/agent">https://github.com/InternLM/Tutorial/tree/camp2/agent</a></p><p>è§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1Xt4217728/?spm_id_from=333.788&amp;vd_source=3194af3e77968cb10b1d50711d07106a">https://www.bilibili.com/video/BV1Xt4217728/?spm_id_from=333.788&amp;vd_source=3194af3e77968cb10b1d50711d07106a</a></p><p>ä»“åº“ï¼š</p><p><a href="https://github.com/InternLM/Lagent">https://github.com/InternLM/Lagent</a></p><p><a href="https://github.com/InternLM/AgentLego">https://github.com/InternLM/AgentLego</a></p><blockquote><p><strong>ä»€ä¹ˆæ˜¯æ™ºèƒ½ä½“</strong><br>1.å¯ä»¥æ„ŸçŸ¥ç¯å¢ƒä¸­çš„åŠ¨æ€æ¡ä»¶ã€‚<br>(perception of dynamic conditions in the environment)<br>2.èƒ½é‡‡å–åŠ¨ä½œå½±å“ç¯å¢ƒã€‚<br>(action to affect conditions in the environment)<br>3.èƒ½è¿ç”¨æ¨ç†èƒ½åŠ›ç†è§£ä¿¡æ¯ã€è§£å†³é—®é¢˜ã€äº§ç”Ÿæ¨æ–­ã€å†³å®šåŠ¨ä½œã€‚<br>(reasoning to interpret perceptions, solve problems, draw inferences, and determine actions)<br>â€”Hayes-Roth 1995<br>An Architecture for Adaptive Intelligent Systems</p></blockquote><p>å¤§è„‘ï¼šä½œä¸ºæ§åˆ¶å™¨ï¼Œæ‰¿æ‹…è®°å¿†ã€æ€è€ƒå’Œå†³ç­–ä»»åŠ¡ã€‚æ¥å—æ¥è‡ªæ„ŸçŸ¥æ¨¡å—çš„ä¿¡æ¯ï¼Œå¹¶é‡‡å–ç›¸åº”åŠ¨ä½œã€‚</p><hr><p>æ„ŸçŸ¥ï¼šå¯¹å¤–éƒ¨ç¯å¢ƒçš„å¤šæ¨¡æ€ä¿¡æ¯è¿›è¡Œæ„ŸçŸ¥å’Œå¤„ç†ã€‚åŒ…æ‹¬ä½†ä¸é™äºå›¾åƒã€éŸ³é¢‘ã€è§†é¢‘ã€ä¼ æ„Ÿå™¨ç­‰ã€‚</p><hr><p>åŠ¨ä½œï¼šåˆ©ç”¨å¹¶æ‰§è¡Œå·¥å…·ä»¥å½±å“ç¯å¢ƒã€‚å·¥å…·å¯èƒ½åŒ…æ‹¬æ–‡æœ¬çš„æ£€ç´¢ã€è°ƒç”¨ç›¸å…³ APIã€æ“æ§æœºæ¢°è‡‚ç­‰ã€‚</p><hr><h2 id="lagent">Lagent</h2><p>Lagent æ˜¯ä¸€ä¸ªè½»é‡çº§å¼€æºæ™ºèƒ½ä½“æ¡†æ¶ï¼Œæ—¨åœ¨è®©ç”¨æˆ·å¯ä»¥é«˜æ•ˆåœ°æ„å»ºåŸºäºå¤§è¯­è¨€æ¨¡å‹çš„æ™ºèƒ½ä½“ã€‚åŒæ—¶å®ƒä¹Ÿæä¾›äº†ä¸€äº›å…¸å‹å·¥å…·ä»¥å¢å¼ºå¤§è¯­è¨€æ¨¡å‹çš„èƒ½åŠ›ã€‚</p><p>Lagent ç›®å‰å·²ç»æ”¯æŒäº†åŒ…æ‹¬ AutoGPTã€ReAct ç­‰åœ¨å†…çš„å¤šä¸ªç»å…¸æ™ºèƒ½ä½“èŒƒå¼ï¼Œä¹Ÿæ”¯æŒäº†å¦‚ä¸‹å·¥å…·ï¼š</p><ul><li>Arxiv æœç´¢</li><li>Bing åœ°å›¾</li><li>Google å­¦æœ¯æœç´¢</li><li>Google æœç´¢</li><li>äº¤äº’å¼ IPython è§£é‡Šå™¨</li><li>IPython è§£é‡Šå™¨</li><li>PPT</li><li>Python è§£é‡Šå™¨</li></ul><h2 id="agentlego">AgentLego</h2><p>AgentLego æ˜¯ä¸€ä¸ªæä¾›äº†å¤šç§å¼€æºå·¥å…· API çš„å¤šæ¨¡æ€å·¥å…·åŒ…ï¼Œæ—¨åœ¨åƒæ˜¯ä¹é«˜ç§¯æœ¨ä¸€æ ·ï¼Œè®©ç”¨æˆ·å¯ä»¥å¿«é€Ÿç®€ä¾¿åœ°æ‹“å±•è‡ªå®šä¹‰å·¥å…·ï¼Œä»è€Œç»„è£…å‡ºè‡ªå·±çš„æ™ºèƒ½ä½“ã€‚é€šè¿‡ AgentLego ç®—æ³•åº“ï¼Œä¸ä»…å¯ä»¥ç›´æ¥ä½¿ç”¨å¤šç§å·¥å…·ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨è¿™äº›å·¥å…·ï¼Œåœ¨ç›¸å…³æ™ºèƒ½ä½“æ¡†æ¶ï¼ˆå¦‚ Lagentï¼ŒTransformers Agent ç­‰ï¼‰çš„å¸®åŠ©ä¸‹ï¼Œå¿«é€Ÿæ„å»ºå¯ä»¥å¢å¼ºå¤§è¯­è¨€æ¨¡å‹èƒ½åŠ›çš„æ™ºèƒ½ä½“ã€‚</p><p>AgentLego ç›®å‰æä¾›äº†å¦‚ä¸‹å·¥å…·ï¼š</p><table><thead><tr><th>é€šç”¨èƒ½åŠ›</th><th>è¯­éŸ³ç›¸å…³</th><th>å›¾åƒå¤„ç†</th><th>AIGC</th></tr></thead><tbody><tr><td>â€¢ è®¡ç®—å™¨</td><td></td><td></td><td></td></tr><tr><td>â€¢ è°·æ­Œæœç´ </td><td>â€¢ æ–‡æœ¬ -&gt; éŸ³é¢‘ï¼ˆTTSï¼‰</td><td></td><td></td></tr><tr><td>â€¢ éŸ³é¢‘ -&gt; æ–‡æœ¬ï¼ˆSTTï¼‰</td><td>â€¢ æè¿°è¾“å…¥å›¾åƒ</td><td></td><td></td></tr></tbody></table><p>â€¢ è¯†åˆ«æ–‡æœ¬ï¼ˆOCRï¼‰<br>â€¢ è§†è§‰é—®ç­”ï¼ˆVQAï¼‰<br>â€¢ äººä½“å§¿æ€ä¼°è®¡<br>â€¢ äººè„¸å…³é”®ç‚¹æ£€æµ‹<br>â€¢ å›¾åƒè¾¹ç¼˜æå–ï¼ˆCannyï¼‰<br>â€¢ æ·±åº¦å›¾ç”Ÿæˆ<br>â€¢ ç”Ÿæˆæ¶‚é¸¦ï¼ˆScribbleï¼‰<br>â€¢ æ£€æµ‹å…¨éƒ¨ç›®æ ‡<br>â€¢ æ£€æµ‹ç»™å®šç›®æ ‡<br>â€¢ SAM<br>â—¦ åˆ†å‰²ä¸€åˆ‡<br>â—¦ åˆ†å‰²ç»™å®šç›®æ ‡ | â€¢ æ–‡ç”Ÿå›¾<br>â€¢ å›¾åƒæ‹“å±•<br>â€¢ åˆ é™¤ç»™å®šå¯¹è±¡<br>â€¢ æ›¿æ¢ç»™å®šå¯¹è±¡<br>â€¢ æ ¹æ®æŒ‡ä»¤ä¿®æ”¹<br>â€¢ ControlNet ç³»åˆ—<br>â—¦ æ ¹æ®è¾¹ç¼˜+æè¿°ç”Ÿæˆ<br>â—¦ æ ¹æ®æ·±åº¦å›¾+æè¿°ç”Ÿæˆ<br>â—¦ æ ¹æ®å§¿æ€+æè¿°ç”Ÿæˆ<br>â—¦ æ ¹æ®æ¶‚é¸¦+æè¿°ç”Ÿæˆ<br>â€¢ ImageBind ç³»åˆ—<br>â—¦ éŸ³é¢‘ç”Ÿæˆå›¾åƒ<br>â—¦ çƒ­æˆåƒç”Ÿæˆå›¾åƒ<br>â—¦ éŸ³é¢‘+å›¾åƒç”Ÿæˆå›¾åƒ<br>â—¦ éŸ³é¢‘+æ–‡æœ¬ç”Ÿæˆå›¾åƒ |</p><p>ä¸¤è€…ä¹‹é—´çš„å…³ç³»å¯ä»¥ç”¨ä¸‹å›¾æ¥è¡¨ç¤ºï¼š</p><p><img src="https://picture.fanfer.top/img/intern61.png" alt="æˆªå±2024-04-22 11.37.35.png"></p><h2 id="ä½œä¸š">ä½œä¸š</h2><p><img src="https://picture.fanfer.top/img/intern62.png" alt="Untitled"></p><p><img src="https://picture.fanfer.top/img/intern63.png" alt="Untitled"></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬”è®° </tag>
            
            <tag> InternLM2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¹¦ç”ŸÂ·æµ¦è¯­å¤§æ¨¡å‹å®æˆ˜è¥ï¼ˆäº”ï¼‰ï¼šLMDeploy é‡åŒ–</title>
      <link href="/2024/04/20/InternLM2LMDeploy/"/>
      <url>/2024/04/20/InternLM2LMDeploy/</url>
      
        <content type="html"><![CDATA[<p>æ–‡æ¡£ï¼š<a href="https://github.com/InternLM/Tutorial/tree/camp2/lmdeploy">https://github.com/InternLM/Tutorial/tree/camp2/lmdeploy</a></p><p>è§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1tr421x75B/?spm_id_from=333.788&amp;vd_source=3194af3e77968cb10b1d50711d07106a">https://www.bilibili.com/video/BV1tr421x75B/?spm_id_from=333.788&amp;vd_source=3194af3e77968cb10b1d50711d07106a</a></p><h3 id="æ¨¡å‹éƒ¨ç½²">æ¨¡å‹éƒ¨ç½²</h3><ul><li>å®šä¹‰<ul><li>å°†è®­ç»ƒå¥½çš„æ¨¡å‹åœ¨ç‰¹å®šè½¯ç¡¬ä»¶ç¯å¢ƒä¸­å¯åŠ¨çš„è¿‡ç¨‹ï¼Œä½¿æ¨¡å‹èƒ½å¤Ÿæ¥æ”¶è¾“å…¥å¹¶è¿”å›é¢„æµ‹ç»“æœ</li><li>ä¸ºäº†æ»¡è¶³æ€§èƒ½å’Œæ•ˆç‡çš„éœ€æ±‚ï¼Œå¸¸å¸¸éœ€è¦å¯¹æ¨¡å‹è¿›è¡Œä¼˜åŒ–ï¼Œä¾‹å¦‚æ¨¡å‹å‹ç¼©å’Œç¡¬ä»¶åŠ é€Ÿ</li></ul></li><li>äº§å“å½¢æ€<ul><li>äº‘ç«¯ã€è¾¹ç¼˜è®¡ç®—ç«¯ã€ç§»åŠ¨ç«¯</li></ul></li><li>è®¡ç®—è®¾å¤‡<ul><li>CPUã€GPUã€NPUã€TPU ç­‰</li></ul></li></ul><h3 id="å¤§æ¨¡å‹ç‰¹ç‚¹">å¤§æ¨¡å‹ç‰¹ç‚¹</h3><ul><li>å†…å­˜å¼€é”€å·¨å¤§<ul><li>åºå¤§çš„å‚æ•°é‡ã€‚7Bæ¨¡å‹ä»…æƒé‡å°±éœ€è¦ 14+G å†…å­˜</li><li>é‡‡ç”¨è‡ªå›å½’ç”Ÿæˆ tokenï¼Œéœ€è¦ç¼“å­˜ Attention çš„ k/vï¼Œå¸¦æ¥å·¨å¤§çš„å†…å­˜å¼€é”€</li></ul></li><li>åŠ¨æ€ shape<ul><li>è¯·æ±‚æ•°ä¸å›ºå®š</li><li>Token é€ä¸ªç”Ÿæˆï¼Œä¸”æ•°é‡ä¸å®š</li></ul></li><li>ç›¸å¯¹è§†è§‰æ¨¡å‹ï¼ŒLLM ç»“æ„ç®€å•<ul><li>Transformers ç»“æ„ï¼Œå¤§éƒ¨åˆ†æ˜¯ decoder-only</li></ul></li></ul><h3 id="å¤§æ¨¡å‹éƒ¨ç½²æŒ‘æˆ˜">å¤§æ¨¡å‹éƒ¨ç½²æŒ‘æˆ˜</h3><ul><li>è®¾å¤‡<ul><li>å¦‚ä½•åº”å¯¹å·¨å¤§çš„å­˜å‚¨é—®é¢˜ï¼Ÿä½å­˜å‚¨è®¾å¤‡ï¼ˆæ¶ˆè´¹çº§æ˜¾å¡ã€æ‰‹æœºç­‰ï¼‰å¦‚ä½•éƒ¨ç½²ï¼Ÿ</li></ul></li><li>æ¨ç†<ul><li>å¦‚ä½•åŠ é€Ÿ token çš„ç”Ÿæˆé€Ÿåº¦</li><li>å¦‚ä½•è§£å†³åŠ¨æ€ shapeï¼Œè®©æ¨ç†å¯ä»¥ä¸é—´æ–­</li><li>å¦‚ä½•æœ‰æ•ˆç®¡ç†å’Œåˆ©ç”¨å†…å­˜</li></ul></li><li>æœåŠ¡å¦‚ä½•æå‡ç³»ç»Ÿæ•´ä½“ååé‡ï¼Ÿ</li><li>å¯¹äºä¸ªä½“ç”¨æˆ·ï¼Œå¦‚ä½•é™ä½å“åº”æ—¶é—´ï¼Ÿ</li></ul><h3 id="å¤§æ¨¡å‹éƒ¨ç½²æ–¹æ¡ˆ">å¤§æ¨¡å‹éƒ¨ç½²æ–¹æ¡ˆ</h3><ul><li>æŠ€æœ¯ç‚¹<ul><li>æ¨¡å‹å¹¶è¡Œ</li><li>ä½æ¯”ç‰¹é‡åŒ–</li><li>Page Attention</li><li>transformer è®¡ç®—å’Œè®¿å­˜ä¼˜åŒ–</li><li>Continuous Batch</li><li>â€¦</li></ul></li><li>æ–¹æ¡ˆ<ul><li>huggingface transformers</li><li>ä¸“é—¨çš„æ¨ç†åŠ é€Ÿæ¡†æ¶<ul><li>äº‘ç«¯<ul><li>lmdeploy</li><li>vllm</li><li>tensorrt-llm</li><li>deepspeed</li><li>â€¦</li></ul></li><li>ç§»åŠ¨ç«¯<ul><li>llama.cpp</li><li>mlc-llm</li><li>â€¦</li></ul></li></ul></li></ul></li></ul><h2 id="lmdeploy-ç®€ä»‹">LMDeploy ç®€ä»‹</h2><p>LMDeploy æ˜¯ LLM åœ¨è‹±ä¼Ÿè¾¾è®¾å¤‡ä¸Šéƒ¨ç½²çš„å…¨æµç¨‹è§£å†³æ–¹æ¡ˆã€‚åŒ…æ‹¬æ¨¡å‹è½»é‡åŒ–ã€æ¨ç†å’ŒæœåŠ¡ã€‚é¡¹ç›®åœ°å€ï¼šÂ <a href="https://github.com/InternLM/lmdeploy">https://github.com/InternLM/lmdeploy</a></p><p>LMDeploy æä¾›ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼ˆç»†èŠ‚è¯¦è§å®˜æ–¹ä»“åº“ï¼Œè¿™é‡Œä¸åšèµ˜è¿°ï¼‰ï¼š</p><ul><li><strong>é«˜æ•ˆæ¨ç†å¼•æ“ TurboMind</strong>ï¼šå¼€å‘äº† Persistent Batch(å³ Continuous Batch)ï¼ŒBlocked K/V Cacheï¼ŒåŠ¨æ€æ‹†åˆ†å’Œèåˆï¼Œå¼ é‡å¹¶è¡Œï¼Œé«˜æ•ˆçš„è®¡ç®— kernelç­‰é‡è¦ç‰¹æ€§ï¼Œä¿éšœäº† LLMs æ¨ç†æ—¶çš„é«˜ååå’Œä½å»¶æ—¶ã€‚</li><li><strong>æœ‰çŠ¶æ€æ¨ç†</strong>ï¼šé€šè¿‡ç¼“å­˜å¤šè½®å¯¹è¯è¿‡ç¨‹ä¸­ attention çš„ k/vï¼Œè®°ä½å¯¹è¯å†å²ï¼Œä»è€Œé¿å…é‡å¤å¤„ç†å†å²ä¼šè¯ã€‚æ˜¾è‘—æå‡é•¿æ–‡æœ¬å¤šè½®å¯¹è¯åœºæ™¯ä¸­çš„æ•ˆç‡ã€‚</li><li><strong>é‡åŒ–</strong>ï¼šLMDeploy æ”¯æŒå¤šç§é‡åŒ–æ–¹å¼å’Œé«˜æ•ˆçš„é‡åŒ–æ¨¡å‹æ¨ç†ã€‚åœ¨ä¸åŒè§„æ¨¡çš„æ¨¡å‹ä¸Šï¼ŒéªŒè¯äº†é‡åŒ–çš„å¯é æ€§ã€‚</li></ul><p><strong>HuggingFace</strong></p><p><a href="https://huggingface.co/">HuggingFace</a>æ˜¯ä¸€ä¸ªé«˜é€Ÿå‘å±•çš„ç¤¾åŒºï¼ŒåŒ…æ‹¬Metaã€Googleã€Microsoftã€Amazonåœ¨å†…çš„è¶…è¿‡5000å®¶ç»„ç»‡æœºæ„åœ¨ä¸ºHuggingFaceå¼€æºç¤¾åŒºè´¡çŒ®ä»£ç ã€æ•°æ®é›†å’Œæ¨¡å‹ã€‚å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªé’ˆå¯¹æ·±åº¦å­¦ä¹ æ¨¡å‹å’Œæ•°æ®é›†çš„åœ¨çº¿æ‰˜ç®¡ç¤¾åŒºï¼Œå¦‚æœä½ æœ‰æ•°æ®é›†æˆ–è€…æ¨¡å‹æƒ³å¯¹å¤–åˆ†äº«ï¼Œç½‘ç›˜åˆä¸å¤ªæ–¹ä¾¿ï¼Œå°±ä¸å¦¨æ‰˜ç®¡åœ¨HuggingFaceã€‚</p><p>æ‰˜ç®¡åœ¨HuggingFaceç¤¾åŒºçš„æ¨¡å‹é€šå¸¸é‡‡ç”¨HuggingFaceæ ¼å¼å­˜å‚¨ï¼Œç®€å†™ä¸º<strong>HFæ ¼å¼</strong>ã€‚</p><p>ä½†æ˜¯HuggingFaceç¤¾åŒºçš„æœåŠ¡å™¨åœ¨å›½å¤–ï¼Œå›½å†…è®¿é—®ä¸å¤ªæ–¹ä¾¿ã€‚å›½å†…å¯ä»¥ä½¿ç”¨é˜¿é‡Œå·´å·´çš„<a href="https://www.modelscope.cn/home">MindScope</a>ç¤¾åŒºï¼Œæˆ–è€…ä¸Šæµ·AI Labæ­å»ºçš„<a href="https://openxlab.org.cn/home">OpenXLab</a>ç¤¾åŒºï¼Œä¸Šé¢æ‰˜ç®¡çš„æ¨¡å‹ä¹Ÿé€šå¸¸é‡‡ç”¨<strong>HFæ ¼å¼</strong>ã€‚</p><p><strong>TurboMind</strong></p><p>TurboMindæ˜¯LMDeployå›¢é˜Ÿå¼€å‘çš„ä¸€æ¬¾å…³äºLLMæ¨ç†çš„é«˜æ•ˆæ¨ç†å¼•æ“ï¼Œå®ƒçš„ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼šLLaMa ç»“æ„æ¨¡å‹çš„æ”¯æŒï¼Œcontinuous batch æ¨ç†æ¨¡å¼å’Œå¯æ‰©å±•çš„ KV ç¼“å­˜ç®¡ç†å™¨ã€‚</p><p>TurboMindæ¨ç†å¼•æ“ä»…æ”¯æŒæ¨ç†TurboMindæ ¼å¼çš„æ¨¡å‹ã€‚å› æ­¤ï¼ŒTurboMindåœ¨æ¨ç†HFæ ¼å¼çš„æ¨¡å‹æ—¶ï¼Œä¼šé¦–å…ˆè‡ªåŠ¨å°†HFæ ¼å¼æ¨¡å‹è½¬æ¢ä¸ºTurboMindæ ¼å¼çš„æ¨¡å‹ã€‚<strong>è¯¥è¿‡ç¨‹åœ¨æ–°ç‰ˆæœ¬çš„LMDeployä¸­æ˜¯è‡ªåŠ¨è¿›è¡Œçš„ï¼Œæ— éœ€ç”¨æˆ·æ“ä½œã€‚</strong></p><p>å‡ ä¸ªå®¹æ˜“è¿·æƒ‘çš„ç‚¹ï¼š</p><ul><li>TurboMindä¸LMDeployçš„å…³ç³»ï¼šLMDeployæ˜¯æ¶µç›–äº†LLM ä»»åŠ¡å…¨å¥—è½»é‡åŒ–ã€éƒ¨ç½²å’ŒæœåŠ¡è§£å†³æ–¹æ¡ˆçš„é›†æˆåŠŸèƒ½åŒ…ï¼ŒTurboMindæ˜¯LMDeployçš„ä¸€ä¸ªæ¨ç†å¼•æ“ï¼Œæ˜¯ä¸€ä¸ªå­æ¨¡å—ã€‚LMDeployä¹Ÿå¯ä»¥ä½¿ç”¨pytorchä½œä¸ºæ¨ç†å¼•æ“ã€‚</li><li>TurboMindä¸TurboMindæ¨¡å‹çš„å…³ç³»ï¼šTurboMindæ˜¯æ¨ç†å¼•æ“çš„åå­—ï¼ŒTurboMindæ¨¡å‹æ˜¯ä¸€ç§æ¨¡å‹å­˜å‚¨æ ¼å¼ï¼ŒTurboMindå¼•æ“åªèƒ½æ¨ç†TurboMindæ ¼å¼çš„æ¨¡å‹ã€‚</li></ul><h2 id="é‡åŒ–">é‡åŒ–</h2><p>æ€»çš„æ¥è¯´ï¼Œé‡åŒ–æ˜¯ä¸€ç§ä»¥å‚æ•°æˆ–è®¡ç®—ä¸­é—´ç»“æœç²¾åº¦ä¸‹é™æ¢ç©ºé—´èŠ‚çœï¼ˆä»¥åŠåŒæ—¶å¸¦æ¥çš„æ€§èƒ½æå‡ï¼‰çš„ç­–ç•¥ã€‚</p><p>æ­£å¼ä»‹ç» LMDeploy é‡åŒ–æ–¹æ¡ˆå‰ï¼Œéœ€è¦å…ˆä»‹ç»ä¸¤ä¸ªæ¦‚å¿µï¼š</p><ul><li>è®¡ç®—å¯†é›†ï¼ˆcompute-boundï¼‰: æŒ‡æ¨ç†è¿‡ç¨‹ä¸­ï¼Œç»å¤§éƒ¨åˆ†æ—¶é—´æ¶ˆè€—åœ¨æ•°å€¼è®¡ç®—ä¸Šï¼›é’ˆå¯¹è®¡ç®—å¯†é›†å‹åœºæ™¯ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨æ›´å¿«çš„ç¡¬ä»¶è®¡ç®—å•å…ƒæ¥æå‡è®¡ç®—é€Ÿåº¦ã€‚</li><li>è®¿å­˜å¯†é›†ï¼ˆmemory-boundï¼‰: æŒ‡æ¨ç†è¿‡ç¨‹ä¸­ï¼Œç»å¤§éƒ¨åˆ†æ—¶é—´æ¶ˆè€—åœ¨æ•°æ®è¯»å–ä¸Šï¼›é’ˆå¯¹è®¿å­˜å¯†é›†å‹åœºæ™¯ï¼Œä¸€èˆ¬é€šè¿‡å‡å°‘è®¿å­˜æ¬¡æ•°ã€æé«˜è®¡ç®—è®¿å­˜æ¯”æˆ–é™ä½è®¿å­˜é‡æ¥ä¼˜åŒ–ã€‚</li></ul><p>å¸¸è§çš„ LLM æ¨¡å‹ç”±äº Decoder Only æ¶æ„çš„ç‰¹æ€§ï¼Œå®é™…æ¨ç†æ—¶å¤§å¤šæ•°çš„æ—¶é—´éƒ½æ¶ˆè€—åœ¨äº†é€ Token ç”Ÿæˆé˜¶æ®µï¼ˆDecoding é˜¶æ®µï¼‰ï¼Œæ˜¯å…¸å‹çš„è®¿å­˜å¯†é›†å‹åœºæ™¯ã€‚</p><p>é‚£ä¹ˆï¼Œå¦‚ä½•ä¼˜åŒ– LLM æ¨¡å‹æ¨ç†ä¸­çš„è®¿å­˜å¯†é›†é—®é¢˜å‘¢ï¼Ÿ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong>KV8é‡åŒ–</strong>å’Œ<strong>W4A16</strong>é‡åŒ–ã€‚KV8é‡åŒ–æ˜¯æŒ‡å°†é€ Tokenï¼ˆDecodingï¼‰ç”Ÿæˆè¿‡ç¨‹ä¸­çš„ä¸Šä¸‹æ–‡ K å’Œ V ä¸­é—´ç»“æœè¿›è¡Œ INT8 é‡åŒ–ï¼ˆè®¡ç®—æ—¶å†åé‡åŒ–ï¼‰ï¼Œä»¥é™ä½ç”Ÿæˆè¿‡ç¨‹ä¸­çš„æ˜¾å­˜å ç”¨ã€‚W4A16 é‡åŒ–ï¼Œå°† FP16 çš„æ¨¡å‹æƒé‡é‡åŒ–ä¸º INT4ï¼ŒKernel è®¡ç®—æ—¶ï¼Œè®¿å­˜é‡ç›´æ¥é™ä¸º FP16 æ¨¡å‹çš„ 1/4ï¼Œå¤§å¹…é™ä½äº†è®¿å­˜æˆæœ¬ã€‚Weight Only æ˜¯æŒ‡ä»…é‡åŒ–æƒé‡ï¼Œæ•°å€¼è®¡ç®—ä¾ç„¶é‡‡ç”¨ FP16ï¼ˆéœ€è¦å°† INT4 æƒé‡åé‡åŒ–ï¼‰ã€‚</p><h2 id="ä½œä¸š">ä½œä¸š</h2><p><img src="https://picture.fanfer.top/img/intern51.png" alt="æˆªå±2024-04-22 13.20.58.png"></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬”è®° </tag>
            
            <tag> InternLM2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¹¦ç”ŸÂ·æµ¦è¯­å¤§æ¨¡å‹å®æˆ˜è¥ï¼ˆå››ï¼‰ï¼šXTuner å¾®è°ƒ LLMï¼š1.8Bã€å¤šæ¨¡æ€ã€Agent</title>
      <link href="/2024/04/18/InternLM2XTurn/"/>
      <url>/2024/04/18/InternLM2XTurn/</url>
      
        <content type="html"><![CDATA[<p>è§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV15m421j78d/?vd_source=3194af3e77968cb10b1d50711d07106a">https://www.bilibili.com/video/BV15m421j78d/?vd_source=3194af3e77968cb10b1d50711d07106a</a></p><p>æ–‡æ¡£ï¼š<a href="https://github.com/InternLM/Tutorial/blob/camp2/xtuner/readme.md">https://github.com/InternLM/Tutorial/blob/camp2/xtuner/readme.md</a></p><h2 id="ç¬”è®°">ç¬”è®°</h2><p>ä¸¤ç§FinetuneèŒƒå¼<br>LLM çš„ä¸‹æ¸¸åº”ç”¨ä¸­ï¼Œå¢é‡é¢„è®­ç»ƒå’ŒæŒ‡ä»¤è·Ÿéšæ˜¯ç»å¸¸ä¼šç”¨åˆ°ä¸¤ç§çš„å¾®è°ƒæ¨¡å¼</p><p><strong>å¢é‡é¢„è®­ç»ƒå¾®è°ƒ</strong><br>ä½¿ç”¨åœºæ™¯ï¼šè®©åŸºåº§æ¨¡å‹å­¦ä¹ åˆ°ä¸€äº›æ–°çŸ¥è¯†ï¼Œå¦‚æŸä¸ªå‚ç±»é¢†åŸŸçš„å¸¸è¯†è®­ç»ƒæ•°æ®ï¼šæ–‡ç« ã€ä¹¦ç±ã€ä»£ç ç­‰<br><strong>æŒ‡ä»¤è·Ÿéšå¾®è°ƒ</strong><br>ä½¿ç”¨åœºæ™¯ï¼šè®©æ¨¡å‹å­¦ä¼šå¯¹è¯æ¨¡æ¿ï¼Œæ ¹æ®äººç±»æŒ‡ä»¤è¿›è¡Œå¯¹è¯è®­ç»ƒæ•°æ®ï¼šé«˜è´¨é‡çš„å¯¹è¯ã€é—®ç­”æ•°æ®</p><p><img src="https://picture.fanfer.top/img/intern41.png" alt="Untitled"></p><p><img src="https://picture.fanfer.top/img/intern42.png" alt="æˆªå±2024-04-22 10.55.29.png"></p><h2 id="xturn">XTurn</h2><h3 id="lora-qlora">LoRA &amp; QLoRA</h3><h3 id="lora-low-rank-adaptation-of-large-language-models">LoRA: Low-Rank Adaptation of Large Language Models</h3><ul><li>LLM çš„å‚æ•°é‡ä¸»è¦é›†ä¸­åœ¨æ¨¡å‹ä¸­çš„ Linear, è®­ç»ƒè¿™äº›å‚æ•°ä¼šè€—è´¹å¤§é‡çš„æ˜¾å­˜</li><li>LoRA é€šè¿‡åœ¨åŸæœ¬çš„ Linear æ—ï¼Œæ–°å¢ä¸€ä¸ªæ”¯è·¯ï¼ŒåŒ…å«ä¸¤ä¸ªè¿ç»­çš„å° linearï¼Œæ–°å¢çš„è¿™ä¸ªæ”¯è·¯é€šå¸¸å«åš Adapter</li><li>Adapter å‚æ•°é‡è¿œå°äºåŸæœ¬çš„ Linearï¼Œèƒ½å¤§å¹…é™ä½è®­ç»ƒçš„æ˜¾å­˜æ¶ˆè€—</li></ul><h3 id="qlora-quantized-llms-with-low-rank-adapters">QLoRA: Quantized LLMs with Low-Rank Adapters</h3><ul><li>4ä½NormalFloaté‡åŒ–ï¼šè¿™æ˜¯ä¸€ç§æ”¹è¿›é‡åŒ–çš„æ–¹æ³•ï¼Œç¡®ä¿æ¯ä¸ªé‡åŒ–ä»“ä¸­æœ‰ç›¸åŒæ•°é‡çš„å€¼ï¼Œè¿™é¿å…äº†è®¡ç®—é—®é¢˜å’Œå¼‚å¸¸å€¼çš„é”™è¯¯ã€‚</li><li>åŒé‡åŒ–ï¼šå¯¹é‡åŒ–å¸¸é‡å†æ¬¡é‡åŒ–ä»¥èŠ‚çœé¢å¤–å†…å­˜çš„è¿‡ç¨‹ã€‚</li><li>ç»Ÿä¸€å†…å­˜åˆ†é¡µï¼šå®ƒä¾èµ–äºNVIDIAç»Ÿä¸€å†…å­˜ç®¡ç†ï¼Œè‡ªåŠ¨å¤„ç†CPUå’ŒGPUä¹‹é—´çš„é¡µåˆ°é¡µä¼ è¾“ï¼Œå®ƒå¯ä»¥ä¿è¯GPUå¤„ç†æ— é”™ï¼Œç‰¹åˆ«æ˜¯åœ¨GPUå¯èƒ½è€—å°½å†…å­˜çš„æƒ…å†µä¸‹ã€‚</li></ul><p><img src="https://picture.fanfer.top/img/intern43.png" alt="Untitled"></p><p>XTuner ä¸€ä¸ªå¤§è¯­è¨€æ¨¡å‹&amp;å¤šæ¨¡æ€æ¨¡å‹å¾®è°ƒå·¥å…·ç®±ã€‚<em>ç”±</em>Â <em>MMRazor</em>Â <em>å’Œ</em>Â <em>MMDeploy</em>Â <em>è”åˆå¼€å‘ã€‚</em></p><ul><li>ğŸ¤“Â <strong>å‚»ç“œåŒ–ï¼š</strong>Â ä»¥ é…ç½®æ–‡ä»¶ çš„å½¢å¼å°è£…äº†å¤§éƒ¨åˆ†å¾®è°ƒåœºæ™¯ï¼Œ<strong>0åŸºç¡€çš„éä¸“ä¸šäººå‘˜ä¹Ÿèƒ½ä¸€é”®å¼€å§‹å¾®è°ƒ</strong>ã€‚</li><li>ğŸƒÂ <strong>è½»é‡çº§ï¼š</strong>Â å¯¹äº 7B å‚æ•°é‡çš„LLMï¼Œ<strong>å¾®è°ƒæ‰€éœ€çš„æœ€å°æ˜¾å­˜ä»…ä¸º 8GB</strong>Â ï¼šÂ <strong>æ¶ˆè´¹çº§æ˜¾å¡âœ…ï¼Œcolabâœ…</strong></li></ul><p><img src="https://picture.fanfer.top/img/intern44.png" alt="Untitled"></p><p><img src="https://picture.fanfer.top/img/intern45.png" alt="Untitled"></p><h3 id="ms-agent-æ•°æ®é›†">MS-Agent æ•°æ®é›†</h3><p>è¿™ä¸ªæ•°æ®é›†æ¯”è¾ƒæœ‰æ„æ€ï¼Œèƒ½å¤Ÿèµ‹äºˆå¤§æ¨¡å‹è°ƒç”¨apiçš„agentèƒ½åŠ›ï¼ŒåŸç†ï¼š</p><ul><li>æ¨¡å‹çš„å›å¤ä¸­ä¼šåŒ…æ‹¬æ’ä»¶è°ƒç”¨ä»£ç å’Œæ‰§è¡Œä»£ç <ul><li>è°ƒç”¨ä»£ç æ˜¯ LLM ç”Ÿæˆçš„</li><li>æ‰§è¡Œä»£ç æ˜¯éœ€è¦è°ƒç”¨æœåŠ¡æ¥ç”Ÿæˆç»“æœçš„ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦ç»™Â <code>xtuner chat</code>Â å¢åŠ Â <code>-lagent</code>Â å‚æ•°æ¥å®ç°</li></ul></li></ul><h2 id="ä½œä¸š">ä½œä¸š</h2><p><img src="https://picture.fanfer.top/img/intern46.png" alt="Untitled"></p><p><img src="https://picture.fanfer.top/img/intern47.png" alt="Untitled"></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬”è®° </tag>
            
            <tag> InternLM2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¹¦ç”ŸÂ·æµ¦è¯­å¤§æ¨¡å‹å®æˆ˜è¥ï¼ˆä¸‰ï¼‰ï¼šInternLM RAG</title>
      <link href="/2024/04/11/InternLM2RAG/"/>
      <url>/2024/04/11/InternLM2RAG/</url>
      
        <content type="html"><![CDATA[<p>è§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1QA4m1F7t4/?vd_source=3194af3e77968cb10b1d50711d07106a">https://www.bilibili.com/video/BV1QA4m1F7t4/?vd_source=3194af3e77968cb10b1d50711d07106a</a></p><p>æ•™ç¨‹ï¼š<a href="https://github.com/InternLM/Tutorial/blob/camp2/huixiangdou/readme.md">https://github.com/InternLM/Tutorial/blob/camp2/huixiangdou/readme.md</a></p><p>èŒ´é¦™è±†ï¼š<a href="https://github.com/InternLM/HuixiangDou">https://github.com/InternLM/HuixiangDou</a></p><p>LLMçš„å±€é™æ€§ï¼š</p><ul><li>çŸ¥è¯†æ—¶æ•ˆæ€§å—é™ï¼šå¦‚ä½•è®©LLMèƒ½å¤Ÿè·å–æœ€æ–°çš„çŸ¥è¯†</li><li>ä¸“ä¸šèƒ½åŠ›æœ‰é™ï¼šå¦‚ä½•æ‰“é€ å‚åŸŸå¤§æ¨¡å‹</li><li>å®šåˆ¶åŒ–æˆæœ¬é«˜ï¼šå¦‚ä½•æ‰“é€ ä¸ªäººä¸“å±çš„LLMåº”</li></ul><p>ä¸¤ç§å¼€å‘èŒƒå¼ï¼š<br>RAGï¼šæ£€ç´¢å¢å¼ºç”Ÿæˆ</p><p>å¤–æŒ‚çŸ¥è¯†åº“ï¼Œä»çŸ¥è¯†åº“ä¸­åŒ¹é…åˆ°ç›¸åº”æ–‡æ¡£ï¼Œç„¶åå’Œæé—®ä¸€èµ·äº¤ç»™LLM</p><p>ä½æˆæœ¬ã€å¯ä»¥å®æ—¶æ›´æ–°ã€æ”¶åˆ°å‡ åº§å½±å“ã€å•æ¬¡å›ç­”çŸ¥è¯†æœ‰é™</p><p>Finetuneï¼šå¾®è°ƒ</p><p>å¯ä»¥ä¸ªæ€§åŒ–å¾®è°ƒã€çŸ¥è¯†è¦†ç›–é¢å¹¿ã€æˆæœ¬é«˜æ˜‚ã€æ— æ³•å®æ—¶æ›´æ–°</p><h2 id="ragï¼š">RAGï¼š</h2><p>RAGï¼ˆRetrieval Augmented Generationï¼‰æŠ€æœ¯ï¼Œé€šè¿‡æ£€ç´¢ä¸ç”¨æˆ·è¾“å…¥ç›¸å…³çš„ä¿¡æ¯ç‰‡æ®µï¼Œå¹¶ç»“åˆ<em><strong>å¤–éƒ¨çŸ¥è¯†åº“</strong></em>æ¥ç”Ÿæˆæ›´å‡†ç¡®ã€æ›´ä¸°å¯Œçš„å›ç­”ã€‚è§£å†³ LLMs åœ¨å¤„ç†çŸ¥è¯†å¯†é›†å‹ä»»åŠ¡æ—¶å¯èƒ½é‡åˆ°çš„æŒ‘æˆ˜, å¦‚å¹»è§‰ã€çŸ¥è¯†è¿‡æ—¶å’Œç¼ºä¹é€æ˜ã€å¯è¿½æº¯çš„æ¨ç†è¿‡ç¨‹ç­‰ã€‚æä¾›æ›´å‡†ç¡®çš„å›ç­”ã€é™ä½æ¨ç†æˆæœ¬ã€å®ç°å¤–éƒ¨è®°å¿†ã€‚</p><p><img src="https://picture.fanfer.top/img/internLM31.png" alt="Untitled"></p><h2 id="langchain">LangChain</h2><p>LangChain æ¡†æ¶æ˜¯ä¸€ä¸ªå¼€æºå·¥å…·ï¼Œé€šè¿‡ä¸ºå„ç§LLM æä¾›é€šç”¨æ¥å£æ¥ç®€åŒ–åº”ç”¨ç¨‹åºçš„å¼€å‘æµç¨‹ï¼Œå¸®åŠ©å¼€å‘è€…è‡ªç”±æ„å»ºLLMåº”ç”¨ã€‚</p><p>LangChain çš„æ ¸å¿ƒç»„æˆæ¨¡å—ï¼š</p><ul><li><p>é“¾ï¼ˆChainsï¼‰ï¼šå°†ç»„ä»¶ç»„åˆå®ç°ç«¯åˆ°ç«¯åº”ç”¨ï¼Œé€šè¿‡ä¸€ä¸ªå¯¹è±¡å°è£…å®ç°ä¸€ç³»åˆ—<br>LLM æ“ä½œ</p></li><li><p>Eg. æ£€ç´¢é—®ç­”é“¾ï¼Œè¦†ç›–å®ç°äº† RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰çš„å…¨éƒ¨æµ</p><p><img src="https://picture.fanfer.top/img/internLM32.png" alt="æˆªå±2024-03-29 17.44.19.png"></p></li></ul><h3 id="æ„å»ºå‘é‡æ•°æ®åº“">æ„å»ºå‘é‡æ•°æ®åº“</h3><h3 id="åŠ è½½æºæ–‡ä»¶">åŠ è½½æºæ–‡ä»¶</h3><ul><li>ç¡®å®šæºæ–‡ä»¶ç±»å‹ï¼Œé’ˆå¯¹ä¸åŒç±»å‹çš„æºæ–‡ä»¶é€‰ç”¨ä¸åŒçš„åŠ è½½å™¨<ul><li>æ ¸å¿ƒåœ¨äºå°†å¸¦æ ¼å¼çš„æ–‡æœ¬è½¬åŒ–ä¸ºæ— æ ¼å¼çš„å­—ç¬¦ä¸²</li></ul></li></ul><h3 id="æ–‡æ¡£åˆ†å—">æ–‡æ¡£åˆ†å—</h3><ul><li>ç”±äºå•ä¸ªæ–‡æ¡£å¾€å¾€è¶…è¿‡æ¨¡å‹ä¸Šä¸‹æ–‡ä¸Šé™ï¼Œæˆ‘ä»¬éœ€è¦å¯¹åŠ è½½çš„æ–‡æ¡£è¿›è¡Œåˆ‡åˆ†<ul><li>ä¸€èˆ¬æŒ‰å­—ç¬¦ä¸²é•¿åº¦è¿›è¡Œåˆ†å‰²</li><li>å¯ä»¥æ‰‹åŠ¨æ§åˆ¶åˆ†å‰²å—çš„é•¿åº¦å’Œé‡å åŒºé—´é•¿åº¦</li></ul></li></ul><h3 id="æ–‡æ¡£å‘é‡åŒ–">æ–‡æ¡£å‘é‡åŒ–</h3><ul><li>ä½¿ç”¨å‘é‡æ•°æ®åº“æ¥æ”¯æŒè¯­ä¹‰æ£€ç´¢ï¼Œéœ€è¦å°†æ–‡æ¡£å‘é‡åŒ–å­˜å…¥å‘é‡æ•°æ®åº“<ul><li>å¯ä»¥ä½¿ç”¨ä»»æ„ä¸€ç§ Embedding æ¨¡å‹æ¥è¿›è¡Œå‘é‡åŒ–</li><li>å¯ä»¥ä½¿ç”¨å¤šç§æ”¯æŒè¯­ä¹‰æ£€ç´¢çš„å‘é‡æ•°æ®åº“ï¼Œä¸€èˆ¬ä½¿ç”¨è½»é‡çº§çš„ Chroma</li></ul></li></ul><h3 id="æ­å»ºçŸ¥è¯†åº“åŠ©æ‰‹">æ­å»ºçŸ¥è¯†åº“åŠ©æ‰‹</h3><h3 id="å°†-internlm-æ¥å…¥-langchain">å°† InternLM æ¥å…¥ LangChain</h3><ul><li>LangChain æ”¯æŒè‡ªå®šä¹‰ LLMï¼Œå¯ä»¥ç›´æ¥æ¥å…¥åˆ°æ¡†æ¶ä¸­</li><li>æˆ‘ä»¬åªéœ€å°† InternLM éƒ¨ç½²åœ¨æœ¬åœ°ï¼Œå¹¶å°è£…ä¸€ä¸ªè‡ªå®šä¹‰ LLM ç±»ï¼Œè°ƒç”¨æœ¬åœ° InternLM å³å¯</li></ul><h3 id="æ„å»ºæ£€ç´¢é—®ç­”é“¾">æ„å»ºæ£€ç´¢é—®ç­”é“¾</h3><ul><li>LangChain æä¾›äº†æ£€ç´¢é—®ç­”é“¾æ¨¡ç‰ˆï¼Œå¯ä»¥è‡ªåŠ¨å®ç°çŸ¥è¯†æ£€ç´¢ã€Prompt åµŒå…¥ã€LLM é—®ç­”çš„å…¨éƒ¨æµç¨‹</li><li>å°†åŸºäº InternLM çš„è‡ªå®šä¹‰ LLM å’Œå·²æ„å»ºçš„å‘é‡æ•°æ®åº“æ¥å…¥åˆ°æ£€ç´¢é—®ç­”é“¾çš„ä¸Šæ¸¸</li><li>è°ƒç”¨æ£€ç´¢é—®ç­”é“¾ï¼Œå³å¯å®ç°çŸ¥è¯†åº“åŠ©æ‰‹çš„æ ¸å¿ƒåŠŸèƒ½</li></ul><p>!<a href="https://picture.fanfer.top/img/internLM33.webp">https://picture.fanfer.top/img/internLM33.webp</a></p><ul><li>åŸºäºRAGçš„é—®ç­”ç³»ç»Ÿæ€§èƒ½æ ¸å¿ƒå—é™äºï¼š<ul><li>æ£€ç´¢ç²¾åº¦</li><li>Promptæ€§èƒ½</li></ul></li><li>ä¸€äº›å¯èƒ½çš„ä¼˜åŒ–ç‚¹ï¼š<ul><li>æ£€ç´¢æ–¹é¢ï¼š<ul><li>åŸºäºè¯­ä¹‰è¿›è¡Œåˆ†å‰²ï¼Œä¿è¯æ¯ä¸€ä¸ªchunkçš„è¯­ä¹‰å®Œæ•´</li><li>ç»™æ¯ä¸€ä¸ªchunkç”Ÿæˆæ¦‚æ‹¬æ€§ç´¢å¼•ï¼Œæ£€ç´¢æ—¶åŒ¹é…ç´¢å¼•</li></ul></li></ul></li></ul><p>Promptæ–¹é¢ï¼šè¿­ä»£ä¼˜åŒ–Promptç­–ç•¥</p><p><img src="https://picture.fanfer.top/img/internLM34.png" alt="Untitled"></p><p><a href=""></a></p><p><img src="https://picture.fanfer.top/img/internLM35.png" alt="Untitled"></p><p><img src="https://picture.fanfer.top/img/internLM36.png" alt="Untitled"></p><p><img src="https://picture.fanfer.top/img/internLM37.png" alt="Untitled"></p><p><img src="https://picture.fanfer.top/img/internLM38.png" alt="Untitled"></p><p><img src="https://picture.fanfer.top/img/internLM39.png" alt="Untitled"></p><p><img src="https://picture.fanfer.top/img/internLM310.png" alt="Untitled"></p><p>ä½œä¸šï¼š</p><p><img src="https://picture.fanfer.top/img/internLM311.png" alt="æˆªå±2024-04-11 19.09.41.png"></p><p><img src="https://picture.fanfer.top/img/internLM3111.png" alt="æˆªå±2024-04-11 19.09.41.png"></p><p><img src="https://picture.fanfer.top/img/internLM312.png" alt="æˆªå±2024-04-11 19.09.41.png"></p><p><img src="https://picture.fanfer.top/img/internLM313.png" alt="æˆªå±2024-04-11 19.09.41.png"></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬”è®° </tag>
            
            <tag> InternLM2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¹¦ç”ŸÂ·æµ¦è¯­å¤§æ¨¡å‹å®æˆ˜è¥ï¼ˆäºŒï¼‰ï¼šInternLM Demo</title>
      <link href="/2024/04/01/InternLM2Demo/"/>
      <url>/2024/04/01/InternLM2Demo/</url>
      
        <content type="html"><![CDATA[<p>githubï¼š<a href="https://github.com/InternLM/Tutorial/blob/camp2/helloworld/hello_world.md">https://github.com/InternLM/Tutorial/tree/camp2</a></p><p>è§†é¢‘åœ°å€ï¼š<a href="https://www.bilibili.com/video/BV1AH4y1H78d/">https://www.bilibili.com/video/BV1AH4y1H78d/</a></p><h2 id="å·¥å…·è®°å½•">å·¥å…·è®°å½•</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># ä»æœ¬åœ°ä½¿ç”¨ ssh è¿æ¥ studio ç«¯å£</span><br><span class="line"># å°†ä¸‹æ–¹ç«¯å£å· 38374 æ›¿æ¢æˆè‡ªå·±çš„ç«¯å£å·</span><br><span class="line">ssh -CNg -L 6006:127.0.0.1:6006 root@ssh.intern-ai.org.cn -p 38374</span><br></pre></td></tr></table></figure><p><strong>æ¨¡å‹ä¸‹è½½</strong></p><p><strong>6.2.1Â Hugging Face</strong></p><p>ä½¿ç”¨Â <code>Hugging Face</code>Â å®˜æ–¹æä¾›çš„Â <code>huggingface-cli</code>Â å‘½ä»¤è¡Œå·¥å…·ã€‚å®‰è£…ä¾èµ–:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -U huggingface_hub</span><br></pre></td></tr></table></figure><p>ç„¶åæ–°å»ºÂ <code>python</code>Â æ–‡ä»¶ï¼Œå¡«å…¥ä»¥ä¸‹ä»£ç ï¼Œè¿è¡Œå³å¯ã€‚</p><ul><li>resume-downloadï¼šæ–­ç‚¹ç»­ä¸‹</li><li>local-dirï¼šæœ¬åœ°å­˜å‚¨è·¯å¾„ã€‚</li></ul><p>å…¶ä¸­ linux ç¯å¢ƒä¸‹éœ€è¦å¡«å†™ç»å¯¹è·¯å¾„.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line"># ä¸‹è½½æ¨¡å‹</span><br><span class="line">os.system(&#x27;huggingface-cli download --resume-download internlm/internlm2-chat-7b --local-dir your_path&#x27;)</span><br></pre></td></tr></table></figure><p>ä»¥ä¸‹å†…å®¹å°†å±•ç¤ºä½¿ç”¨Â <code>huggingface_hub</code>Â ä¸‹è½½æ¨¡å‹ä¸­çš„éƒ¨åˆ†æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">from huggingface_hub import hf_hub_download  # Load model directly</span><br><span class="line"></span><br><span class="line">hf_hub_download(repo_id=&quot;internlm/internlm2-7b&quot;, filename=&quot;config.json&quot;)</span><br></pre></td></tr></table></figure><p><strong>6.2.2Â ModelScope</strong></p><p>ä½¿ç”¨Â <code>modelscope</code>Â ä¸­çš„Â <code>snapshot_download</code>Â å‡½æ•°ä¸‹è½½æ¨¡å‹ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ¨¡å‹åç§°ï¼Œå‚æ•°Â <code>cache_dir</code>Â ä¸ºæ¨¡å‹çš„ä¸‹è½½è·¯å¾„ã€‚</p><p>æ³¨æ„ï¼š<code>cache_dir</code>Â æœ€å¥½ä¸ºç»å¯¹è·¯å¾„ã€‚</p><p>å®‰è£…ä¾èµ–ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install modelscope==1.9.5</span><br><span class="line">pip install transformers==4.35.2</span><br></pre></td></tr></table></figure><p>åœ¨å½“å‰ç›®å½•ä¸‹æ–°å»ºÂ <code>python</code>Â æ–‡ä»¶ï¼Œå¡«å…¥ä»¥ä¸‹ä»£ç ï¼Œè¿è¡Œå³å¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import torch</span><br><span class="line">from modelscope import snapshot_download, AutoModel, AutoTokenizer</span><br><span class="line">import os</span><br><span class="line">model_dir = snapshot_download(&#x27;Shanghai_AI_Laboratory/internlm2-chat-7b&#x27;, cache_dir=&#x27;your path&#x27;, revision=&#x27;master&#x27;)</span><br></pre></td></tr></table></figure><p><strong>6.2.3Â OpenXLab</strong></p><p><code>OpenXLab</code>Â å¯ä»¥é€šè¿‡æŒ‡å®šæ¨¡å‹ä»“åº“çš„åœ°å€ï¼Œä»¥åŠéœ€è¦ä¸‹è½½çš„æ–‡ä»¶çš„åç§°ï¼Œæ–‡ä»¶æ‰€éœ€ä¸‹è½½çš„ä½ç½®ç­‰ï¼Œç›´æ¥ä¸‹è½½æ¨¡å‹æƒé‡æ–‡ä»¶ï¼Œä½¿ç”¨Â <code>download</code>å‡½æ•°å¯¼å…¥æ¨¡å‹ä¸­å¿ƒçš„æ¨¡å‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import torch</span><br><span class="line">import os</span><br><span class="line">from transformers import AutoModelForCausalLM, AutoTokenizer, AutoModel</span><br><span class="line">base_path = &#x27;./local_files&#x27;</span><br><span class="line">os.system(&#x27;apt install git&#x27;)</span><br><span class="line">os.system(&#x27;apt install git-lfs&#x27;)</span><br><span class="line">os.system(f&#x27;git clone https://code.openxlab.org.cn/Usr_name/repo_name.git &#123;base_path&#125;&#x27;)</span><br><span class="line">os.system(f&#x27;cd &#123;base_path&#125; &amp;&amp; git lfs pull&#x27;)</span><br></pre></td></tr></table></figure><p><strong>6.3Â ï¼ˆå¯é€‰å‚è€ƒï¼‰è½¯é“¾æ¥æ¸…é™¤æ–¹æ³•</strong></p><p>å½“æˆ‘ä»¬å»ºç«‹å®‰å…¨é“¾æ¥ä¹‹åï¼Œå¦‚æœæƒ³è¦å°†å…¶åˆ é™¤å¯ä»¥é€‰æ‹©ä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unlink link_name</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå½“æˆ‘æƒ³åˆ é™¤è½¯é“¾æ¥Â <code>/root/demo/internlm2-chat-7b</code>Â æ—¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /root/demo/</span><br><span class="line">unlink internlm2-chat-7b</span><br></pre></td></tr></table></figure><h2 id="ä½œä¸š">ä½œä¸š</h2><p>chatï¼š</p><p><img src="https://picture.fanfer.top/img/Intern12.png" alt="Untitled"></p><h2 id="lagent">Lagent</h2><p>Lagent æ˜¯ä¸€ä¸ªè½»é‡çº§ã€å¼€æºçš„åŸºäºå¤§è¯­è¨€æ¨¡å‹çš„æ™ºèƒ½ä½“ï¼ˆagentï¼‰æ¡†æ¶ï¼Œæ”¯æŒç”¨æˆ·å¿«é€Ÿåœ°å°†ä¸€ä¸ªå¤§è¯­è¨€æ¨¡å‹è½¬å˜ä¸ºå¤šç§ç±»å‹çš„æ™ºèƒ½ä½“ï¼Œå¹¶æä¾›äº†ä¸€äº›å…¸å‹å·¥å…·ä¸ºå¤§è¯­è¨€æ¨¡å‹èµ‹èƒ½ã€‚å®ƒçš„æ•´ä¸ªæ¡†æ¶å›¾å¦‚ä¸‹:</p><p>!<a href="https://github.com/InternLM/Tutorial/raw/camp2/helloworld/images/Lagent-1.png">https://github.com/InternLM/Tutorial/raw/camp2/helloworld/images/Lagent-1.png</a></p><p>Lagent çš„ç‰¹æ€§æ€»ç»“å¦‚ä¸‹ï¼š</p><ul><li>æµå¼è¾“å‡ºï¼šæä¾› stream_chat æ¥å£ä½œæµå¼è¾“å‡ºï¼Œæœ¬åœ°å°±èƒ½æ¼”ç¤ºé…·ç‚«çš„æµå¼ Demoã€‚</li><li>æ¥å£ç»Ÿä¸€ï¼Œè®¾è®¡å…¨é¢å‡çº§ï¼Œæå‡æ‹“å±•æ€§ï¼ŒåŒ…æ‹¬ï¼š<ul><li>Model : ä¸è®ºæ˜¯ OpenAI API, Transformers è¿˜æ˜¯æ¨ç†åŠ é€Ÿæ¡†æ¶ LMDeploy ä¸€ç½‘æ‰“å°½ï¼Œæ¨¡å‹åˆ‡æ¢å¯ä»¥æ¸¸åˆƒæœ‰ä½™ï¼›</li><li>Action: ç®€å•çš„ç»§æ‰¿å’Œè£…é¥°ï¼Œå³å¯æ‰“é€ è‡ªå·±ä¸ªäººçš„å·¥å…·é›†ï¼Œä¸è®º InternLM è¿˜æ˜¯ GPT å‡å¯é€‚é…ï¼›</li><li>Agentï¼šä¸ Model çš„è¾“å…¥æ¥å£ä¿æŒä¸€è‡´ï¼Œæ¨¡å‹åˆ°æ™ºèƒ½ä½“çš„èœ•å˜åªéœ€ä¸€æ­¥ï¼Œä¾¿æ·å„ç§ agent çš„æ¢ç´¢å®ç°ï¼›</li></ul></li><li>æ–‡æ¡£å…¨é¢å‡çº§ï¼ŒAPI æ–‡æ¡£å…¨è¦†ç›–ã€‚</li></ul><p>è°ƒç”¨æ•°æ®åˆ†æï¼š<br><img src="https://picture.fanfer.top/img/Intern11.png" alt="Untitled"></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬”è®° </tag>
            
            <tag> InternLM2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¹¦ç”ŸÂ·æµ¦è¯­å¤§æ¨¡å‹å®æˆ˜è¥ï¼ˆä¸€ï¼‰ï¼šä¹¦ç”ŸÂ·æµ¦è¯­å¤§æ¨¡å‹å…¨é“¾è·¯å¼€æºä½“ç³»</title>
      <link href="/2024/03/28/InternLM2/"/>
      <url>/2024/03/28/InternLM2/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¹¦ç”Ÿ-æµ¦è¯­å¤§æ¨¡å‹å®æˆ˜è¥-ä¸€-ï¼šä¹¦ç”Ÿ-æµ¦è¯­å¤§æ¨¡å‹å…¨é“¾è·¯å¼€æºä½“ç³»"><strong>ä¹¦ç”ŸÂ·æµ¦è¯­å¤§æ¨¡å‹å®æˆ˜è¥ï¼ˆä¸€ï¼‰ï¼šä¹¦ç”ŸÂ·æµ¦è¯­å¤§æ¨¡å‹å…¨é“¾è·¯å¼€æºä½“ç³»</strong></h1><p>githubï¼š<a href="https://github.com/InternLM/Tutorial/tree/camp2">https://github.com/InternLM/Tutorial/tree/camp2</a></p><p>InternLM2 æŠ¥å‘Šï¼š<a href="https://arxiv.org/pdf/2403.17297.pdf">https://arxiv.org/pdf/2403.17297.pdf</a></p><p>è§†é¢‘åœ°å€ï¼š<a href="https://www.bilibili.com/video/BV1Vx421X72D/">https://www.bilibili.com/video/BV1Vx421X72D/</a></p><p><img src="https://picture.fanfer.top/img/Intern1.jpeg" alt="Untitled"></p><p>æ¨¡å‹åˆ°åº”ç”¨çš„å…¸å‹æµç¨‹ï¼š</p><p>å¯¹äºæœºå™¨äººé¢†åŸŸï¼Œæ„å»ºæ™ºèƒ½ä½“åº”è¯¥æ›´èƒ½æ»¡è¶³åº”ç”¨åœºæ™¯çš„è¦æ±‚ã€‚</p><p>é¡¹ç›®æ¡ˆä¾‹ï¼š</p><p><a href="https://github.com/BestAnHongjun/InternDog">https://github.com/BestAnHongjun/InternDog</a></p><p>é’ˆå¯¹æ°´é¢æ— äººè‰‡è€Œè¨€ï¼Œåœ¨è®¾è®¡çš„è¿‡ç¨‹ä¸­ï¼Œåº”è¯¥æœ‰è¾ƒå¥½çš„é¡¶å±‚è®¾è®¡ï¼Œå“ªäº›ä¿¡æ¯ä»å¤–ç•ŒAPIè·å–ï¼Œå“ªäº›åŠŸèƒ½é€šè¿‡è°ƒç”¨APIæ‰§è¡Œï¼ŒåŒæ—¶è¦æ³¨æ„å·¥å…·æ˜¯å¤‡é€‰ï¼Œåº”è¯¥æ˜¯é€šè¿‡é€‰æ‹©å·¥ä½œï¼Œå®ŒæˆæŒ‡ä»¤ï¼Œè€Œä¸æ˜¯å˜æˆåˆ†ç±»ä»»åŠ¡ï¼Œæœºæ¢°åœ°è°ƒç”¨</p><p>åŒæ—¶ï¼Œé’ˆå¯¹ç‰¹å®šæƒ…å¢ƒä¸‹ï¼Œåº”è¯¥é€šè¿‡ä»£ç ç”Ÿæˆï¼Œä»è€Œæ„å»ºæ–°çš„å†…éƒ¨API</p><p><img src="https://picture.fanfer.top/img/Intern2.jpeg" alt="Untitled"></p><p><img src="https://picture.fanfer.top/img/Intern3.jpeg" alt="Untitled"></p><p>Lagentï¼Œå€ŸåŠ©AutoGPTç­‰æ–¹å¼ï¼Œå®ç°æ›´å¥½çš„å·¥å…·é€‰æ‹©ã€‚</p><p>åŒæ—¶ä½¿ç”¨æ›´åŠ ä¸°å¯Œçš„å¤šæ¨¡æ€æ™ºèƒ½ä½“å·¥å…·ç®±ï¼Œå¤šæ¨¡æ€çš„ä¿¡æ¯è¾“å…¥å¯¹äºæœºå™¨äººè€Œè¨€åº”è¯¥æ˜¯å¾ˆé‡è¦çš„ä¿¡æ¯è¡¥å……</p><p><img src="https://picture.fanfer.top/img/Intern4.jpeg" alt="Untitled"></p><p>å…³äºå¾®è°ƒï¼š</p><p>å¢é‡è®­ç»ƒçš„ç›®çš„æ˜¯äº†è§£å‚ç±»é¢†åŸŸçš„çŸ¥è¯†</p><p>æœ‰ç›‘ç£å¾®è°ƒçš„ç›®çš„æ˜¯å®Œæˆé«˜è´¨é‡çš„ç”Ÿæˆï¼Œåœ¨è®¡ç®—èƒ½åŠ›ä¸è¶³çš„æ—¶å€™ï¼Œå¯¹éƒ¨åˆ†å‚æ•°è¿›è¡Œå¾®è°ƒ</p><p><img src="https://picture.fanfer.top/img/Intern5.jpeg" alt="Untitled"></p><p>éƒ¨ç½²ï¼šä¸å¤ªäº†è§£ï¼Œæ„Ÿè§‰æ¶‰åŠåˆ°æ›´å¤šçš„åº•å±‚ã€‚</p><p>å¦‚ä½•å°†æ¨¡å‹è½»é‡åŒ–ï¼Œä»è€Œèƒ½å®ç°ç«¯ä¾§éƒ¨ç½²ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªå¯ä»¥çœ‹çš„ç‚¹</p><p><img src="https://picture.fanfer.top/img/Intern6.jpeg" alt="Untitled"></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬”è®° </tag>
            
            <tag> InternLM2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¿ä¸ä¸Šä¸€äº›ç½‘ç«™çš„è§£å†³æ–¹æ¡ˆ</title>
      <link href="/2024/02/05/%E8%BF%9E%E4%B8%8D%E4%B8%8A%E4%B8%80%E4%BA%9B%E7%BD%91%E7%AB%99%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
      <url>/2024/02/05/%E8%BF%9E%E4%B8%8D%E4%B8%8A%E4%B8%80%E4%BA%9B%E7%BD%91%E7%AB%99%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<p>å¦‚æœæ˜¯ä» <a href="http://huggingface.co/">huggingface.co</a> ä¸‹è½½æ¨¡å‹ï¼Œç”±äºå›½å†…ä¸èƒ½è®¿é—®ï¼Œæ‰€ä»¥å»ºè®®å…ˆé…ç½®ä¸€ä¸‹ç¯å¢ƒå˜é‡ï¼Œ<br>é€šè¿‡è®¿é—®å›½å†…é•œåƒç«™ç‚¹ <a href="https://hf-mirror.xn--com-128di84bv9wbmeb04g/">https://hf-mirror.comæ¥ä¸‹è½½æ¨¡å‹</a>ã€‚</p><p>ä½¿ç”¨<strong>huggingface å®˜æ–¹æä¾›çš„Â <code>[huggingface-cli</code>](<a href="https://hf-mirror.com/docs/huggingface_hub/guides/download#download-from-the-cli">https://hf-mirror.com/docs/huggingface_hub/guides/download#download-from-the-cli</a>)Â å‘½ä»¤è¡Œå·¥å…·ã€‚</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -U huggingface_hub</span><br></pre></td></tr></table></figure><p>åŸºæœ¬å‘½ä»¤ç¤ºä¾‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> HF_ENDPOINT=https://hf-mirror.com</span><br><span class="line">huggingface-cli download --resume-download --local-dir-use-symlinks False bigscience/bloom-560m --local-dir bloom-560m</span><br></pre></td></tr></table></figure><p>PSï¼šè¯¦æƒ…å‚è€ƒ<a href="https://fanfer.top/2024/01/18/HuggingFace-%E4%B8%8B%E8%BD%BD%E6%A8%A1%E5%9E%8B/">https://fanfer.top/2024/01/18/HuggingFace-ä¸‹è½½æ¨¡å‹/</a>å’Œ<a href="https://hf-mirror.com/">https://hf-mirror.com</a></p><p>å¦‚æœæ˜¯å›½å†…æƒ³è¦é€šè¿‡OpenAI APIè®¿é—®GPT</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI</span><br><span class="line"></span><br><span class="line">client = OpenAI(</span><br><span class="line">    base_url=<span class="string">&#x27;https://api.openai-proxy.org/v1&#x27;</span>,</span><br><span class="line">    api_key=<span class="string">&#x27;sk-xxxxxxxx&#x27;</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">chat_completion = client.chat.completions.create(</span><br><span class="line">    messages=[</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>,</span><br><span class="line">            <span class="string">&quot;content&quot;</span>: <span class="string">&quot;Say hi&quot;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    model=<span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><aside>â— æ³¨æ„é…ç½®api_baseæ—¶ï¼Œåº”è¯¥åŠ ä¸Šä¸€ä¸ª/v1çš„åç¼€ï¼Œè€Œä¸æ˜¯åªæœ‰åŸŸåï¼Œè¦ä¸ç„¶ä¼šæŠ¥404é”™è¯¯</aside><p>å¦‚ä½¿ç”¨LangChainï¼Œå¯ä»¥ä½¿ç”¨closeaiæä¾›çš„ä»£ç†è¿›è¡Œè®¿é—®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> OPENAI_API_BASE=https://api.openai-proxy.org/v1</span><br><span class="line"><span class="built_in">export</span> OPENAI_API_KEY=sk-xxxxxxxx</span><br></pre></td></tr></table></figure><aside>â— æ³¨æ„é…ç½®ç¯å¢ƒå˜é‡æ—¶ï¼Œlangchainçš„`OPENAI_API_BASE`åº”è¯¥åŠ ä¸Šä¸€ä¸ª`/v1`çš„åç¼€ï¼Œè€Œä¸æ˜¯åªæœ‰åŸŸåï¼Œè¦ä¸ç„¶ä¼šæŠ¥404é”™è¯¯ã€‚</aside>]]></content>
      
      
      
        <tags>
            
            <tag> LLM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HuggingFace-ä¸‹è½½æ¨¡å‹</title>
      <link href="/2024/01/18/HuggingFace-%E4%B8%8B%E8%BD%BD%E6%A8%A1%E5%9E%8B/"/>
      <url>/2024/01/18/HuggingFace-%E4%B8%8B%E8%BD%BD%E6%A8%A1%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="hugging-faceä¿å­˜æ¨¡å‹">Hugging Faceä¿å­˜æ¨¡å‹</h1><h1 id="cache-setup">Cache setup</h1><p>å¦‚æœæœ¬åœ°å’Œç¼“å­˜ä¸­å‡æ²¡æœ‰æ¨¡å‹çš„è¯ï¼Œé‚£ä¹ˆè¿è¡Œ<code>model.fromPretrained</code>ä¼šä»huggingfaceå®˜ç½‘ä¸­ä¸‹è½½æ¨¡å‹ï¼Œä¿å­˜åˆ°æœ¬åœ°çš„é»˜è®¤è·¯å¾„<code>~/.cache/huggingface/hub</code>.ä¸‹</p><p>å› æ­¤å¯ä»¥ä»<code>~/.cache/huggingface/hub</code>ä¸‹è¿›å…¥åˆ é™¤ä½ ä¸å†éœ€è¦çš„æ¨¡å‹å‚æ•°</p><h1 id="offline-mode">Offline mode</h1><p>å¦‚æœåœ¨æœ‰é˜²ç«å¢™æˆ–è€…ç¦»çº¿çš„æƒ…å†µä¸‹ä½¿ç”¨Huggingfaceåœ¨cache fileä¸­ä¿å­˜çš„æ–‡ä»¶ï¼Œé€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡</p><p><code>TRANSFORMERS_OFFLINE=1</code>.å¦‚æœè¦ä½¿ç”¨æœ¬åœ°çš„æ•°æ®é›†ï¼Œè®¾ç½®<code>HF_DATASETS_OFFLINE=1</code>.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">HF_DATASETS_OFFLINE=1 TRANSFORMERS_OFFLINE=1 \</span><br><span class="line">python examples/pytorch/translation/run_translation.py --model_name_or_path t5-small --dataset_name wmt16 --dataset_config ro-en ...</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°æŒ‡ä»¤å°±ä¸ä¼šå°è¯•ä»huggingfaceåœ¨çº¿çš„åŠ è½½æ¨¡å‹</p><p>åŒæ—¶ä¹Ÿå¯ä»¥é€‰**<a href="https://huggingface.co/docs/transformers/v4.34.0/en/main_classes/model#transformers.PreTrainedModel.from_pretrained">from_pretrained()</a>**åœ¨æ¨¡å‹åŠ è½½çš„æ—¶å€™ä¼ é€’ä¸€ä¸ªå‚æ•°<code>local_files_only</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">from transformers import T5Model</span><br><span class="line"></span><br><span class="line">model = T5Model.from_pretrained(<span class="string">&quot;./path/to/local/directory&quot;</span>, local_files_only=True)</span><br></pre></td></tr></table></figure><h1 id="ç¦»çº¿ä¿å­˜æ¨¡å‹å‚æ•°">ç¦»çº¿ä¿å­˜æ¨¡å‹å‚æ•°</h1><ul><li>ä»**<a href="https://huggingface.co/models">Model Hub</a>ä¸‹è½½**</li><li>ä½¿**<a href="https://huggingface.co/docs/transformers/v4.34.0/en/main_classes/model#transformers.PreTrainedModel.from_pretrained">PreTrainedModel.from_pretrained()</a>**Â å’Œ**<a href="https://huggingface.co/docs/transformers/v4.34.0/en/main_classes/model#transformers.PreTrainedModel.save_pretrained">PreTrainedModel.save_pretrained()</a>ï¼š**</li></ul><p>1.æå‰ä¸‹è½½æ¨¡å‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**from transformers import AutoTokenizer, AutoModelForSeq2SeqLM</span><br><span class="line"></span><br><span class="line">tokenizer = AutoTokenizer.from_pretrained(<span class="string">&quot;bigscience/T0_3B&quot;</span>)</span><br><span class="line">model = AutoModelForSeq2SeqLM.from_pretrained(<span class="string">&quot;bigscience/T0_3B&quot;</span>)**</span><br></pre></td></tr></table></figure><p>2.å°†æ¨¡å‹ä¿å­˜åˆ°æŒ‡å®šçš„æ–‡ä»¶å¤¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tokenizer.save_pretrained(<span class="string">&quot;./your/path/bigscience_t0&quot;</span>)</span><br><span class="line">model.save_pretrained(<span class="string">&quot;./your/path/bigscience_t0&quot;</span>)</span><br></pre></td></tr></table></figure><p>3.ä¹‹åå°±å¯ä»¥ä»æœ¬åœ°æ–‡ä»¶å¤¹ä¸­æå–æ¨¡å‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tokenizer = AutoTokenizer.from_pretrained(<span class="string">&quot;./your/path/bigscience_t0&quot;</span>)</span><br><span class="line">model = AutoModel.from_pretrained(<span class="string">&quot;./your/path/bigscience_t0&quot;</span>)</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨**<a href="https://github.com/huggingface/huggingface_hub/tree/main/src/huggingface_hub">huggingface_hub</a>**</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m pip install huggingface_hub</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">from huggingface_hub import hf_hub_download</span><br><span class="line"></span><br><span class="line">hf_hub_download(repo_id=<span class="string">&quot;bigscience/T0_3B&quot;</span>, filename=<span class="string">&quot;config.json&quot;</span>, cache_dir=<span class="string">&quot;./your/path/bigscience_t0&quot;</span>)</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šä»£ç å°±æ˜¯ä»T0æ¨¡å‹ä¸­ä¸‹è½½äº†config.jsonæ–‡ä»¶åˆ°äº†æŒ‡å®šæ–‡ä»¶å¤¹</p><h1 id="ä½¿ç”¨é•œåƒç½‘ç«™">ä½¿ç”¨é•œåƒç½‘ç«™</h1><p>æœ¬ç«™åŸŸå <a href="http://hf-mirror.com">hf-mirror.com</a>ï¼Œç”¨äºé•œåƒ <a href="http://huggingface.co">huggingface.co</a> åŸŸåã€‚</p><p>æ›´å¤šç”¨æ³•ï¼ˆå¤šçº¿ç¨‹åŠ é€Ÿç­‰ï¼‰è¯¦è§è¿™ç¯‡æ–‡ç« ã€‚ç®€ä»‹ï¼š</p><p>æ–¹æ³•ä¸€ï¼šä½¿ç”¨huggingface å®˜æ–¹æä¾›çš„ huggingface-cli å‘½ä»¤è¡Œå·¥å…·ã€‚</p><p>(1) å®‰è£…ä¾èµ–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python pip install -U huggingface_hub</span><br></pre></td></tr></table></figure><p>(2) åŸºæœ¬å‘½ä»¤ç¤ºä¾‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> HF_ENDPOINT=https://hf-mirror.com</span><br><span class="line">huggingface-cli download --resume-download --local-dir-use-symlinks False bigscience/bloom-560m --local-dir bloom-560m</span><br></pre></td></tr></table></figure><p>(3) ä¸‹è½½éœ€è¦ç™»å½•çš„æ¨¡å‹ï¼ˆGated Modelï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¯·æ·»åŠ --token hf_***å‚æ•°ï¼Œå…¶ä¸­hf_***æ˜¯ access tokenï¼Œè¯·åœ¨huggingfaceå®˜ç½‘è¿™é‡Œè·å–ã€‚ç¤ºä¾‹ï¼š</span><br><span class="line">huggingface-cli download --token hf_*** --resume-download --local-dir-use-symlinks False meta-llama/Llama-2-7b-hf --local-dir Llama-2-7b-hf</span><br></pre></td></tr></table></figure><p>æ–¹æ³•äºŒï¼šä½¿ç”¨urlç›´æ¥ä¸‹è½½æ—¶ï¼Œå°† <a href="http://huggingface.co">huggingface.co</a> <a href="http://xn--hf-mirror-fp6nr62ckzktv1b10az18awua995s5wo.com">ç›´æ¥æ›¿æ¢ä¸ºæœ¬ç«™åŸŸåhf-mirror.com</a>ã€‚ä½¿ç”¨æµè§ˆå™¨æˆ–è€… wget -cã€curl -Lã€aria2c ç­‰å‘½ä»¤è¡Œæ–¹å¼å³å¯ã€‚<br>ä¸‹è½½éœ€ç™»å½•çš„æ¨¡å‹éœ€å‘½ä»¤è¡Œæ·»åŠ  --header hf_*** å‚æ•°ï¼Œtoken è·å–å…·ä½“å‚è§ä¸Šæ–‡ã€‚<br>æ–¹æ³•ä¸‰ï¼š(éä¾µå…¥å¼ï¼Œèƒ½è§£å†³å¤§éƒ¨åˆ†æƒ…å†µ)huggingface æä¾›çš„åŒ…ä¼šè·å–ç³»ç»Ÿå˜é‡ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨é€šè¿‡è®¾ç½®å˜é‡æ¥è§£å†³ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HF_ENDPOINT=https://hf-mirror.com python your_script.py</span><br></pre></td></tr></table></figure><p>ä¸è¿‡æœ‰äº›æ•°æ®é›†æœ‰å†…ç½®çš„ä¸‹è½½è„šæœ¬ï¼Œé‚£å°±éœ€è¦æ‰‹åŠ¨æ”¹ä¸€ä¸‹è„šæœ¬å†…çš„åœ°å€æ¥å®ç°äº†</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
          <category> HuggingFace </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬”è®° </tag>
            
            <tag> HuggingFace </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VoxPoser</title>
      <link href="/2023/11/23/VoxPoser/"/>
      <url>/2023/11/23/VoxPoser/</url>
      
        <content type="html"><![CDATA[<p>VoxPoserï¼šä½¿ç”¨è¯­è¨€æ¨¡å‹çš„å¯ç»„åˆä¸‰ç»´ä»·å€¼åœ°å›¾è¿›è¡Œæœºå™¨äººæ“çºµ</p><p>authorï¼š<em>Wenlong Huang, Chen Wang, Ruohan Zhang, Yunzhu Li , Jiajun Wu, Li Fei-Fei</em></p><h1 id="abstract">Abstract</h1><p>å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰æ˜¾ç¤ºå‡ºå…·æœ‰å¯æ“ä½œçŸ¥è¯†çš„ä¸°å¯Œæ€§ï¼Œå¯ä»¥é€šè¿‡æ¨ç†å’Œè§„åˆ’çš„å½¢å¼æå–ç”¨äºæœºå™¨äººæ“çºµçš„çŸ¥è¯†ã€‚å°½ç®¡å–å¾—äº†è¿›å±•ï¼Œä½†å¤§å¤šæ•°ä»ç„¶<em>ä¾èµ–é¢„å®šä¹‰çš„è¿åŠ¨åŸè¯­æ¥è¿›è¡Œä¸ç¯å¢ƒçš„ç‰©ç†äº¤äº’</em>ï¼Œè¿™ä»ç„¶æ˜¯ä¸€ä¸ªä¸»è¦ç“¶é¢ˆã€‚åœ¨è¿™é¡¹å·¥ä½œä¸­ï¼Œæˆ‘ä»¬æ—¨åœ¨åˆæˆæœºå™¨äººè½¨è¿¹ï¼Œå³ä¸€ç³»åˆ—å¯†é›†çš„6è‡ªç”±åº¦æœ«ç«¯æ‰§è¡Œå™¨è·¯å¾„ç‚¹ï¼Œç”¨äºå„ç§æ“çºµä»»åŠ¡ï¼Œå¹¶ç»™å®šå¼€æ”¾å¼æŒ‡ä»¤å’Œå¼€æ”¾å¼å¯¹è±¡ã€‚æˆ‘ä»¬é¦–å…ˆè§‚å¯Ÿåˆ°LLMsåœ¨æ ¹æ®è‡ªç”±å½¢å¼è¯­è¨€æŒ‡ä»¤æ¨æ–­èƒ½åŠ›å’Œçº¦æŸæ–¹é¢è¡¨ç°å‡ºè‰²ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œé€šè¿‡åˆ©ç”¨å®ƒä»¬ç¼–å†™ä»£ç çš„èƒ½åŠ›ï¼Œå®ƒä»¬å¯ä»¥ä¸è§†è§‰-è¯­è¨€æ¨¡å‹ï¼ˆVLMï¼‰äº¤äº’ä»¥ç»„åˆ3Dä»·å€¼åœ°å›¾å°†çŸ¥è¯†è½å®åˆ°ä»£ç†è€…æ‰€è§‚æµ‹åˆ°ç©ºé—´ä¸­ã€‚ç„¶åï¼Œåœ¨åŸºäºæ¨¡å‹çš„è§„åˆ’æ¡†æ¶ä¸­ä½¿ç”¨ç»„åˆåçš„ä»·å€¼åœ°å›¾æ¥é›¶æ ·æœ¬ç»¼åˆé—­ç¯æœºå™¨äººè½¨è¿¹ï¼Œå¹¶å¯¹åŠ¨æ€æ‰°åŠ¨å…·æœ‰é²æ£’æ€§ã€‚æˆ‘ä»¬è¿›ä¸€æ­¥æ¼”ç¤ºäº†æ‰€æå‡ºæ¡†æ¶å¦‚ä½•ä»åœ¨çº¿ç»éªŒä¸­å—ç›Šï¼Œå¹¶æœ‰æ•ˆå­¦ä¹ æ¶‰åŠæ¥è§¦ä¸°å¯Œäº¤äº’åœºæ™¯ä¸‹çš„åŠ¨åŠ›å­¦æ¨¡å‹ã€‚æˆ‘ä»¬åœ¨æ¨¡æ‹Ÿå’ŒçœŸå®æœºå™¨äººç¯å¢ƒä¸­å¯¹æ‰€æå‡ºæ–¹æ³•è¿›è¡Œäº†å¤§è§„æ¨¡ç ”ç©¶ï¼Œå±•ç¤ºäº†èƒ½å¤Ÿæ‰§è¡Œå„ç§ä»¥è‡ªç”±å½¢å¼è‡ªç„¶è¯­è¨€æŒ‡å®šçš„æ—¥å¸¸æ“çºµä»»åŠ¡çš„èƒ½åŠ›ã€‚<a href="https://voxposer.github.io">è§†é¢‘å’Œä»£ç è¯·è®¿é—®voxposer.github.ioã€‚</a></p><p><strong>å…³é”®è¯ï¼šæ“çºµï¼Œå¤§å‹è¯­è¨€æ¨¡å‹ï¼ŒåŸºäºæ¨¡å‹çš„è§„åˆ’</strong></p><p><img src="https://picture.fanfer.top/img/VoxPoser1.png" alt="æˆªå±2023-11-08 16.45.06.png"></p><h1 id="instruction"><strong>Instruction</strong></h1><p>è¯­è¨€æ˜¯äººç±»ç”¨æ¥æç‚¼å’Œä¼ è¾¾å¯¹ä¸–ç•Œçš„çŸ¥è¯†å’Œç»éªŒçš„ä¸€ç§å‹ç¼©åª’ä»‹ã€‚å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰å·²ç»æˆä¸ºæ•æ‰è¿™ç§æŠ½è±¡ã€é€šè¿‡è¯­è¨€ç©ºé—´æŠ•å½±æ¥ä»£è¡¨ä¸–ç•Œçš„ä¸€ç§æœ‰å‰é€”çš„æ–¹æ³•ã€‚å°½ç®¡è¿™äº›æ¨¡å‹è¢«è®¤ä¸ºèƒ½å¤Ÿä»¥æ–‡æœ¬å½¢å¼å†…åŒ–å¯æ¦‚æ‹¬çš„çŸ¥è¯†ï¼Œä½†å¦‚ä½•åˆ©ç”¨å®ƒä»¬æ¥ä½¿å…·ä½“agentï¼ˆå¦‚æœºå™¨äººï¼‰åœ¨ç°å®ä¸–ç•Œä¸­å®é™…è¡ŒåŠ¨ä»æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚</p><p>æˆ‘ä»¬ç ”ç©¶çš„é—®é¢˜æ˜¯å¦‚ä½•å°†æŠ½è±¡çš„è¯­è¨€æŒ‡ä»¤ï¼ˆä¾‹å¦‚â€œå¸ƒç½®æ¡Œå­â€ï¼‰è½¬åŒ–ä¸ºæœºå™¨äººåŠ¨ä½œã€‚ä»¥å¾€çš„å·¥ä½œåˆ©ç”¨è¯æ±‡åˆ†ææ¥è§£ææŒ‡ä»¤ï¼Œè€Œæœ€è¿‘åˆ™ä½¿ç”¨è¯­è¨€æ¨¡å‹å°†æŒ‡ä»¤åˆ†è§£ä¸ºä¸€ç³»åˆ—æ–‡æœ¬æ­¥éª¤ã€‚ç„¶è€Œï¼Œä¸ºäº†ä½¿æœºå™¨äººä¸ç¯å¢ƒè¿›è¡Œç‰©ç†äº’åŠ¨ï¼Œç°æœ‰æ–¹æ³•é€šå¸¸ä¾èµ–äºä¸€ç³»åˆ—é¢„å®šä¹‰çš„åŠ¨ä½œåŸè¯­ï¼ˆå³æŠ€èƒ½ï¼‰ï¼Œè¿™äº›åŸè¯­å¯èƒ½ç”±LLMæˆ–è§„åˆ’å™¨è°ƒç”¨ï¼Œè€Œä¾èµ–äºå•ç‹¬æŠ€èƒ½è·å–é€šå¸¸è¢«è®¤ä¸ºæ˜¯ç³»ç»Ÿçš„ä¸€ä¸ªä¸»è¦ç“¶é¢ˆï¼Œå› ä¸ºç¼ºä¹å¤§è§„æ¨¡çš„æœºå™¨äººæ•°æ®ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼šæˆ‘ä»¬å¦‚ä½•åˆ©ç”¨LLMå†…åŒ–çš„çŸ¥è¯†ï¼Œç”šè‡³åœ¨ç»†ç²’åº¦çš„åŠ¨ä½œå±‚é¢ï¼Œä¸ºæœºå™¨äººæä¾›å¸®åŠ©ï¼Œè€Œæ— éœ€è¿›è¡Œç¹ççš„æ•°æ®æ”¶é›†æˆ–ä¸ºæ¯ä¸ªå•ç‹¬çš„åŸè¯­æ‰‹åŠ¨è®¾è®¡ï¼Ÿ</p><p>åœ¨è§£å†³è¿™ä¸ªæŒ‘æˆ˜æ—¶ï¼Œæˆ‘ä»¬é¦–å…ˆæ³¨æ„åˆ°LLMç›´æ¥ä»¥æ–‡æœ¬è¾“å‡ºæ§åˆ¶åŠ¨ä½œæ˜¯ä¸åˆ‡å®é™…çš„ï¼Œå› ä¸ºè¿™äº›æ§åˆ¶åŠ¨ä½œé€šå¸¸ç”±é«˜é¢‘æ§åˆ¶ä¿¡å·åœ¨é«˜ç»´ç©ºé—´ä¸­é©±åŠ¨ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å‘ç°LLMæ“…é•¿æ¨æ–­è¯­è¨€æ¡ä»¶ä¸‹çš„å¯ç”¨æ€§å’Œé™åˆ¶ï¼Œå¹¶ä¸”é€šè¿‡åˆ©ç”¨å®ƒä»¬çš„ç¼–å†™ä»£ç èƒ½åŠ›ï¼Œå®ƒä»¬å¯ä»¥ç»„æˆå¯†é›†çš„3Dä½“ç´ åœ°å›¾ï¼Œå°†è¿™äº›çŸ¥è¯†æ¤å…¥è§†è§‰ç©ºé—´ï¼Œé€šè¿‡åè°ƒæ„ŸçŸ¥è°ƒç”¨ï¼ˆä¾‹å¦‚é€šè¿‡CLIPæˆ–å¼€æ”¾è¯æ±‡æ£€æµ‹å™¨ï¼‰å’Œæ•°ç»„æ“ä½œï¼ˆä¾‹å¦‚é€šè¿‡NumPyï¼‰ã€‚</p><p>ä¾‹å¦‚ï¼Œç»™å®šä¸€ä¸ªæŒ‡ä»¤â€œæ‰“å¼€é¡¶éƒ¨æŠ½å±‰å¹¶æ³¨æ„èŠ±ç“¶â€ï¼ŒLLMå¯ä»¥è¢«æç¤ºæ¨æ–­ï¼š</p><p>1ï¼‰åº”è¯¥æŠ“ä½é¡¶éƒ¨æŠ½å±‰çš„æŠŠæ‰‹ï¼›</p><p>2ï¼‰æŠŠæ‰‹éœ€è¦å‘å¤–å¹³ç§»ï¼›</p><p>3ï¼‰æœºå™¨äººåº”è¯¥è¿œç¦»èŠ±ç“¶ã€‚</p><p>é€šè¿‡ç”ŸæˆPythonä»£ç è°ƒç”¨æ„ŸçŸ¥APIï¼ŒLLMå¯ä»¥è·å¾—ç›¸å…³å¯¹è±¡æˆ–éƒ¨ä»¶çš„ç©ºé—´-å‡ ä½•ä¿¡æ¯ï¼Œç„¶åæ“çºµ3Dä½“ç´ ï¼Œåœ¨è§‚å¯Ÿç©ºé—´ä¸­çš„ç›¸å…³ä½ç½®è§„å®šå¥–åŠ±æˆ–æˆæœ¬ï¼ˆä¾‹å¦‚ï¼ŒæŠŠæ‰‹åŒºåŸŸè¢«èµ‹äºˆé«˜å€¼ï¼Œè€ŒèŠ±ç“¶å‘¨å›´è¢«èµ‹äºˆä½å€¼ï¼‰ã€‚æœ€åï¼Œç»„æˆçš„ä»·å€¼åœ°å›¾å¯ä»¥ä½œä¸ºè¿åŠ¨è§„åˆ’å™¨çš„ç›®æ ‡å‡½æ•°ï¼Œç›´æ¥åˆæˆå®ç°ç»™å®šæŒ‡ä»¤çš„æœºå™¨äººè½¨è¿¹ï¼Œæ— éœ€ä¸ºæ¯ä¸ªä»»åŠ¡æˆ–LLMæä¾›é¢å¤–çš„è®­ç»ƒæ•°æ®ã€‚å›¾1ä¸­å±•ç¤ºäº†ä¸€ä¸ªç¤ºæ„å›¾å’Œæˆ‘ä»¬è€ƒè™‘çš„ä¸€äº›ä»»åŠ¡ã€‚</p><p>æˆ‘ä»¬å°†è¿™ç§æ–¹æ³•ç§°ä¸ºVOXPOSERï¼Œå®ƒä»LLMsä¸­æå–å¯ä¾›æ€§å’Œçº¦æŸï¼Œä»¥åœ¨è§‚å¯Ÿç©ºé—´ä¸­ç»„åˆ3Dä»·å€¼åœ°å›¾ï¼Œç”¨äºæŒ‡å¯¼æœºå™¨äººçš„äº¤äº’ã€‚ä¸é€šå¸¸ä¾èµ–æ•°é‡æœ‰é™æˆ–å˜åŒ–æœ‰é™çš„æœºå™¨äººæ•°æ®ä¸åŒï¼Œè¯¥æ–¹æ³•åˆ©ç”¨LLMsè¿›è¡Œå¼€æ”¾ä¸–ç•Œæ¨ç†ï¼Œå¹¶åˆ©ç”¨VLMsè¿›è¡Œå¯æ³›åŒ–çš„è§†è§‰åŸºç¡€å®šä½ï¼Œåœ¨åŸºäºæ¨¡å‹çš„è§„åˆ’æ¡†æ¶ä¸­ç›´æ¥å®ç°ç‰©ç†æœºå™¨äººåŠ¨ä½œã€‚æˆ‘ä»¬å±•ç¤ºäº†å…¶å¯¹å„ç§æ—¥å¸¸æ“ä½œä»»åŠ¡å…·æœ‰é›¶æ ·æœ¬æ³›åŒ–èƒ½åŠ›ï¼ŒåŒ…æ‹¬ä½¿ç”¨å¼€æ”¾é›†å¯¹è±¡çš„å¼€æ”¾é›†æŒ‡ä»¤ã€‚æˆ‘ä»¬è¿›ä¸€æ­¥å±•ç¤ºäº†VoxPoserå¦‚ä½•é€šè¿‡æœ‰é™åœ¨çº¿äº¤äº’æ¥é«˜æ•ˆå­¦ä¹ æ¶‰åŠæ¥è§¦ä¸°å¯Œäº¤äº’çš„åŠ¨åŠ›å­¦æ¨¡å‹ã€‚</p><h1 id="method"><strong><strong><strong><strong><strong><strong><strong><strong>Method</strong></strong></strong></strong></strong></strong></strong></strong></h1><p>3.1é¦–å…ˆæä¾›äº†VoxPoserçš„ä¼˜åŒ–é—®é¢˜è¡¨è¿°</p><p>3.2ç„¶åæˆ‘ä»¬æè¿°äº†å¦‚ä½•å°†VoxPoserç”¨ä½œé€šç”¨çš„é›¶æ ·æœ¬æ¡†æ¶ï¼Œå°†è¯­è¨€æŒ‡ä»¤æ˜ å°„åˆ°3D value map</p><p>3.3æˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•é—­ç¯åˆæˆæœºå™¨äººæ“ä½œçš„è½¨è¿¹</p><p>3.4è™½ç„¶æ˜¯é›¶æ ·æœ¬å­¦ä¹ ï¼Œä½†æˆ‘ä»¬å±•ç¤ºäº†VoxPoserå¦‚ä½•ä»åœ¨çº¿äº¤äº’ä¸­å­¦ä¹ ä»¥é«˜æ•ˆè§£å†³å¯Œæœ‰æ¥è§¦æ€§è´¨çš„ä»»åŠ¡ã€‚</p><p><strong>3.2 ç”Ÿæˆ3D Map</strong></p><p><img src="https://picture.fanfer.top/img/VoxPoser2.png" alt="æˆªå±2023-11-23 16.46.11.png"></p><p>æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå…³é”®è§‚å¯Ÿç»“æœï¼Œå³å¤§é‡ä»»åŠ¡å¯ä»¥é€šè¿‡æœºå™¨äººè§‚æµ‹ç©ºé—´ä¸­çš„ä½“ç´ å€¼å›¾V âˆˆ RwÃ—hÃ—dæ¥æè¿°ï¼Œè¯¥å›¾å¼•å¯¼åœºæ™¯ä¸­â€œæ„Ÿå…´è¶£å®ä½“â€çš„è¿åŠ¨ï¼Œä¾‹å¦‚æœºå™¨äººæœ«ç«¯æ‰§è¡Œå™¨ã€ç‰©ä½“æˆ–ç‰©ä½“éƒ¨åˆ†ã€‚</p><p>ä¾‹å¦‚ï¼Œè€ƒè™‘ä»»åŠ¡â€œæ‰“å¼€é¡¶å±‚æŠ½å±‰â€åŠå…¶ç¬¬ä¸€ä¸ªå­ä»»åŠ¡â€œæŠ“ä½é¡¶éƒ¨æŠ½å±‰æ‰‹æŸ„â€ï¼ˆç”±LLMsæ¨æ–­ï¼‰åœ¨å›¾2ä¸­ã€‚ â€œæ„Ÿå…´è¶£çš„å®ä½“â€æ˜¯æœºå™¨äººæœ«ç«¯æ‰§è¡Œå™¨ï¼Œå¹¶ä¸”ä½“ç´ å€¼æ˜ å°„åº”åæ˜ å¯¹æŠ½å±‰æ‰‹æŸ„çš„å¸å¼•åŠ›ã€‚é€šè¿‡è¿›ä¸€æ­¥å‘½ä»¤â€œå°å¿ƒèŠ±ç“¶â€ï¼Œåœ°å›¾ä¹Ÿå¯ä»¥æ›´æ–°ä»¥åæ˜ å¯¹èŠ±ç“¶çš„æ’æ–¥åŠ›ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°å¤§å‹è¯­è¨€æ¨¡å‹é€šè¿‡åœ¨äº’è”ç½‘è§„æ¨¡çš„æ•°æ®ä¸Šè¿›è¡Œé¢„è®­ç»ƒï¼Œä¸ä»…èƒ½å¤Ÿè¯†åˆ«â€œæ„Ÿå…´è¶£çš„å®ä½“â€ï¼Œè¿˜èƒ½å¤Ÿç¼–å†™Pythonç¨‹åºæ¥å‡†ç¡®åæ˜ ä»»åŠ¡æŒ‡ä»¤ã€‚å…·ä½“è€Œè¨€ï¼Œåœ¨ä»£ç ä¸­ç»™å‡ºæŒ‡ä»¤ä½œä¸ºæ³¨é‡Šæ—¶ï¼Œå¯ä»¥æç¤ºLLMsæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š1ï¼‰è°ƒç”¨æ„ŸçŸ¥APIï¼ˆè°ƒç”¨è§†è§‰è¯­è¨€æ¨¡å‹ï¼ˆVLMï¼‰ï¼Œå¦‚å¼€æ”¾è¯æ±‡æ£€æµ‹å™¨[13-15]ï¼‰è·å–ç›¸å…³å¯¹è±¡çš„ç©ºé—´å‡ ä½•ä¿¡æ¯ï¼›2ï¼‰ç”ŸæˆNumPyæ“ä½œä»¥æ“çºµ3Dæ•°ç»„ï¼›3ï¼‰åœ¨ç›¸å…³ä½ç½®å¤„æŒ‡å®šç²¾ç¡®å€¼ã€‚æˆ‘ä»¬å°†è¿™ç§æ–¹æ³•ç§°ä¸ºVOXPOSERã€‚å…·ä½“è€Œè¨€ï¼Œæˆ‘ä»¬æ—¨åœ¨é€šè¿‡æç¤ºLLMå¹¶é€šè¿‡Pythonè§£é‡Šå™¨æ‰§è¡Œä»£ç æ¥è·å¾—ä¸€ä¸ªä½“ç´ å€¼å›¾Vti = VoxPoser(ot, â„“i)ï¼Œå…¶ä¸­otæ˜¯æ—¶é—´tå¤„çš„RGB-Dè§‚å¯Ÿç»“æœï¼Œâ„“iæ˜¯å½“å‰æŒ‡ä»¤ã€‚æ­¤å¤–ï¼Œç”±äºVé€šå¸¸æ˜¯ç¨€ç–çš„ï¼Œæˆ‘ä»¬é€šè¿‡å¹³æ»‘æ“ä½œä½¿ä½“ç´ å›¾å˜å¾—å¯†é›†åŒ–ï¼Œå› ä¸ºå®ƒä»¬é¼“åŠ±è¿åŠ¨è§„åˆ’è€…ä¼˜åŒ–æ›´å¹³æ»‘çš„è½¨è¿¹ã€‚</p><p>é™„åŠ è½¨è¿¹å‚æ•°åŒ–ã€‚ä¸Šè¿°çš„VoxPoserå…¬å¼ä½¿ç”¨LLMsæ¥ç»„åˆVï¼šN3 â†’ Rï¼Œå°†ç¦»æ•£åæ ‡æ˜ å°„åˆ°å®å€¼â€œæˆæœ¬â€ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥ä¼˜åŒ–ä»…ç”±ä½ç½®é¡¹ç»„æˆçš„è·¯å¾„ã€‚ä¸ºäº†æ‰©å±•åˆ°SE(3)å§¿æ€ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨LLMsåœ¨ä¸ä»»åŠ¡ç›®æ ‡ç›¸å…³çš„åæ ‡å¤„ç»„åˆæ—‹è½¬å›¾åƒVrï¼šN3 â†’ SO(3)ï¼ˆä¾‹å¦‚ï¼Œâ€œæœ«ç«¯æ‰§è¡Œå™¨åº”è¯¥é¢å‘æ‰‹æŸ„æ”¯æ’‘æ³•çº¿â€ï¼‰ã€‚åŒæ ·åœ°ï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥ç»„åˆå¤¹çˆªå›¾åƒVgï¼šN3 â†’ {0, 1}ä»¥æ§åˆ¶å¤¹çˆªå¼€é—­å’Œé€Ÿåº¦å›¾åƒVvï¼šN3 â†’ Rä»¥æŒ‡å®šç›®æ ‡é€Ÿåº¦ã€‚è¯·æ³¨æ„ï¼Œè™½ç„¶è¿™äº›é™„åŠ çš„è½¨è¿¹å‚æ•°åŒ–æ²¡æœ‰æ˜ å°„åˆ°å®å€¼â€œæˆæœ¬â€ï¼Œä½†å®ƒä»¬ä¹Ÿå¯ä»¥åœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­è¿›è¡Œå› å­åˆ†è§£ï¼ˆæ–¹ç¨‹1ï¼‰ä»¥å¯¹è½¨è¿¹è¿›è¡Œå‚æ•°åŒ–ã€‚</p><p><strong>LLMså’Œæç¤ºã€‚</strong></p><p>æˆ‘ä»¬éµå¾ªLiangç­‰äººçš„æç¤ºç»“æ„[75]ï¼Œè¯¥ç»“æ„é€šè¿‡é€’å½’è°ƒç”¨å…¶è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç æ¥è°ƒç”¨LLMsï¼Œå…¶ä¸­æ¯ä¸ªè¯­è¨€æ¨¡å‹ç¨‹åºï¼ˆLMPï¼‰è´Ÿè´£å”¯ä¸€çš„åŠŸèƒ½ï¼ˆä¾‹å¦‚å¤„ç†æ„ŸçŸ¥å‘¼å«ï¼‰ã€‚æˆ‘ä»¬ä½¿ç”¨OpenAI APIä¸­çš„GPT-4 [2]ã€‚å¯¹äºæ¯ä¸ªLMPï¼Œæˆ‘ä»¬å°†5-20ä¸ªç¤ºä¾‹æŸ¥è¯¢å’Œç›¸åº”çš„å“åº”ä½œä¸ºæç¤ºçš„ä¸€éƒ¨åˆ†åŒ…å«åœ¨å†…ã€‚å›¾2ä¸­å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªç¤ºä¾‹ï¼ˆä¸ºäº†æ¸…æ™°èµ·è§è¿›è¡Œäº†ç®€åŒ–ï¼‰ã€‚å®Œæ•´çš„æç¤ºè¯·å‚è§é™„å½•ã€‚</p><p><em><strong>è¡¥å……</strong></em></p><p><em>J. Liang, W. Huang, F. Xia, P. Xu, K. Hausman, B. Ichter, P. Florence, and A. Zeng. Code as<br>policies: Language model programs for embodied control. arXiv preprint arXiv:2209.07753,<br>2022.</em></p><p><img src="https://picture.fanfer.top/img/VoxPoser3.png" alt="æˆªå±2023-11-23 16.58.14.png"></p><p>ç¼–å†™ä»£ç çš„LLMså¯ä»¥é‡æ–°ç”¨äºç¼–å†™æœºå™¨äººç­–ç•¥ä»£ç ï¼Œç»™å®šè‡ªç„¶è¯­è¨€å‘½ä»¤ã€‚å…·ä½“è€Œè¨€ï¼Œç­–ç•¥ä»£ç å¯ä»¥è¡¨è¾¾å¤„ç†æ„ŸçŸ¥è¾“å‡ºï¼ˆä¾‹å¦‚æ¥è‡ªç‰©ä½“æ£€æµ‹å™¨[2]ã€[3]ï¼‰å’Œå‚æ•°åŒ–æ§åˆ¶åŸå§‹APIçš„å‡½æ•°æˆ–åé¦ˆå¾ªç¯ã€‚å½“ä»¥å‡ ä¸ªç¤ºä¾‹è¯­è¨€å‘½ä»¤ï¼ˆæ ¼å¼ä¸ºæ³¨é‡Šï¼‰ä½œä¸ºè¾“å…¥ï¼Œå¹¶é€šè¿‡å°‘é‡æç¤ºæä¾›ç›¸åº”çš„ç­–ç•¥ä»£ç æ—¶ï¼ŒLLMså¯ä»¥æ¥å—æ–°å‘½ä»¤å¹¶è‡ªä¸»åœ°é‡æ–°ç»„åˆAPIè°ƒç”¨ä»¥ç”Ÿæˆæ–°çš„ç­–ç•¥ä»£ç ã€‚é€šè¿‡é“¾æ¥ç»å…¸é€»è¾‘ç»“æ„å’Œå¼•ç”¨ç¬¬ä¸‰æ–¹åº“ï¼ˆä¾‹å¦‚NumPyã€Shapelyï¼‰è¿›è¡Œç®—æœ¯è¿ç®—ï¼Œåœ¨æ­¤æ–¹å¼ä¸‹ä½¿ç”¨çš„LLMså¯ä»¥ç¼–å†™æœºå™¨äººç­–ç•¥ï¼šå±•ç¤ºç©ºé—´å‡ ä½•æ¨ç†ã€æ³›åŒ–åˆ°æ–°æŒ‡ä»¤ï¼Œå¹¶æ ¹æ®ä¸Šä¸‹æ–‡ï¼ˆå³è¡Œä¸ºå¸¸è¯†ï¼‰å¯¹æ¨¡ç³Šæè¿°(â€œæ›´å¿«â€)æä¾›ç²¾ç¡®å€¼ï¼ˆä¾‹å¦‚é€Ÿåº¦ï¼‰ã€‚</p><p><strong>VLMså’Œæ„ŸçŸ¥ã€‚</strong></p><p>ç»™å®šLLMsçš„å¯¹è±¡/éƒ¨åˆ†æŸ¥è¯¢ï¼Œæˆ‘ä»¬é¦–å…ˆè°ƒç”¨å¼€æ”¾è¯æ±‡æ£€æµ‹å™¨OWL-ViT [15]æ¥è·å–ä¸€ä¸ªè¾¹ç•Œæ¡†ï¼Œç„¶åå°†å…¶è¾“å…¥Segment Anything [118]ä»¥è·å–ä¸€ä¸ªæ©ç ï¼Œå¹¶æœ€ç»ˆä½¿ç”¨è§†é¢‘è·Ÿè¸ªå™¨XMEM [119]è·Ÿè¸ªè¯¥æ©ç ã€‚ä½¿ç”¨RGB-Dè§‚å¯Ÿé‡å»ºå¯¹è±¡/éƒ¨åˆ†ç‚¹äº‘ã€‚</p><p><strong>ä»·å€¼åœ°å›¾ç»„åˆã€‚</strong></p><p>æˆ‘ä»¬å®šä¹‰ä»¥ä¸‹ç±»å‹çš„ä»·å€¼åœ°å›¾ï¼šå¯è¡Œæ€§ã€é¿å…ã€æœ«ç«¯æ‰§è¡Œå™¨é€Ÿåº¦ã€æœ«ç«¯æ‰§è¡Œå™¨æ—‹è½¬å’Œå¤¹çˆªåŠ¨ä½œã€‚æ¯ç§ç±»å‹ä½¿ç”¨ä¸åŒçš„LMPï¼Œå®ƒæ¥æ”¶æŒ‡ä»¤å¹¶è¾“å‡ºå½¢çŠ¶ä¸ºï¼ˆ100, 100, 100, kï¼‰çš„ä½“ç´ åœ°å›¾ï¼Œå…¶ä¸­kå¯¹äºæ¯ä¸ªä»·å€¼åœ°å›¾éƒ½ä¸åŒï¼ˆä¾‹å¦‚ï¼Œå¯¹äºå¯è¡Œæ€§å’Œé¿å…æ¥è¯´k = 1è¡¨ç¤ºæˆæœ¬ï¼Œè€Œå¯¹äºæ—‹è½¬æ¥è¯´k = 4è¡¨ç¤ºSO(3)ï¼‰ã€‚æˆ‘ä»¬å°†æ¬§å‡ é‡Œå¾—è·ç¦»å˜æ¢åº”ç”¨äºå¯è¡Œæ€§åœ°å›¾ï¼Œå¹¶å¯¹é¿å…åœ°å›¾åº”ç”¨é«˜æ–¯æ»¤æ³¢å™¨ã€‚åœ¨ä»·å€¼åœ°å›¾LMPä¹‹ä¸Šï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªé«˜çº§LMPæ¥åè°ƒå®ƒä»¬çš„è¡Œä¸ºï¼šè§„åˆ’è€…ä»¥ç”¨æˆ·æŒ‡ä»¤Lä½œä¸ºè¾“å…¥ï¼ˆä¾‹å¦‚ï¼Œâ€œæ‰“å¼€æŠ½å±‰â€ï¼‰ï¼Œå¹¶è¾“å‡ºä¸€ç³»åˆ—å­ä»»åŠ¡â„“1:Nï¼›ç»„åˆè€…æ¥æ”¶å­ä»»åŠ¡â„“iå¹¶ä½¿ç”¨è¯¦ç»†è¯­è¨€å‚æ•°åŒ–è°ƒç”¨ç›¸å…³çš„ä»·å€¼åœ°å›¾LMPsã€‚</p><h1 id="related-works"><strong>Related Works</strong></h1><p>ç«¯åˆ°ç«¯æˆæœ¬é¢„æµ‹å™¨é€šè¿‡ç›‘ç£å­¦ä¹ ä¼˜åŒ–ä»¥å°†è‡ªç„¶è¯­è¨€æŒ‡ä»¤æ˜ å°„åˆ°2Dæˆæœ¬åœ°å›¾ä¸Šï¼Œåœ¨ç¢°æ’è‡ªç”±æ–¹å¼ä¸‹å¼•å¯¼è¿åŠ¨è§„åˆ’ç”Ÿæˆé¦–é€‰è½¨è¿¹ã€‚</p><p><em>P. Sharma, B. Sundaralingam, V. Blukis, C. Paxton, T. Hermans, A. Torralba, J. Andreas,</em><br><em>and D. Fox. Correcting robot plans with natural language feedback. arXiv preprint</em><br><em>arXiv:2204.05186, 2022.</em></p><p>ä¸ºäº†ä½¿è¯­è¨€æ¨¡å‹èƒ½å¤Ÿæ„ŸçŸ¥ç‰©ç†ç¯å¢ƒï¼Œå¯ä»¥æä¾›åœºæ™¯çš„æ–‡æœ¬æè¿°[39ã€11ã€59]æˆ–æ„ŸçŸ¥API [75]</p><p><em>W. Huang, F. Xia, T. Xiao, H. Chan, J. Liang, P. Florence, A. Zeng, J. Tompson, I. Mordatch,</em><br><em>Y. Chebotar, P. Sermanet, N. Brown, T. Jackson, L. Luu, S. Levine, K. Hausman, and</em><br><em>B. Ichter. Inner monologue: Embodied reasoning through planning with language models. In</em><br><em>arXiv preprint arXiv:2207.05608, 2022</em></p><p>éœ€è¦åˆ©ç”¨è§†è§‰æ–¹æ³•ï¼Œç”Ÿæˆç»“æ„åŒ–çš„Sceneæ–‡æœ¬ï¼Œä½†æ˜¯ä»–çš„æ–‡æœ¬ä»…åŒ…å«ç±»åˆ«</p><p><img src="https://picture.fanfer.top/img/VoxPoser4.png" alt="æˆªå±2023-11-23 16.28.30.png"></p><p><em>I. Singh, V. Blukis, A. Mousavian, A. Goyal, D. Xu, J. Tremblay, D. Fox, J. Thomason, and</em><br><em>A. Garg. Progprompt: Generating situated robot task plans using large language models.</em><br><em>arXiv preprint arXiv:2209.11302, 2022.   <strong>ICRA2023</strong></em></p><p>æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªç¼–ç¨‹å¼LLMæç¤ºç»“æ„ï¼Œä½¿å…¶èƒ½å¤Ÿåœ¨å…·ä½“ç¯å¢ƒã€æœºå™¨äººèƒ½åŠ›å’Œä»»åŠ¡ä¹‹é—´å®ç°åŠŸèƒ½æ€§è®¡åˆ’ç”Ÿæˆã€‚æˆ‘ä»¬ä¸»è¦æ€è·¯æ˜¯ç”¨ç±»ä¼¼ç¨‹åºçš„æ–¹å¼å‘LLMæç¤ºå¯ç”¨è¡ŒåŠ¨å’Œç‰©ä½“åœ¨ç¯å¢ƒä¸­ä»¥åŠå¯æ‰§è¡Œç¤ºä¾‹ç¨‹åºã€‚</p><p><img src="https://picture.fanfer.top/img/VoxPoser5.png" alt="æˆªå±2023-11-23 16.32.32.png"></p><p><em>A. Zeng, A. Wong, S. Welker, K. Choromanski, F. Tombari, A. Purohit, M. Ryoo, V. Sindhwani,</em><br><em>J. Lee, V. Vanhoucke, et al. Socratic models: Composing zero-shot multimodal reasoning</em><br><em>with language. arXiv preprint arXiv:2204.00598, 2022.</em></p><p>æˆ–è€…é‡‡ç”¨å¤šæ¨¡æ€è¾“å…¥</p><p><em>D. Driess, F. Xia, M. S. Sajjadi, C. Lynch, A. Chowdhery, B. Ichter, A. Wahid, J. Tompson,</em><br><em>Q. Vuong, T. Yu, et al. Palm-e: An embodied multimodal language model. arXiv preprint</em><br><em>arXiv:2303.03378, 2023.</em></p><p>æå‡ºäº†å…·æœ‰ä½“éªŒæ€§çš„è¯­è¨€æ¨¡å‹ï¼Œå°†çœŸå®ä¸–ç•Œçš„è¿ç»­ä¼ æ„Ÿå™¨æ¨¡æ€ç›´æ¥èå…¥åˆ°è¯­è¨€æ¨¡å‹ä¸­ï¼Œå¹¶å»ºç«‹å•è¯å’Œæ„ŸçŸ¥ä¹‹é—´çš„è”ç³»ã€‚æˆ‘ä»¬æ‰€æå‡ºçš„ä½“éªŒæ€§è¯­è¨€æ¨¡å‹è¾“å…¥æ˜¯å¤šæ¨¡å¼å¥å­ï¼Œäº¤æ›¿åŒ…å«è§†è§‰ã€è¿ç»­çŠ¶æ€ä¼°è®¡å’Œæ–‡æœ¬è¾“å…¥ç¼–ç ã€‚(è®­ç»ƒäº†ä¸€ä¸ª526Bå‚æ•°å¤§å°çš„æ¨¡å‹)</p><p><img src="https://picture.fanfer.top/img/VoxPoser6.png" alt="Untitled"></p><p><em>OpenAI. Gpt-4 technical report. arXiv, 2023.</em></p>]]></content>
      
      
      <categories>
          
          <category> è®ºæ–‡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬”è®° </tag>
            
            <tag> è®ºæ–‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åä¸ºæ¯æ•°æ¨¡å°è®°</title>
      <link href="/2023/11/15/%E5%8D%8E%E4%B8%BA%E6%9D%AF%E6%95%B0%E6%A8%A1%E5%B0%8F%E8%AE%B0/"/>
      <url>/2023/11/15/%E5%8D%8E%E4%B8%BA%E6%9D%AF%E6%95%B0%E6%A8%A1%E5%B0%8F%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©ä¸‹åˆåœ¨å®éªŒå®¤æ‘¸é±¼çš„æ—¶å€™ï¼Œå¬åˆ°éš”å£ç»„è¯´åä¸ºæ¯å‡ºç»“æœäº†ï¼Œå¿ƒä¸‹ä¸€æƒŠï¼Œå»å®˜ç½‘æŸ¥äº†ä¸€ä¸‹ç»“æœï¼Œå‡ºä¹æ„æ–™åœ°ç«Ÿç„¶æ‹¿äº†å›½ä¸€(è¿˜æœ‰ä¸€ä¸ªå°æ’æ›²ï¼Œåœ¨excelè¡¨é‡Œæœæˆ‘åå­—çš„æ—¶å€™æœåˆ°äº†å›½ä¸‰ï¼Œç»“æœå‘ç°æ˜¯åŒååŒå§“çš„ä¸€ä½è€å“¥)ã€‚ç®€å•è®°å½•ä¸€ä¸‹æ•°æ¨¡çš„ç»å†ï¼Œç»™ä¹‹ååƒæˆ‘ä¸€æ ·ç¬¬ä¸€æ¬¡å‚åŠ çš„åŒå­¦ä¸€äº›ç»éªŒã€‚</p><h1 id="èµ›å‰">èµ›å‰</h1><p>ç¬¬ä¸€æ¬¡å‚åŠ æ•°æ¨¡ç±»çš„ç«èµ›ï¼Œèµ›å‰æŠ±ç€å­¦ä¹ å’Œç§¯ç´¯ç»éªŒçš„æƒ³æ³•æŠ¥çš„åï¼Œä¹Ÿæ²¡åšå•¥å‡†å¤‡ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªç›¸å…³çš„bç«™è§†é¢‘ï¼Œç»“æœé‚£æ®µæ—¶é—´å¤ªå¿™äº†ä¸€é›†ä¹Ÿæ²¡çœ‹ï¼Œæœ€åå°±æˆªäº†ä¸€é¡µå„ç±»é—®é¢˜é€‚åˆçš„æ¨¡å‹ã€‚å‰©ä¸‹çš„å€’æ˜¯åœ¨çŸ¥ä¹çœ‹äº†ä¸å°‘ç»éªŒè´´ï¼Œä¸è¿‡æ„Ÿè§‰ä¹Ÿæ²¡å­¦åˆ°ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œå› ä¸ºæˆ‘åœ¨é˜Ÿé‡Œä¸»è¦è´Ÿè´£ç¼–ç¨‹å’Œæ¨¡å‹éƒ¨åˆ†ï¼Œè™½ç„¶çœŸçš„æ‰“èµ·æ¯”èµ›æ¥å®Œå…¨æ²¡æœ‰æŒ‰ç…§åˆ†å·¥è¿›è¡Œï¼Œä½†æ˜¯å› ä¸ºè‡ªå·±æ˜¯è®¡ç®—æœºå‡ºèº«ï¼Œåˆæ˜¯å­¦äººå·¥æ™ºèƒ½çš„ï¼Œæ‰€ä»¥å¯¹äºå¸¸è§çš„æœºå™¨å­¦ä¹ çš„æ¨¡å‹ï¼Œéƒ½è¿˜ç®—äº†è§£ï¼Œå†åŠ ä¸Špythonå„ç§åº“éƒ½æœ‰ï¼Œæ‰€ä»¥å…¶å®çœŸçš„åšèµ·æ¥æ„Ÿè§‰ç¼–ç¨‹çš„å‹åŠ›ä¸ç®—å¾ˆå¤§ã€‚</p><h1 id="å¼€èµ›">å¼€èµ›</h1><p>å› ä¸ºæˆ‘æ˜¯ä¸€ä¸ªäººä½åœ¨å®¿èˆï¼Œæ‰€ä»¥æˆ‘çš„å®¿èˆå°±æˆäº†æˆ‘ä»¬æ‰“æ¯”èµ›çš„åœºåœ°ï¼Œèµ›å‰æˆ‘ä¸“é—¨ä¹°äº†ä¸€å¼ å°æ¡Œå­ï¼Œåæ¥æˆäº†æˆ‘ä»¬å¼€ä¼šè®¨è®ºå’Œèšåœ¨ä¸€èµ·åƒå¤–å–çš„é¤æ¡Œï¼Œè¿˜æœ‰ä¸€ä¸ªåŒå­¦çš„åŠå…¬æ¡Œã€‚</p><p>ç¬¬ä¸€å¤©å¼€èµ›çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾ˆå¿«å°±å†³å®šäº†åšEé¢˜ï¼Œä¸€é“åŒ»å­¦çš„æ•°æ®åˆ†æçš„é¢˜ï¼Œå€’ä¸æ˜¯å› ä¸ºå…¶ä»–ä»€ä¹ˆåŸå› ï¼Œçº¯ç²¹æ˜¯æˆ‘ä»¬ä¸€éçœ‹ä¸‹æ¥åªèƒ½çœ‹å¾—æ‡‚è¿™é“é¢˜ï¼Œæœç„¶è¿™é“é¢˜ä¹Ÿæ˜¯ç»å¤§å¤šæ•°äººçš„é€‰æ‹©ã€‚</p><p>å…¶å®åˆšå¼€èµ›æ‹¿åˆ°é¢˜ç›®ï¼Œæˆ‘å°±æ„Ÿè§‰è¿™å¾ˆåƒæˆ‘æœ¬ç§‘åšçš„ä¸€äº›æœºå™¨å­¦ä¹ çš„å¤§ä½œä¸šï¼Œæ„Ÿè§‰è¿™ä¸å°±æ˜¯ä¸€ä¸ªæ³°å¦å°¼å…‹å·ç”Ÿå­˜æ¦‚ç‡çš„é—®é¢˜å’Œæ´›æ‰çŸ¶æˆ¿ä»·é¢„æµ‹çš„ç»¼åˆå—ï¼Ÿä¸è¿‡æ˜¯å„ç§å„æ ·çš„å‚æ•°å¤šäº†ä¸€äº›ï¼Œè¦å¥½å¥½åœ°æ ¹æ®é—®é¢˜åšä¸€äº›ç‰¹å¾å·¥ç¨‹ï¼Œé—®é¢˜æ›´åŠ å¤æ‚ä¸€äº›ï¼Œä¸èƒ½ç”¨ç®€å•çš„çº¿æ€§å›å½’å»æ‹Ÿåˆäº†ï¼Œåé¢è¿˜å¾—åŠ ä¸€äº›å’Œé—®é¢˜ç›¸å…³çš„èšç±»å’Œåˆ†æã€‚</p><p>æˆ‘ä»¬å¼€èµ›åå°±æ²¡æœ‰æŒ‰ç…§æœ€å…ˆé¢„è®¡åœ°åˆ†æˆç¼–ç¨‹ã€è®ºæ–‡å’Œæ¨¡å‹ä¸‰ä¸ªäººåˆ†åˆ«åšï¼Œä¸»è¦æ˜¯è¿™æ ·å¤§å®¶æ²¡åŠæ³•åŒæ­¥å¼€å±•å·¥ä½œï¼Œè€Œä¸”å¤§å®¶éƒ½æ˜¯ç”µä¿¡ã€è®¡ç®—æœºä¸“ä¸šï¼Œæ‹¿ç€ä¹Ÿéƒ½èƒ½åšï¼Œæ‰€ä»¥æœ€åå˜æˆäº†ä¸€ä¸ªäººä¸»è¦è´Ÿè´£ä¸€ä¸ªå¤§é¢˜ï¼Œå„è‡ªå¼€å±•å·¥ä½œã€‚</p><h1 id="èµ›ä¸­">èµ›ä¸­</h1><p>æˆ‘ä¸»è¦è´Ÿè´£æ•°æ®çš„å¤„ç†å’Œåç»­å»ºæ¨¡åšäºŒåˆ†ç±»ã€å¤šåˆ†ç±»ã€æ¦‚ç‡é¢„æµ‹ï¼Œè¿™äº›é—®é¢˜åŸºæœ¬ä¸Šéƒ½æ˜¯æœºå™¨å­¦ä¹ å…¥é—¨çš„ç»ƒä¹ ï¼Œåªä¸è¿‡è¿™é“é¢˜æœ‰å¾ˆå¤šç‰¹æ®Šæ€§ã€‚</p><p>ä»æ•°æ®å¤„ç†ä¸Šæ¥è¯´ï¼Œæ•°æ®é‡å¾ˆå°ï¼Œè€Œä¸”æ ·æœ¬çš„åˆ†å¸ƒåˆç‰¹åˆ«ä¸å‡åŒ€ï¼Œæ•°æ®çš„ç‰¹å¾ç‰¹åˆ«å¤šï¼Œè¿™äº›ç‰¹å¾ä¹‹é—´åˆæœ‰å¾ˆå¼ºçš„å…³è”æ€§ï¼Œæ•°æ®åˆ†å¸ƒåœ¨å¤šä¸ªè¡¨æ ¼ä¸­ï¼Œä¸åŒè¡¨æ ¼ä¸­çš„æ•°æ®è¿˜å­˜åœ¨å†²çªçŸ›ç›¾ã€‚æ€»ä¹‹æ•°æ®å¤„ç†å°±æ˜¯ä¸€ä»¶ç¹çã€é‡å¤åˆå¾ˆå…³é”®çš„å·¥ä½œã€‚å…¶å®æˆ‘ä»¬æœ€åä¹Ÿæ²¡æœ‰ä»ç†è®ºå±±æ‰¾åˆ°ä¸€ä¸ªè¾ƒå¥½çš„é€‰å–ç‰¹å¾çš„æ–¹æ³•ï¼Œä½†æ˜¯æ•°æ®ä¸­æœ‰å¾ˆå¤šè‚¿ç˜¤çš„å½¢æ€å­¦å‚æ•°ï¼Œè‚¯å®šè¦åšæ•°æ®é™ç»´ï¼Œæœ€åæˆ‘ä»¬ç”¨ç›¸å…³æ€§åˆ†æåšäº†ä¸€äº›ç®€å•çš„ç­›é€‰ï¼Œæ€»ä½“æ¥çœ‹æœ‰ä¸€å®šçš„æ•ˆæœã€‚</p><p>æ¯•ç«Ÿæ˜¯å»ºæ¨¡å¤§èµ›ï¼Œæ¨¡å‹çš„é€‰å–å…¶å®å¾ˆé‡è¦ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹‹å‰éƒ½æ²¡æœ‰æ•°æ¨¡çš„ç»éªŒï¼Œè€Œä¸”å¹³æ—¶éƒ½æ˜¯åšæ·±åº¦å­¦ä¹ çš„ï¼Œæœ€è¿™äº›æœºå™¨å­¦ä¹ çš„æ¨¡å‹äº†è§£ï¼Œä½†ä¸å¤šï¼Œè€Œä¸”é¢˜ç›®é‡Œè¿‡å°çš„æ•°æ®é‡å®Œå…¨æœç»äº†ä¸Šæ·±åº¦å­¦ä¹ çš„å¯èƒ½æ€§ï¼Œæ‰€ä»¥æœ€åæˆ‘ä»¬é€‰æ‹©äº†æœ€ç®€å•ä½†æ˜¯å¾ˆæœ‰æ•ˆçš„æ–¹æ³•ï¼ŒæŠŠå¸¸è§çš„æœºå™¨å­¦ä¹ æ¨¡å‹éƒ½æ‹¿æ¥è¯•ä¸€éï¼Œåšå¤šæŠ˜çš„äº¤å‰éªŒè¯ï¼Œä»€ä¹ˆæ¨¡å‹çš„æ•ˆæœå¥½ï¼Œå°±æ‹¿ä»€ä¹ˆæ¨¡å‹åšã€‚</p><p>æœ€åè¯•äº†å„ç§å„æ ·çš„æ¨¡å‹ï¼Œæ¯ä¸ªæ¨¡å‹åˆè¯•äº†å¥½å¤šå‚æ•°ï¼Œæœ€ç»ˆé€‰å‡ºäº†å‡ ä¸ªæ•ˆæœè¿˜ä¸é”™çš„æ¨¡å‹ï¼Œå†åšä¸€ç‚¹ç»„åˆã€æŠ•ç¥¨å†³ç­–ä¹‹ç±»çš„ï¼Œå°±ç®—å®Œå·¥ã€‚</p><p>å…¶ä»–é˜Ÿå‹è¿˜åšäº†æ‹Ÿåˆã€èšç±»çš„å·¥ä½œï¼Œä¸è¿‡å› ä¸ºæˆ‘è‡ªå·±æ²¡åšé‚£ä¸€éƒ¨åˆ†ï¼Œå°±ä¸è¯¦ç»†å±•å¼€äº†ã€‚</p><h1 id="è®ºæ–‡">è®ºæ–‡</h1><p>å…¶å®æ„Ÿè§‰å¯¹äºæ•°æ¨¡æ¥è®²ï¼Œæœ€é‡è¦çš„è¿˜æ˜¯è¦è®ºæ–‡å†™å¾—å¥½ï¼Œèµ·ç å›¾å’Œè¡¨è¦åšçš„ä¸°å¯Œä¸”å¥½çœ‹ã€‚å› ä¸ºæˆ‘ä»¬ä¸‰ä¸ªäººéƒ½è¦å†™è®ºæ–‡ï¼Œæ‰€ä»¥overleafæ•´èµ·æ¥ï¼Œè¯­è¨€ä¸Šå°½é‡å­¦æœ¯ï¼Œç»“æ„ä¸Šæœ‰ä¸€æ¡ä¸»çº¿è´¯ç©¿æ¯ä¸€ä¸ªç« èŠ‚ï¼Œæ¯ä¸ªå°ç« èŠ‚å†…ç”¨ä¸€ä¸ªæµç¨‹å›¾è®²æ¸…æ¥šåšäº†ä»€ä¹ˆå·¥ä½œï¼Œæ˜¯æ€ä¹ˆåšçš„ã€‚</p><p>å…¶å®æˆ‘ä»¬å€’ä¹Ÿæ²¡æœ‰åˆ»æ„åœ°å †å­—æ•°ï¼Œå†™ç€å†™ç€å°±å†™äº†äº”åå¤šé¡µï¼Œä¸è¿‡æˆ‘ä¸ªäººè¿˜æ˜¯è§‰å¾—æ¸…æ™°çš„ç»“æ„ï¼Œç« èŠ‚å†…æ˜ç¡®çš„æµç¨‹ï¼Œç²¾ç¾çš„å›¾æ ‡æ‰æ˜¯å…³é”®ã€‚</p><h1 id="å°ç»“">å°ç»“</h1><p>å…¶å®æ€»ä½“æ¥è¯´ï¼Œæˆ‘ä»¬ç»„å› ä¸ºä¸‰ä¸ªäººéƒ½è¿˜æŒºè´Ÿè´£çš„ï¼Œå¤§å®¶éƒ½ä»å¤´åšåˆ°å°¾åšæŒäº†ä¸‹æ¥ï¼Œä¸­é—´é™¤äº†æœ‰ä¸€å¤©ä¸‰ä¸ªäººéƒ½æœ‰å¿…é¡»å»ä¸Šçš„è¯¾æ²¡å·¥ä½œï¼Œæœ€åä¸€å¤©ç†¬åˆ°äº†æ—©ä¸Šå…­ç‚¹é€šå®µèµ¶äº†è®ºæ–‡å¤–ï¼Œéƒ½æ˜¯æ­£å¸¸çš„å·¥ä½œæ—¶é—´ï¼Œä¸€ä¸ªæƒ…ç»ªç¨³å®šã€è¸å®å¹²æ´»çš„é˜Ÿå†…æ°›å›´è¿˜æ˜¯å¾ˆé‡è¦çš„ã€‚</p><p>æœ€åæ„Ÿè°¢ä¸€ä¸‹æˆ‘çš„ä¸¤ä½é˜Ÿå‹ï¼Œå¾ˆå¼€å¿ƒçš„ä¸€æ¬¡ç»å†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> éšç¬” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pythonå¤šçº¿ç¨‹</title>
      <link href="/2023/10/31/python%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
      <url>/2023/10/31/python%E5%A4%9A%E7%BA%BF%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘ç”¨åˆ°pythonçš„å¤šçº¿ç¨‹ï¼Œå› æ­¤æ•´ç†äº†ä¸€ä¸‹ï¼Œä»…åšè®°å½•ã€‚</p><h1 id="åˆ›å»ºå¤šçº¿ç¨‹">åˆ›å»ºå¤šçº¿ç¨‹</h1><p>è¦åˆ›å»ºä¸€ä¸ªç®€å•çš„å¤šçº¿ç¨‹ç¨‹åºï¼Œå…¶ä¸­ä¸€ä¸ªçº¿ç¨‹ä»APIä¸­è·å–è®¢å•ä¿¡æ¯ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å°†è®¢å•åˆ†é…ç»™æ— äººæœºç¾¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Pythonçš„**<code>threading</code>**æ¨¡å—ã€‚è¿™é‡Œæˆ‘ä»¬æ¨¡æ‹ŸAPIè°ƒç”¨å’Œæ— äººæœºåˆ†é…ï¼Œå› ä¸ºæ²¡æœ‰å…·ä½“çš„APIå’Œæ— äººæœºç¾¤å®ç°ç»†èŠ‚ã€‚</p><ol><li><strong>è·å–è®¢å•çš„çº¿ç¨‹</strong>ï¼šæ¨¡æ‹Ÿä»APIä¸­è·å–æ–°è®¢å•ï¼Œå®é™…ä½¿ç”¨ä¸­ï¼Œè¿™é‡Œåº”æ›¿æ¢ä¸ºçœŸå®çš„APIè°ƒç”¨ã€‚</li><li><strong>åˆ†é…è®¢å•çš„çº¿ç¨‹</strong>ï¼šè·å–åˆ°æ–°è®¢å•åï¼Œæ¨¡æ‹Ÿåˆ†é…è¿™äº›è®¢å•åˆ°æ— äººæœºä¸Šã€‚</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡æ‹Ÿçš„è®¢å•é˜Ÿåˆ—</span></span><br><span class="line">order_queue = queue.Queue()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡æ‹Ÿä»APIè·å–è®¢å•</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fetch_orders</span>():</span><br><span class="line">    order_id = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="comment"># æ¨¡æ‹ŸAPIè°ƒç”¨çš„å»¶æ—¶</span></span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line">        order_id += <span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;è·å–åˆ°æ–°è®¢å•: <span class="subst">&#123;order_id&#125;</span>&quot;</span>)</span><br><span class="line">        order_queue.put(order_id)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡æ‹Ÿå°†è®¢å•åˆ†é…ç»™æ— äººæœº</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">assign_orders</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="comment"># ç­‰å¾…æ–°è®¢å•</span></span><br><span class="line">        new_order = order_queue.get()</span><br><span class="line">        <span class="comment"># æ¨¡æ‹Ÿåˆ†é…è®¢å•åˆ°æ— äººæœºçš„å¤„ç†æ—¶é—´</span></span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;è®¢å• <span class="subst">&#123;new_order&#125;</span> å·²åˆ†é…åˆ°æ— äººæœº&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå¹¶å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line">threading.Thread(target=fetch_orders, daemon=<span class="literal">True</span>).start()</span><br><span class="line">threading.Thread(target=assign_orders, daemon=<span class="literal">True</span>).start()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸ºäº†ç¤ºä¾‹ï¼Œæˆ‘ä»¬è®©ä¸»çº¿ç¨‹æŒç»­è¿è¡Œ10ç§’</span></span><br><span class="line">time.sleep(<span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ç¨‹åºå®Œæˆ&quot;</span>)</span><br></pre></td></tr></table></figure><h1 id="æ§åˆ¶çº¿ç¨‹ç»“æŸ">æ§åˆ¶çº¿ç¨‹ç»“æŸ</h1><p><strong>æ§åˆ¶å½“åˆ†é…å®Œ10ä¸ªè®¢å•åï¼Œè·å–è®¢å•çš„ç¨‹åºå…³é—­ï¼Œåˆ†é…çš„çº¿ç¨‹åˆ†é…å®Œæ‰€æœ‰çš„è®¢å•åå…³é—­</strong></p><ol><li><strong>æ§åˆ¶è®¢å•è·å–æ•°é‡</strong>ï¼šè·å–è®¢å•çš„çº¿ç¨‹åœ¨è·å–åˆ°ä¸€å®šæ•°é‡ï¼ˆæ¯”å¦‚10ä¸ªï¼‰çš„è®¢å•ååœæ­¢ã€‚</li><li><strong>å®Œæˆè®¢å•åˆ†é…åå…³é—­åˆ†é…çº¿ç¨‹</strong>ï¼šåˆ†é…çº¿ç¨‹åœ¨é˜Ÿåˆ—ä¸ºç©ºä¸”è·å–è®¢å•çš„çº¿ç¨‹å·²ç»ç»“æŸæ—¶åœæ­¢ã€‚</li></ol><p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¼•å…¥å‡ ä¸ªæ”¹å˜ï¼š</p><ul><li>ä½¿ç”¨ä¸€ä¸ªå…±äº«å˜é‡ï¼ˆå¦‚**<code>threading.Event</code>**ï¼‰æ¥é€šçŸ¥åˆ†é…çº¿ç¨‹ï¼Œè®¢å•è·å–çº¿ç¨‹å·²ç»åœæ­¢ã€‚</li><li>åˆ†é…çº¿ç¨‹åœ¨é˜Ÿåˆ—å˜ç©ºä¸”æ”¶åˆ°è®¢å•è·å–çº¿ç¨‹åœæ­¢çš„é€šçŸ¥åç»“æŸã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"></span><br><span class="line">order_queue = queue.Queue()</span><br><span class="line">max_orders = <span class="number">10</span>  <span class="comment"># æœ€å¤§è®¢å•æ•°</span></span><br><span class="line">orders_fetched = threading.Event()  <span class="comment"># ç”¨äºé€šçŸ¥è®¢å•è·å–å·²å®Œæˆ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡æ‹Ÿä»APIè·å–è®¢å•</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fetch_orders</span>(<span class="params">api_id</span>):</span><br><span class="line">    <span class="keyword">for</span> order_id <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, max_orders + <span class="number">1</span>):</span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[API <span class="subst">&#123;api_id&#125;</span>] è·å–åˆ°æ–°è®¢å•: <span class="subst">&#123;order_id&#125;</span>&quot;</span>)</span><br><span class="line">        order_queue.put(order_id)</span><br><span class="line">    orders_fetched.<span class="built_in">set</span>()  <span class="comment"># è®¾ç½®äº‹ä»¶ï¼Œé€šçŸ¥è®¢å•è·å–å·²å®Œæˆ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡æ‹Ÿå°†è®¢å•åˆ†é…ç»™æ— äººæœº</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">assign_orders</span>(<span class="params">drone_id</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> (orders_fetched.is_set() <span class="keyword">and</span> order_queue.empty()):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            new_order = order_queue.get(timeout=<span class="number">3</span>)  <span class="comment"># è®¾ç½®è¶…æ—¶ï¼Œé¿å…æ— é™ç­‰å¾…</span></span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[æ— äººæœº <span class="subst">&#123;drone_id&#125;</span>] è®¢å• <span class="subst">&#123;new_order&#125;</span> å·²åˆ†é…&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> queue.Empty:</span><br><span class="line">            <span class="comment"># å¦‚æœç­‰å¾…æ—¶é—´è¿‡é•¿æ²¡æœ‰è®¢å•ï¼Œæ£€æŸ¥æ˜¯å¦åº”è¯¥é€€å‡º</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[æ— äººæœº <span class="subst">&#123;drone_id&#125;</span>] æ‰€æœ‰è®¢å•å·²åˆ†é…å®Œæ¯•ï¼Œçº¿ç¨‹å…³é—­ã€‚&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line">threading.Thread(target=fetch_orders, args=(<span class="number">1</span>,), daemon=<span class="literal">True</span>).start()</span><br><span class="line">threading.Thread(target=assign_orders, args=(<span class="number">1</span>,), daemon=<span class="literal">False</span>).start()</span><br></pre></td></tr></table></figure><ul><li><strong><code>fetch_orders</code></strong> å‡½æ•°åœ¨å¤„ç†æŒ‡å®šæ•°é‡ï¼ˆ<strong><code>max_orders</code></strong>ï¼‰çš„è®¢å•åä¼šé€€å‡ºå¾ªç¯ï¼Œå¹¶é€šè¿‡**<code>orders_fetched.set()</code>**é€šçŸ¥å…¶ä»–çº¿ç¨‹ã€‚</li><li><strong><code>assign_orders</code></strong> çº¿ç¨‹ä¼šæ£€æŸ¥ä¸¤ä¸ªæ¡ä»¶ï¼šæ˜¯å¦æ¥æ”¶åˆ°äº†ç»“æŸé€šçŸ¥ï¼Œä»¥åŠé˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºã€‚å½“ä¸¤ä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³æ—¶ï¼Œè¡¨ç¤ºæ‰€æœ‰è®¢å•éƒ½å·²ç»åˆ†é…å®Œæ¯•ï¼Œçº¿ç¨‹å¯ä»¥å®‰å…¨é€€å‡ºã€‚</li></ul><p>è¿™ç§è®¾è®¡æ¨¡å¼å¯ä»¥ç¡®ä¿æ‰€æœ‰çš„è®¢å•è¢«å¤„ç†åï¼Œç¨‹åºæ‰å®Œå…¨ç»“æŸè¿è¡Œã€‚å…¶ä¸­**<code>queue.Empty</code><strong>å¼‚å¸¸å¤„ç†æ˜¯ä¸ºäº†é˜²æ­¢åœ¨</strong><code>order_queue.get()</code>**è°ƒç”¨ä¸­æ— é™æœŸåœ°é˜»å¡ï¼Œå°¤å…¶æ˜¯åœ¨è·å–è®¢å•çš„çº¿ç¨‹å·²ç»åœæ­¢çš„æƒ…å†µä¸‹ã€‚é€šè¿‡è®¾ç½®ä¸€ä¸ªåˆç†çš„è¶…æ—¶æ—¶é—´ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é˜Ÿåˆ—ç©ºé—²æ—¶å‘¨æœŸæ€§åœ°æ£€æŸ¥é˜Ÿåˆ—çŠ¶æ€ã€‚</p><h1 id="å¤šçº¿ç¨‹å…±äº«å•ä¸€èµ„æº">å¤šçº¿ç¨‹å…±äº«å•ä¸€èµ„æº</h1><p>æŠŠæ— äººæœºçš„è®¢å•å¤„ç†æ—¶é—´ä½œä¸ºå‚æ•°ä¼ å…¥åˆ†é…å‡½æ•°ï¼Œç”¨ä¸æ¨¡æ‹Ÿä¸åŒæ— äººæœºçš„èƒ½åŠ›ä¸åŒ</p><p>æˆ‘ä»¬å¯ä»¥å°†å¤„ç†æ—¶é—´ä½œä¸ºä¸€ä¸ªå‚æ•°ä¼ é€’ç»™**<code>assign_orders</code>**å‡½æ•°ã€‚è¿™æ ·ï¼Œæ¯ä¸ªæ— äººæœºçº¿ç¨‹å¯ä»¥æ ¹æ®è‡ªå·±çš„å¤„ç†é€Ÿåº¦æ¥æ¨¡æ‹Ÿè®¢å•çš„å¤„ç†æ—¶é—´ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"></span><br><span class="line">order_queue = queue.Queue()</span><br><span class="line">max_orders = <span class="number">10</span></span><br><span class="line">orders_fetched = threading.Event()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡æ‹Ÿä»APIè·å–è®¢å•</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fetch_orders</span>(<span class="params">api_id</span>):</span><br><span class="line">    <span class="keyword">for</span> order_id <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, max_orders + <span class="number">1</span>):</span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[API <span class="subst">&#123;api_id&#125;</span>] è·å–åˆ°æ–°è®¢å•: <span class="subst">&#123;order_id&#125;</span>&quot;</span>)</span><br><span class="line">        order_queue.put(order_id)</span><br><span class="line">    orders_fetched.<span class="built_in">set</span>()  <span class="comment"># é€šçŸ¥è®¢å•è·å–å®Œæ¯•</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡æ‹Ÿå°†è®¢å•åˆ†é…ç»™æ— äººæœº</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">assign_orders</span>(<span class="params">drone_id, processing_time</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> (orders_fetched.is_set() <span class="keyword">and</span> order_queue.empty()):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            new_order = order_queue.get(timeout=<span class="number">3</span>)</span><br><span class="line">            time.sleep(processing_time)  <span class="comment"># æ ¹æ®æ— äººæœºçš„å¤„ç†èƒ½åŠ›è¿›è¡Œç­‰å¾…</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[æ— äººæœº <span class="subst">&#123;drone_id&#125;</span>] è®¢å• <span class="subst">&#123;new_order&#125;</span> å·²åˆ†é…&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> queue.Empty:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[æ— äººæœº <span class="subst">&#123;drone_id&#125;</span>] æ‰€æœ‰è®¢å•å·²åˆ†é…å®Œæ¯•ï¼Œçº¿ç¨‹å…³é—­ã€‚&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line">threading.Thread(target=fetch_orders, args=(<span class="number">1</span>,), daemon=<span class="literal">True</span>).start()</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸åŒå¤„ç†èƒ½åŠ›çš„ä¸‰ä¸ªæ— äººæœºåˆ†é…çº¿ç¨‹</span></span><br><span class="line">drones = [(<span class="number">1</span>, <span class="number">1</span>), (<span class="number">2</span>, <span class="number">2</span>), (<span class="number">3</span>, <span class="number">1.5</span>)]  <span class="comment"># (æ— äººæœºID, å¤„ç†æ—¶é—´)</span></span><br><span class="line"><span class="keyword">for</span> drone_id, processing_time <span class="keyword">in</span> drones:</span><br><span class="line">    threading.Thread(target=assign_orders, args=(drone_id, processing_time), daemon=<span class="literal">False</span>).start()</span><br></pre></td></tr></table></figure><ul><li>æ¯ä¸ªæ— äººæœºçº¿ç¨‹é€šè¿‡**<code>processing_time</code><strong>å‚æ•°æ¥æ”¶äº†ä¸€ä¸ªå¤„ç†æ—¶é—´çš„å€¼ï¼Œè¿™æ¨¡æ‹Ÿäº†ä¸åŒæ— äººæœºçš„å¤„ç†èƒ½åŠ›ã€‚ä¾‹å¦‚ï¼Œ</strong><code>processing_time</code><strong>ä¸º1çš„æ— äººæœºä¼šæ¯”</strong><code>processing_time</code>**ä¸º2çš„æ— äººæœºæ›´å¿«åœ°å¤„ç†è®¢å•ã€‚</li><li>æˆ‘ä»¬åˆ›å»ºäº†ä¸‰ä¸ªæ— äººæœºçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰å…¶è‡ªå·±çš„å¤„ç†æ—¶é—´ã€‚ä¾‹å¦‚ï¼Œæ— äººæœº1å¤„ç†æ—¶é—´ä¸º1ç§’ï¼Œæ— äººæœº2å¤„ç†æ—¶é—´ä¸º2ç§’ï¼Œæ— äººæœº3å¤„ç†æ—¶é—´ä¸º1.5ç§’ã€‚</li></ul><ol><li><strong><code>fetch_orders</code></strong> å‡½æ•°ä»ç„¶è´Ÿè´£ç”Ÿæˆæœ€å¤š**<code>max_orders</code><strong>ä¸ªè®¢å•ï¼Œå¹¶åœ¨å®Œæˆåè®¾ç½®</strong><code>orders_fetched</code>**äº‹ä»¶ã€‚</li><li>æˆ‘ä»¬åˆ›å»ºäº†ä¸‰ä¸ªæ— äººæœºçº¿ç¨‹ï¼ˆ<strong><code>assign_orders</code></strong>ï¼‰ï¼Œæ¯ä¸ªçº¿ç¨‹ä»£è¡¨ä¸€ä¸ªä¸åŒçš„æ— äººæœºï¼ˆæ— äººæœºIDä»1åˆ°3ï¼‰ã€‚è¿™äº›çº¿ç¨‹ä¼šå¹¶å‘åœ°ä»**<code>order_queue</code>**ä¸­è·å–å¹¶å¤„ç†è®¢å•ã€‚</li><li>æ¯ä¸ªæ— äººæœºçº¿ç¨‹åœ¨å¤„ç†æ—¶ï¼Œéƒ½ä¼šå°è¯•ä»é˜Ÿåˆ—ä¸­è·å–è®¢å•ã€‚å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œå®ƒå°†ä¼šç­‰å¾…ä¸€æ®µæ—¶é—´ï¼ˆè¿™é‡Œè®¾ç½®ä¸º3ç§’ï¼‰ï¼Œç„¶åå†æ¬¡æ£€æŸ¥æ˜¯å¦è¿˜æœ‰è®¢å•ã€‚å¦‚æœæ²¡æœ‰æ–°çš„è®¢å•å¹¶ä¸”å·²çŸ¥æ‰€æœ‰è®¢å•éƒ½å·²è·å–ï¼ˆå³**<code>orders_fetched</code>**è¢«è®¾ç½®ï¼‰ï¼Œåˆ™çº¿ç¨‹å°†é€€å‡ºã€‚</li></ol><p><strong>å®‰å…¨è®¿é—®</strong></p><p>ä»£ç ç¤ºä¾‹ä¸­ï¼Œç”±äºä½¿ç”¨äº†**<code>queue.Queue</code><strong>ï¼Œè¿™ç§æƒ…å†µä¸ä¼šå‘ç”Ÿã€‚</strong><code>queue.Queue</code>** æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè¿™æ„å‘³ç€åœ¨ä»»ä½•æ—¶å€™åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿä»é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªç‰¹å®šçš„å…ƒç´ ã€‚å½“ä¸€ä¸ªçº¿ç¨‹ä»é˜Ÿåˆ—ä¸­è·å–ä¸€ä¸ªé¡¹ç›®æ—¶ï¼Œè¯¥é¡¹ç›®ä¼šè¢«æ ‡è®°ä¸ºå·²åˆ é™¤ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•å†æ¬¡è·å–åˆ°å®ƒã€‚</p><p>è¿™ä¸ªç‰¹æ€§æ˜¯é€šè¿‡å†…éƒ¨é”å®ç°çš„ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨**<code>get()</code><strong>æ–¹æ³•å¹¶ä»é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªé¡¹ç›®æ—¶ï¼Œä»»ä½•å…¶ä»–è¯•å›¾è®¿é—®è¯¥é˜Ÿåˆ—çš„çº¿ç¨‹å°†ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°è¯¥é¡¹ç›®è¢«æˆåŠŸå¤„ç†ï¼ˆå³çº¿ç¨‹å®Œæˆäº†å¯¹</strong><code>get()</code>**çš„è°ƒç”¨ï¼‰ã€‚è¿™å°±ç¡®ä¿äº†å³ä½¿å¤šä¸ªçº¿ç¨‹è¯•å›¾åŒæ—¶ä»é˜Ÿåˆ—ä¸­è·å–é¡¹ç›®ï¼Œæ¯ä¸ªé¡¹ç›®ä¹Ÿåªä¼šè¢«ä¸€ä¸ªçº¿ç¨‹å¤„ç†ã€‚</p><p>å› æ­¤ï¼Œåœ¨è¿™ä¸ªä»£ç ä¸­ï¼Œä¸‰ä¸ªæ— äººæœºçº¿ç¨‹å°†ä¼šå®‰å…¨åœ°ã€ç‹¬ç«‹åœ°ä»é˜Ÿåˆ—ä¸­è·å–å¹¶å¤„ç†è®¢å•ï¼Œè€Œä¸ä¼šå‘ç”Ÿä¸¤ä¸ªçº¿ç¨‹å¤„ç†åŒä¸€ä¸ªè®¢å•çš„æƒ…å†µã€‚æ¯ä¸ªè®¢å•ä¸€æ—¦è¢«ä¸€ä¸ªæ— äººæœºçº¿ç¨‹è·å–ï¼Œå°±ä¼šä»é˜Ÿåˆ—ä¸­ç§»é™¤ï¼Œä¸ä¼šå†è¢«å…¶ä»–æ— äººæœºçº¿ç¨‹è®¿é—®åˆ°ã€‚</p><h1 id="å¤šä¸ªå‘å¸ƒæº">å¤šä¸ªå‘å¸ƒæº</h1><p>ä½¿ç”¨ä¸¤ä¸ªè®¢å•å‘å¸ƒAPIï¼Œä¸”è®©å®ƒä»¬ä»¥ä¸åŒçš„é¢‘ç‡å‘å¸ƒè®¢å•ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹**<code>fetch_orders</code>**å‡½æ•°ç¨ä½œè°ƒæ•´ï¼Œä½¿å…¶æ¥å—ä¸€ä¸ªè¡¨ç¤ºå‘å¸ƒé¢‘ç‡çš„å‚æ•°ã€‚è¿™ä¸ªå‚æ•°å°†å†³å®šAPIè·å–è®¢å•çš„é—´éš”æ—¶é—´ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"></span><br><span class="line">order_queue = queue.Queue()</span><br><span class="line">max_orders = <span class="number">10</span></span><br><span class="line">orders_fetched = threading.Event()</span><br><span class="line">order_count = <span class="number">0</span>  <span class="comment"># è®°å½•è·å–çš„è®¢å•æ€»æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é”å¯¹è±¡ï¼Œç”¨äºåŒæ­¥å¯¹å…±äº«å˜é‡order_countçš„è®¿é—®</span></span><br><span class="line">count_lock = threading.Lock()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡æ‹Ÿä»APIè·å–è®¢å•</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fetch_orders</span>(<span class="params">api_id, fetch_interval</span>):</span><br><span class="line">    <span class="keyword">global</span> order_count</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">with</span> count_lock:</span><br><span class="line">            <span class="keyword">if</span> order_count &gt;= max_orders:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            order_count += <span class="number">1</span></span><br><span class="line">            order_id = order_count</span><br><span class="line"></span><br><span class="line">        time.sleep(fetch_interval)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[API <span class="subst">&#123;api_id&#125;</span>] è·å–åˆ°æ–°è®¢å•: <span class="subst">&#123;order_id&#125;</span>&quot;</span>)</span><br><span class="line">        order_queue.put(order_id)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ£€æŸ¥æ˜¯å¦æ‰€æœ‰è®¢å•éƒ½å·²è·å–</span></span><br><span class="line">    <span class="keyword">with</span> count_lock:</span><br><span class="line">        <span class="keyword">if</span> order_count &gt;= max_orders:</span><br><span class="line">            orders_fetched.<span class="built_in">set</span>()  <span class="comment"># é€šçŸ¥è®¢å•è·å–å®Œæ¯•</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡æ‹Ÿå°†è®¢å•åˆ†é…ç»™æ— äººæœº</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">assign_orders</span>(<span class="params">drone_id, processing_time</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> (orders_fetched.is_set() <span class="keyword">and</span> order_queue.empty()):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            new_order = order_queue.get(timeout=<span class="number">3</span>)</span><br><span class="line">            time.sleep(processing_time)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[æ— äººæœº <span class="subst">&#123;drone_id&#125;</span>] è®¢å• <span class="subst">&#123;new_order&#125;</span> å·²åˆ†é…&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> queue.Empty:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[æ— äººæœº <span class="subst">&#123;drone_id&#125;</span>] æ‰€æœ‰è®¢å•å·²åˆ†é…å®Œæ¯•ï¼Œçº¿ç¨‹å…³é—­ã€‚&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line">threading.Thread(target=fetch_orders, args=(<span class="number">1</span>, <span class="number">2</span>), daemon=<span class="literal">True</span>).start()  <span class="comment"># API 1ï¼Œé—´éš”2ç§’</span></span><br><span class="line">threading.Thread(target=fetch_orders, args=(<span class="number">2</span>, <span class="number">3</span>), daemon=<span class="literal">True</span>).start()  <span class="comment"># API 2ï¼Œé—´éš”3ç§’</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸åŒå¤„ç†èƒ½åŠ›çš„ä¸‰ä¸ªæ— äººæœºåˆ†é…çº¿ç¨‹</span></span><br><span class="line">drones = [(<span class="number">1</span>, <span class="number">1</span>), (<span class="number">2</span>, <span class="number">2</span>), (<span class="number">3</span>, <span class="number">1.5</span>)]</span><br><span class="line"><span class="keyword">for</span> drone_id, processing_time <span class="keyword">in</span> drones:</span><br><span class="line">    threading.Thread(target=assign_orders, args=(drone_id, processing_time), daemon=<span class="literal">False</span>).start()</span><br></pre></td></tr></table></figure><ol><li>**<code>fetch_orders</code><strong>å‡½æ•°ç°åœ¨æ¥å—ä¸€ä¸ª</strong><code>fetch_interval</code>**å‚æ•°ï¼Œå®ƒå†³å®šäº†APIè·å–è®¢å•çš„é—´éš”æ—¶é—´ã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥ä¸ºä¸¤ä¸ªAPIçº¿ç¨‹è®¾ç½®ä¸åŒçš„è·å–é¢‘ç‡ã€‚</li><li>ä½¿ç”¨äº†å…¨å±€å˜é‡**<code>order_count</code><strong>æ¥è®°å½•å·²è·å–çš„è®¢å•æ•°é‡ï¼Œå¹¶ä½¿ç”¨</strong><code>count_lock</code><strong>æ¥ç¡®ä¿åœ¨ä¿®æ”¹</strong><code>order_count</code>**æ—¶çš„çº¿ç¨‹å®‰å…¨ã€‚</li><li>å½“**<code>order_count</code><strong>è¾¾åˆ°æˆ–è¶…è¿‡</strong><code>max_orders</code><strong>æ—¶ï¼Œä¸¤ä¸ªAPIçº¿ç¨‹éƒ½ä¼šåœæ­¢è·å–è®¢å•ï¼Œå¹¶é€šè¿‡</strong><code>orders_fetched.set()</code>**æ¥é€šçŸ¥è®¢å•å¤„ç†çº¿ç¨‹å¯ä»¥ç»“æŸäº†ã€‚</li></ol><p>è¿™ä¸ªè®¾è®¡å…è®¸ä¸¤ä¸ªAPIçº¿ç¨‹ä»¥ä¸åŒçš„é¢‘ç‡å·¥ä½œï¼Œæ¨¡æ‹Ÿäº†æ›´ä¸ºå¤æ‚çš„ç°å®åœºæ™¯ï¼Œå…¶ä¸­ä¸åŒçš„æ•°æ®æºå¯èƒ½ä»¥ä¸åŒçš„é€Ÿç‡æä¾›æ•°æ®ã€‚åŒæ—¶ï¼Œå¼•å…¥é”æ˜¯ä¸ºäº†ç¡®ä¿åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œå¯¹å…±äº«èµ„æºï¼ˆ<strong><code>order_count</code></strong>ï¼‰çš„è®¿é—®æ˜¯å®‰å…¨çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenAI-API-ä¸­æ–‡ç‰ˆ</title>
      <link href="/2023/10/18/openai-api/"/>
      <url>/2023/10/18/openai-api/</url>
      
        <content type="html"><![CDATA[<h1 id="openai-api-ä¸­æ–‡ç‰ˆ">OpenAI-API-ä¸­æ–‡ç‰ˆ</h1><h2 id="ä¸€-introduction-ä»‹ç»">ä¸€. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fintroduction">Introduction</a> ä»‹ç»</h2><p>å¦‚æœä½ æƒ³ä½¿ç”¨æˆ‘ä»¬çš„APIï¼Œä½ å¯ä»¥é€šè¿‡ <strong>HTTP</strong> è¯·æ±‚ä»ä»»ä½•è¯­è¨€ä¸ API è¿›è¡Œäº¤äº’ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æˆ‘ä»¬çš„å®˜æ–¹ Python ç»‘å®šã€å®˜æ–¹ Node.jsåº“ æˆ– <strong><a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Flibraries%2Fcommunity-libraries">ç¤¾åŒºç»´æŠ¤çš„åº“</a></strong>ã€‚</p><p>è‹¥è¦å®‰è£…å®˜æ–¹ Python ç»‘å®šï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install openai</span><br></pre></td></tr></table></figure><p>è¦å®‰è£…å®˜æ–¹çš„ Node.js åº“ï¼Œè¯·åœ¨æ‚¨çš„ Node.js é¡¹ç›®ç›®å½•ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install openai</span><br></pre></td></tr></table></figure><h2 id="äºŒ-authentication-è®¤è¯">äºŒ. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fauthentication">Authentication</a> è®¤è¯</h2><h3 id="1-openai-api-key">1. OpenAI-API-KEY</h3><p><strong>OpenAI API</strong> ä½¿ç”¨ APIå¯†é’¥ è¿›è¡Œèº«ä»½éªŒè¯ã€‚è¯·è®¿é—®æ‚¨çš„ <strong><a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Faccount%2Fapi-keys">APIå¯†é’¥</a></strong> é¡µé¢ä»¥æ£€ç´¢æ‚¨åœ¨è¯·æ±‚ä¸­ä½¿ç”¨çš„APIå¯†é’¥ã€‚</p><p><strong>è¯·è®°ä½ï¼Œæ‚¨çš„APIå¯†é’¥æ˜¯æœºå¯†çš„ï¼</strong> ä¸è¦ä¸ä»–äººåˆ†äº«å®ƒæˆ–åœ¨ä»»ä½•å®¢æˆ·ç«¯ä»£ç ï¼ˆæµè§ˆå™¨ã€åº”ç”¨ç¨‹åºï¼‰ä¸­å…¬å¼€å®ƒã€‚ç”Ÿäº§è¯·æ±‚å¿…é¡»é€šè¿‡æ‚¨è‡ªå·±çš„åç«¯æœåŠ¡å™¨è·¯ç”±ï¼Œå…¶ä¸­æ‚¨çš„ APIå¯†é’¥ å¯ä»¥ä»ç¯å¢ƒå˜é‡æˆ–å¯†é’¥ç®¡ç†æœåŠ¡ä¸­å®‰å…¨åŠ è½½ã€‚</p><p>æ‰€æœ‰APIè¯·æ±‚éƒ½åº”åœ¨ <code>Authorization</code> HTTPæ ‡å¤´ä¸­åŒ…å«æ‚¨çš„APIå¯†é’¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ht</span><br><span class="line"># æ³¨æ„Bearer OPENAI_API_KEYï¼ŒBearerçš„åé¢æ˜¯æœ‰ä¸€ä¸ªç©ºæ ¼çš„</span><br><span class="line">Authorization: Bearer OPENAI_API_KEY</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-openai-organization">2. OpenAI-Organization</h3><p><strong>Requesting organization è¯·æ±‚ç»„ç»‡</strong></p><p>å¯¹äºå±äºå¤šä¸ªç»„ç»‡çš„ç”¨æˆ·ï¼Œæ‚¨å¯ä»¥ä¼ é€’ä¸€ä¸ª <strong>è¡¨å¤´</strong> æ¥æŒ‡å®šç”¨äº APIè¯·æ±‚ çš„ç»„ç»‡ã€‚è¿™äº› APIè¯·æ±‚ çš„ä½¿ç”¨å°†è®¡å…¥æŒ‡å®šç»„ç»‡çš„è®¢é˜…é…é¢ã€‚</p><p>ç¤ºä¾‹ <strong>curl</strong> å‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/models \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot; \</span><br><span class="line">  -H &quot;OpenAI-Organization: org-gth0C8mT2wnKealyCkSRrpQk&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <strong>openai PythonåŒ…</strong> çš„ç¤ºä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> openai</span><br><span class="line">openai.organization = <span class="string">&quot;org-gth0C8mT2wnKealyCkSRrpQk&quot;</span>openai.api_key = os.getenv(<span class="string">&quot;OPENAI_API_KEY&quot;</span>)</span><br><span class="line">openai.Model.<span class="built_in">list</span>()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <strong>openai Node.jsåŒ…</strong> çš„ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import &#123; Configuration, OpenAIApi &#125; from &quot;openai&quot;;</span><br><span class="line">const configuration = new Configuration(&#123;</span><br><span class="line">    organization: &quot;org-gth0C8mT2wnKealyCkSRrpQk&quot;,</span><br><span class="line">    apiKey: process.env.OPENAI_API_KEY,</span><br><span class="line">&#125;);</span><br><span class="line">const openai = new OpenAIApi(configuration);</span><br><span class="line">const response = await openai.listEngines();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥åœ¨ <strong><a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Faccount%2Forg-settings">ç»„ç»‡è®¾ç½®</a></strong> é¡µé¢ä¸Šæ‰¾åˆ° <strong>ç»„ç»‡ID</strong></p><h2 id="ä¸‰-making-requests-æå‡ºè¯·æ±‚">ä¸‰. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fmaking-requests">Making requests</a> æå‡ºè¯·æ±‚</h2><p>æ‚¨å¯ä»¥å°†ä¸‹é¢çš„å‘½ä»¤ç²˜è´´åˆ°æ‚¨çš„ç»ˆç«¯ä¸­ï¼Œä»¥è¿è¡Œæ‚¨çš„ç¬¬ä¸€ä¸ª APIè¯·æ±‚ã€‚è¯·ç¡®ä¿å°† <strong>$OPENAI_API_KEY</strong> æ›¿æ¢ä¸ºæ‚¨çš„ <strong>APIå¯†é’¥</strong>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/chat/completions \</span><br><span class="line">  -H &quot;Content-Type: application/json&quot; \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot; \</span><br><span class="line">  -d &#x27;&#123;</span><br><span class="line">     &quot;model&quot;: &quot;gpt-3.5-turbo&quot;,</span><br><span class="line">     &quot;messages&quot;: [&#123;&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Say this is a test!&quot;&#125;],</span><br><span class="line">     &quot;temperature&quot;: 0.7</span><br><span class="line">   &#125;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ­¤è¯·æ±‚æŸ¥è¯¢ <code>gpt-3.5-turboæ¨¡å‹</code>ï¼Œä»¥å®Œæˆä»æç¤ºâ€œSay this is a testâ€å¼€å§‹çš„æ–‡æœ¬ã€‚æ‚¨åº”è¯¥ä¼šæ”¶åˆ°ç±»ä¼¼ä»¥ä¸‹å†…å®¹çš„å“åº”ï¼š</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="string">&quot;id&quot;</span>:<span class="string">&quot;chatcmpl-abc123&quot;</span>,</span><br><span class="line">   <span class="string">&quot;object&quot;</span>:<span class="string">&quot;chat.completion&quot;</span>,</span><br><span class="line">   <span class="string">&quot;created&quot;</span>:<span class="number">1677858242</span>,</span><br><span class="line">   <span class="string">&quot;model&quot;</span>:<span class="string">&quot;gpt-3.5-turbo-0301&quot;</span>,</span><br><span class="line">   <span class="string">&quot;usage&quot;</span>:&#123;</span><br><span class="line">      <span class="string">&quot;prompt_tokens&quot;</span>:<span class="number">13</span>,</span><br><span class="line">      <span class="string">&quot;completion_tokens&quot;</span>:<span class="number">7</span>,</span><br><span class="line">      <span class="string">&quot;total_tokens&quot;</span>:<span class="number">20</span></span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="string">&quot;choices&quot;</span>:[</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">&quot;message&quot;</span>:&#123;</span><br><span class="line">            <span class="string">&quot;role&quot;</span>:<span class="string">&quot;assistant&quot;</span>,</span><br><span class="line">            <span class="string">&quot;content&quot;</span>:<span class="string">&quot;\n\nThis is a test!&quot;</span></span><br><span class="line">         &#125;,</span><br><span class="line">         <span class="string">&quot;finish_reason&quot;</span>:<span class="string">&quot;stop&quot;</span>,</span><br><span class="line">         <span class="string">&quot;index&quot;</span>:<span class="number">0</span></span><br><span class="line">      &#125;</span><br><span class="line">   ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨æ‚¨å·²ç»ç”Ÿæˆäº†ç¬¬ä¸€ä¸ªèŠå¤©å®Œæˆã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ° <code>finish_reason</code> æ˜¯ <code>stop</code>ï¼Œè¿™æ„å‘³ç€APIè¿”å›äº†æ¨¡å‹ç”Ÿæˆçš„å®Œæ•´å®Œæˆã€‚åœ¨ä¸Šé¢çš„è¯·æ±‚ä¸­ï¼Œæˆ‘ä»¬åªç”Ÿæˆäº†ä¸€æ¡æ¶ˆæ¯ï¼Œä½†æ‚¨å¯ä»¥å°† <code>n</code> å‚æ•°è®¾ç½®ä¸ºç”Ÿæˆå¤šä¸ªæ¶ˆæ¯é€‰é¡¹ã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œ<code>gpt-3.5-turbo</code> è¢«ç”¨äºæ›´ä¼ ç»Ÿçš„ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Fcompletion%2Fintroduction">æ–‡æœ¬å®Œæˆä»»åŠ¡</a>ã€‚è¯¥æ¨¡å‹ä¹Ÿé’ˆå¯¹ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Fchat">èŠå¤©åº”ç”¨</a> è¿›è¡Œäº†ä¼˜åŒ–ã€‚</p><h2 id="å››-models-æ¨¡å‹">å››. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fmodels">Models</a> æ¨¡å‹</h2><p>åˆ—å‡ºå¹¶æè¿° API ä¸­å¯ç”¨çš„å„ç§æ¨¡å‹ã€‚æ‚¨å¯ä»¥å‚è€ƒ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fmodels">æ¨¡å‹æ–‡æ¡£</a> ä»¥äº†è§£å¯ç”¨çš„æ¨¡å‹ä»¥åŠå®ƒä»¬ä¹‹é—´çš„å·®å¼‚ã€‚</p><h3 id="1-list-models-åˆ—å‡ºæ¨¡å‹">1. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fmodels%2Flist">List models</a> åˆ—å‡ºæ¨¡å‹</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">GET</span><br><span class="line">https://api.openai.com/v1/models</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åˆ—å‡ºå½“å‰å¯ç”¨çš„æ¨¡å‹ï¼Œå¹¶æä¾›æœ‰å…³æ¯ä¸ªæ¨¡å‹çš„åŸºæœ¬ä¿¡æ¯ï¼Œä¾‹å¦‚æ‰€æœ‰è€…å’Œå¯ç”¨æ€§ã€‚</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/models \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;model-id-0&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;model&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;owned_by&quot;</span><span class="punctuation">:</span> <span class="string">&quot;organization-owner&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;permission&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>...<span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;model-id-1&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;model&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;owned_by&quot;</span><span class="punctuation">:</span> <span class="string">&quot;organization-owner&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;permission&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>...<span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;model-id-2&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;model&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;owned_by&quot;</span><span class="punctuation">:</span> <span class="string">&quot;openai&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;permission&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>...<span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;list&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="2-retrieve-model-æ£€ç´¢æ¨¡å‹">2. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fmodels%2Fretrieve">Retrieve model</a> æ£€ç´¢æ¨¡å‹</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">GET</span><br><span class="line">https://api.openai.com/v1/models/&#123;model&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ£€ç´¢æ¨¡å‹å®ä¾‹ï¼Œæä¾›æœ‰å…³æ¨¡å‹çš„åŸºæœ¬ä¿¡æ¯ï¼Œä¾‹å¦‚æ‰€æœ‰è€…å’Œæƒé™ã€‚</p><p>å…¶ä¸­ï¼Œ<code>model</code> ä¸ºå¿…å¡«çš„å­—ç¬¦ä¸²ç±»å‹ï¼Œç”¨äºæ­¤è¯·æ±‚çš„æ¨¡å‹çš„ IDã€‚</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/models/text-davinci-003 \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text-davinci-003&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;model&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;owned_by&quot;</span><span class="punctuation">:</span> <span class="string">&quot;openai&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;permission&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>...<span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="äº”-completions-å®Œæˆ">äº”. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fcompletions">Completions</a> å®Œæˆ</h2><p>ç»™å®šä¸€ä¸ªæç¤ºï¼Œæ¨¡å‹å°†è¿”å›ä¸€ä¸ªæˆ–å¤šä¸ªé¢„æµ‹çš„å®Œæˆï¼Œå¹¶ä¸”è¿˜å¯ä»¥åœ¨æ¯ä¸ªä½ç½®è¿”å›æ›¿ä»£ä»¤ç‰Œçš„æ¦‚ç‡ã€‚</p><h3 id="1-create-completion">1. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fcompletions%2Fcreate">Create completion</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">POST</span><br><span class="line">https://api.openai.com/v1/completions</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸ºæä¾›çš„æç¤ºå’Œå‚æ•°åˆ›å»ºå®Œæˆã€‚</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/completions \</span><br><span class="line">  -H &quot;Content-Type: application/json&quot; \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot; \</span><br><span class="line">  -d &#x27;&#123;</span><br><span class="line">    &quot;model&quot;: &quot;text-davinci-003&quot;,</span><br><span class="line">    &quot;prompt&quot;: &quot;Say this is a test&quot;,</span><br><span class="line">    &quot;max_tokens&quot;: 7,</span><br><span class="line">    &quot;temperature&quot;: 0</span><br><span class="line">  &#125;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cmpl-uqkvlQyYK7bGYrRHQ0eXlWi7&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text_completion&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;created&quot;</span><span class="punctuation">:</span> <span class="number">1589478378</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text-davinci-003&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;choices&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;\n\nThis is indeed a test&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;logprobs&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;finish_reason&quot;</span><span class="punctuation">:</span> <span class="string">&quot;length&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;usage&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;prompt_tokens&quot;</span><span class="punctuation">:</span> <span class="number">5</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;completion_tokens&quot;</span><span class="punctuation">:</span> <span class="number">7</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;total_tokens&quot;</span><span class="punctuation">:</span> <span class="number">12</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="request-body-å…¥å‚è¯¦è§£">Request body(å…¥å‚è¯¦è§£)</h3><blockquote><p>model ï¼ˆstringï¼Œå¿…å¡«ï¼‰</p><p>è¦ä½¿ç”¨çš„æ¨¡å‹çš„ IDã€‚å¯ä»¥ä½¿ç”¨ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fmodels%2Flist">åˆ—è¡¨æ¨¡å‹API</a>  (GET <a href="https://link.juejin.cn/?target=https%3A%2F%2Fapi.openai.com%2Fv1%2Fmodels">api.openai.com/v1/models</a>) æŸ¥çœ‹æ‰€æœ‰å¯ç”¨æ¨¡å‹ï¼Œæˆ–å‚é˜… <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fmodels%2Foverview">æ¨¡å‹æ¦‚è¿°</a> äº†è§£å®ƒä»¬çš„æè¿°ã€‚</p><ul><li><strong><code>prompt</code> ï¼ˆstring or arrayï¼Œé€‰å¡«ï¼ŒDefaults to &lt;|endoftext|&gt;ï¼‰</strong></li></ul><p>ç”¨äºç”Ÿæˆå®Œæˆã€ç¼–ç ä¸ºå­—ç¬¦ä¸²ã€å­—ç¬¦ä¸²æ•°ç»„ã€æ ‡è®°æ•°ç»„æˆ–æ ‡è®°æ•°ç»„æ•°ç»„çš„æç¤ºã€‚</p><p>æ³¨æ„ |endoftext| æ˜¯æ¨¡å‹åœ¨è®­ç»ƒæœŸé—´çœ‹åˆ°çš„æ–‡æ¡£åˆ†éš”ç¬¦ï¼Œå› æ­¤å¦‚æœæœªæŒ‡å®šæç¤ºï¼Œæ¨¡å‹å°†ç”Ÿæˆï¼Œå°±åƒä»æ–°æ–‡æ¡£çš„å¼€å¤´ä¸€æ ·ã€‚</p><ul><li><strong><code>suffix</code> ï¼ˆstringï¼Œé€‰å¡«ï¼ŒDefaults to nullï¼‰</strong></li></ul><p>å®Œæˆæ’å…¥æ–‡æœ¬åçš„åç¼€ã€‚</p><ul><li><strong><code>max_tokens</code> ï¼ˆintegerï¼Œé€‰å¡«ï¼ŒDefaults to 16ï¼‰</strong></li></ul><p>å®Œæˆæ—¶è¦ç”Ÿæˆçš„æœ€å¤§ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Ftokenizer">token</a> æ•°ã€‚</p><p>æç¤º <code>max_tokens</code> çš„ token è®¡æ•°ä¸èƒ½è¶…è¿‡æ¨¡å‹çš„ä¸Šä¸‹æ–‡é•¿åº¦ã€‚å¤§å¤šæ•°æ¨¡å‹çš„ä¸Šä¸‹æ–‡é•¿åº¦ä¸º 2048 ä¸ªä»¤ç‰Œï¼ˆæœ€æ–°æ¨¡å‹é™¤å¤–ï¼Œå®ƒæ”¯æŒ 4096ï¼‰</p><ul><li><strong><code>temperature</code> ï¼ˆnumberï¼Œé€‰å¡«ï¼ŒDefaults to 1ï¼‰</strong></li></ul><p>ä½¿ç”¨å“ªä¸ªé‡‡æ ·æ¸©åº¦ï¼Œåœ¨ <strong>0å’Œ2ä¹‹é—´</strong>ã€‚</p><p>è¾ƒé«˜çš„å€¼ï¼Œå¦‚0.8ä¼šä½¿è¾“å‡ºæ›´éšæœºï¼Œè€Œè¾ƒä½çš„å€¼ï¼Œå¦‚0.2ä¼šä½¿å…¶æ›´åŠ é›†ä¸­å’Œç¡®å®šæ€§ã€‚</p><p>æˆ‘ä»¬é€šå¸¸å»ºè®®ä¿®æ”¹è¿™ä¸ªï¼ˆ<code>temperature</code> ï¼‰ä¸º <code>top_p</code> ä½†ä¸¤è€…ä¸èƒ½åŒæ—¶å­˜åœ¨ï¼ŒäºŒé€‰ä¸€ã€‚</p><ul><li><strong><code>top_p</code> ï¼ˆnumberï¼Œé€‰å¡«ï¼ŒDefaults to 1ï¼‰</strong></li></ul><p>ä¸€ç§æ›¿ä»£æ¸©åº¦é‡‡æ ·çš„æ–¹æ³•å«åšæ ¸å¿ƒé‡‡æ ·ï¼Œæ¨¡å‹ä¼šè€ƒè™‘åˆ°å…·æœ‰ top_p æ¦‚ç‡è´¨é‡çš„æ ‡è®°ç»“æœã€‚å› æ­¤ï¼Œ0.1 è¡¨ç¤ºåªæœ‰å å‰ 10% æ¦‚ç‡è´¨é‡çš„æ ‡è®°è¢«è€ƒè™‘ã€‚</p><p>æˆ‘ä»¬é€šå¸¸å»ºè®®ä¿®æ”¹è¿™ä¸ªï¼ˆ<code>top_p</code> ï¼‰æˆ–è€… <code>temperature</code>ï¼Œä½†ä¸è¦åŒæ—¶ä¿®æ”¹ä¸¤è€…ã€‚</p><ul><li><strong><code>n</code> ï¼ˆintegerï¼Œé€‰å¡«ï¼ŒDefaults to 1ï¼‰</strong></li></ul><p>æ¯ä¸ª <code>prompt</code> ç”Ÿæˆçš„å®Œæˆæ¬¡æ•°ã€‚</p><p>æ³¨æ„ï¼šç”±äºæ­¤å‚æ•°ä¼šç”Ÿæˆè®¸å¤šå®Œæˆï¼Œå› æ­¤å®ƒä¼šå¿«é€Ÿæ¶ˆè€—æ‚¨çš„ä»¤ç‰Œé…é¢ã€‚å°å¿ƒä½¿ç”¨ï¼Œå¹¶ç¡®ä¿å¯¹ <code>max_tokens</code> å’Œ <code>stop</code> è¿›è¡Œåˆç†çš„è®¾ç½®ã€‚</p><ul><li><strong><code>stream</code> ï¼ˆbooleanï¼Œé€‰å¡«ï¼ŒDefaults to falseï¼‰</strong></li></ul><p>æ˜¯å¦è¿”å›éƒ¨åˆ†è¿›åº¦æµã€‚å¦‚æœè®¾ç½®ï¼Œä»¤ç‰Œå°†ä½œä¸ºæ•°æ®æœåŠ¡å™¨æ¨é€äº‹ä»¶éšç€å®ƒä»¬å˜å¾—å¯ç”¨è€Œå‘é€ï¼Œæµé€šè¿‡ <code>data: [DONE]</code> æ¶ˆæ¯ç»ˆæ­¢ã€‚</p><ul><li><strong><code>logprobs</code> ï¼ˆintegerï¼Œé€‰å¡«ï¼ŒDefaults to nullï¼‰</strong></li></ul><p>åœ¨ <code>logprobs</code> è¿”å›çš„æœ€æœ‰å¯èƒ½çš„æ ‡è®°åˆ—è¡¨ä¸­ï¼ŒåŒ…æ‹¬æ‰€é€‰æ ‡è®°å’Œå¯¹åº”çš„å¯¹æ•°æ¦‚ç‡ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœ <code>logprobs</code> ä¸º 5ï¼Œåˆ™ API å°†è¿”å›ä¸€ä¸ªç”± 5 ä¸ªæœ€æœ‰å¯èƒ½çš„æ ‡è®°ç»„æˆçš„åˆ—è¡¨ã€‚API æ€»æ˜¯ä¼šè¿”å›é‡‡æ ·æ ‡è®°çš„å¯¹æ•°æ¦‚ç‡ï¼Œå› æ­¤å“åº”ä¸­å¯èƒ½ä¼šæœ‰å¤šè¾¾ <code>logprobs+1</code> ä¸ªå…ƒç´ ã€‚</p><p><code>logprobs</code> çš„æœ€å¤§å€¼ä¸º 5ã€‚å¦‚æœæ‚¨éœ€è¦æ›´å¤šï¼Œè¯·é€šè¿‡æˆ‘ä»¬çš„ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fhelp.openai.com%2Fen%2F">å¸®åŠ©ä¸­å¿ƒ</a> è”ç³»æˆ‘ä»¬å¹¶æè¿°æ‚¨çš„ç”¨ä¾‹ã€‚</p><ul><li><strong><code>echo</code> ï¼ˆbooleanï¼Œé€‰å¡«ï¼ŒDefaults to falseï¼‰</strong></li></ul><p>é™¤äº†å®Œæˆä¹‹å¤–ï¼Œè¿˜å›æ˜¾æç¤º</p><ul><li><strong><code>stop</code> ï¼ˆstring or arrayï¼Œé€‰å¡«ï¼ŒDefaults to nullï¼‰</strong></li></ul><p>æœ€å¤šç”Ÿæˆ4ä¸ªåºåˆ—ï¼ŒAPIå°†åœæ­¢ç”Ÿæˆæ›´å¤šçš„æ ‡è®°ã€‚è¿”å›çš„æ–‡æœ¬ä¸åŒ…å«åœæ­¢åºåˆ—ã€‚</p><ul><li><strong><code>presence_penalty</code> ï¼ˆnumberï¼Œé€‰å¡«ï¼ŒDefaults to 0ï¼‰</strong></li></ul><p>ä»‹äº <strong>-2.0 å’Œ 2.0 ä¹‹é—´</strong>çš„æ•°å­—ã€‚æ­£å€¼ä¼šæ ¹æ®å®ƒä»¬æ˜¯å¦å‡ºç°åœ¨æ–‡æœ¬ä¸­è¿„ä»Šä¸ºæ­¢æ¥æƒ©ç½šæ–°ä»¤ç‰Œï¼Œä»è€Œå¢åŠ æ¨¡å‹è°ˆè®ºæ–°ä¸»é¢˜çš„å¯èƒ½æ€§ã€‚</p><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fparameter-details">è¯·å‚é˜…æœ‰å…³é¢‘ç‡å’ŒçŠ¶æ€æƒ©ç½šçš„æ›´å¤šä¿¡æ¯</a></p><ul><li><strong><code>frequency_penalty</code> ï¼ˆnumberï¼Œé€‰å¡«ï¼ŒDefaults to 0ï¼‰</strong></li></ul><p>ä»‹äº-2.0å’Œ2.0ä¹‹é—´çš„æ•°å­—ã€‚æ­£å€¼ä¼šæ ¹æ®æ–‡æœ¬ä¸­æ–°ä»¤ç‰Œçš„ç°æœ‰é¢‘ç‡å¯¹å…¶è¿›è¡Œæƒ©ç½šï¼Œä»è€Œé™ä½æ¨¡å‹é‡å¤ç›¸åŒè¡Œçš„å¯èƒ½æ€§ã€‚</p><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fparameter-details">è¯·å‚é˜…æœ‰å…³é¢‘ç‡å’Œå­˜åœ¨æƒ©ç½šçš„æ›´å¤šä¿¡æ¯</a></p><ul><li><strong><code>best_of</code> ï¼ˆintegerï¼Œé€‰å¡«ï¼ŒDefaults to 1ï¼‰</strong></li></ul><p>åœ¨ç”ŸæˆæœåŠ¡å™¨ç«¯ç”Ÿæˆ <code>best_of</code> å®Œæˆï¼Œå¹¶è¿”å›â€œæœ€ä½³â€ï¼ˆæ¯ä¸ªæ ‡è®°å…·æœ‰æœ€é«˜å¯¹æ•°æ¦‚ç‡çš„é‚£ä¸€ä¸ªï¼‰ã€‚ç»“æœæ— æ³•æµå¼ä¼ è¾“ã€‚</p><p>å½“ä¸ <code>n</code> ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œ<code>best_of</code> æ§åˆ¶å€™é€‰å®Œæˆçš„æ•°é‡ï¼Œ<code>n</code> æŒ‡å®šè¦è¿”å›å¤šå°‘ä¸ª - <code>best_of</code> å¿…é¡»å¤§äº <code>n</code>ã€‚</p><p>æ³¨æ„ï¼šç”±äºæ­¤å‚æ•°ç”Ÿæˆè®¸å¤šå®Œæˆï¼Œå› æ­¤å¯èƒ½ä¼šå¿«é€Ÿæ¶ˆè€—æ‚¨çš„ä»¤ç‰Œé…é¢ã€‚è¯·å°å¿ƒä½¿ç”¨å¹¶ç¡®ä¿ <code>max_tokens</code> å’Œ <code>stop</code> è®¾ç½®åˆç†ã€‚</p><ul><li><strong><code>logit_bias</code> ï¼ˆmapï¼Œé€‰å¡«ï¼ŒDefaults to nullï¼‰</strong></li></ul><p>ä¿®æ”¹æŒ‡å®šæ ‡è®°åœ¨å®Œæˆä¸­å‡ºç°çš„å¯èƒ½æ€§ã€‚</p><p>æ¥å—ä¸€ä¸ªJSONå¯¹è±¡ï¼Œå°†æ ‡è®°ï¼ˆç”±GPTåˆ†è¯å™¨ä¸­çš„æ ‡è®°IDæŒ‡å®šï¼‰æ˜ å°„åˆ°ä» -100 åˆ° 100 çš„ç›¸å…³åå·®å€¼ã€‚æ‚¨å¯ä»¥ä½¿ç”¨æ­¤ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Ftokenizer%3Fview%3Dbpe">åˆ†è¯å™¨å·¥å…·</a>ï¼ˆé€‚ç”¨äºGPT-2å’ŒGPT-3ï¼‰å°†æ–‡æœ¬è½¬æ¢ä¸ºä»¤ç‰ŒIDã€‚æ•°å­¦ä¸Šï¼Œåœ¨é‡‡æ ·ä¹‹å‰ï¼Œæ¨¡å‹ç”Ÿæˆçš„ logits ä¼šæ·»åŠ åå·®ã€‚ç¡®åˆ‡çš„æ•ˆæœå› æ¨¡å‹è€Œå¼‚ï¼Œä½†æ˜¯ä»‹äº-1å’Œ1ä¹‹é—´çš„å€¼åº”è¯¥ä¼šå‡å°‘æˆ–å¢åŠ é€‰æ‹©çš„å¯èƒ½æ€§ï¼›åƒ -100 æˆ– 100 è¿™æ ·çš„å€¼åº”è¯¥ä¼šå¯¼è‡´ç›¸å…³ä»¤ç‰Œè¢«ç¦æ­¢æˆ–ç‹¬å é€‰æ‹©ã€‚</p><p>ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä¼ é€’ <code>&#123;&quot;50256&quot;: -100&#125;</code> æ¥é˜²æ­¢ç”Ÿæˆ</p><ul><li><strong><code>user</code> ï¼ˆstringï¼Œé€‰å¡«ï¼‰</strong></li></ul><p>ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œä»£è¡¨æ‚¨çš„ç»ˆç«¯ç”¨æˆ·ï¼Œå¯ä»¥å¸®åŠ©OpenAIç›‘æµ‹å’Œæ£€æµ‹æ»¥ç”¨ã€‚<a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Fsafety-best-practices%2Fend-user-ids">äº†è§£æ›´å¤šä¿¡æ¯</a>ã€‚</p></blockquote><h2 id="å…­-chat-èŠå¤©">å…­. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fchat">Chat</a> èŠå¤©</h2><p>ç»™å®šä¸€ç»„æè¿°å¯¹è¯çš„æ¶ˆæ¯åˆ—è¡¨ï¼Œæ¨¡å‹å°†è¿”å›ä¸€ä¸ªå›å¤ã€‚</p><h3 id="1-create-chat-completion">1. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fchat%2Fcreate">Create chat completion</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">POST</span><br><span class="line">https://api.openai.com/v1/chat/completions</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸ºç»™å®šçš„èŠå¤©å¯¹è¯åˆ›å»ºæ¨¡å‹å“åº”ã€‚</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/chat/completions \</span><br><span class="line">  -H &quot;Content-Type: application/json&quot; \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot; \</span><br><span class="line">  -d &#x27;&#123;</span><br><span class="line">    &quot;model&quot;: &quot;gpt-3.5-turbo&quot;,</span><br><span class="line">    &quot;messages&quot;: [&#123;&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Hello!&quot;&#125;]</span><br><span class="line">  &#125;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;chatcmpl-123&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;chat.completion&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;created&quot;</span><span class="punctuation">:</span> <span class="number">1677652288</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;choices&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;assistant&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;\n\nHello there, how may I assist you today?&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;finish_reason&quot;</span><span class="punctuation">:</span> <span class="string">&quot;stop&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;usage&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;prompt_tokens&quot;</span><span class="punctuation">:</span> <span class="number">9</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;completion_tokens&quot;</span><span class="punctuation">:</span> <span class="number">12</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;total_tokens&quot;</span><span class="punctuation">:</span> <span class="number">21</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>Request body(å…¥å‚è¯¦è§£)</strong><br>â€¢ <strong><code>model</code> ï¼ˆstringï¼Œå¿…å¡«ï¼‰</strong><br>è¦ä½¿ç”¨çš„æ¨¡å‹IDã€‚æœ‰å…³å“ªäº›æ¨¡å‹é€‚ç”¨äºChat APIçš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fmodels%2Fmodel-endpoint-compatibility">æ¨¡å‹ç«¯ç‚¹å…¼å®¹æ€§è¡¨</a><br>â€¢ <strong><code>messages</code> ï¼ˆarrayï¼Œå¿…å¡«ï¼‰</strong><br>è¿„ä»Šä¸ºæ­¢æè¿°å¯¹è¯çš„æ¶ˆæ¯åˆ—è¡¨<br>â—¦ <strong><code>role</code> ï¼ˆstringï¼Œå¿…å¡«ï¼‰</strong><br>æ­¤æ¶ˆæ¯çš„ä½œè€…è§’è‰²ã€‚<code>system</code> ã€<code>user</code> æˆ– <code>assistant</code> ä¹‹ä¸€<br>â—¦ <strong><code>content</code> ï¼ˆstringï¼Œå¿…å¡«ï¼‰</strong><br>æ¶ˆæ¯çš„å†…å®¹<br>â—¦ <strong><code>name</code> ï¼ˆstringï¼Œé€‰å¡«ï¼‰</strong><br>æ­¤æ¶ˆæ¯çš„ä½œè€…çš„å§“åã€‚å¯ä»¥åŒ…å« a-zã€A-Zã€0-9 å’Œä¸‹åˆ’çº¿ï¼Œæœ€å¤§é•¿åº¦ä¸º 64 ä¸ªå­—ç¬¦<br>â€¢ <strong><code>temperature</code> ï¼ˆnumberï¼Œé€‰å¡«ï¼ŒDefaults to 1ï¼‰</strong><br>ä½¿ç”¨å“ªä¸ªé‡‡æ ·æ¸©åº¦ï¼Œåœ¨ <strong>0å’Œ2ä¹‹é—´</strong>ã€‚<br>è¾ƒé«˜çš„å€¼ï¼Œå¦‚0.8ä¼šä½¿è¾“å‡ºæ›´éšæœºï¼Œè€Œè¾ƒä½çš„å€¼ï¼Œå¦‚0.2ä¼šä½¿å…¶æ›´åŠ é›†ä¸­å’Œç¡®å®šæ€§ã€‚<br>æˆ‘ä»¬é€šå¸¸å»ºè®®ä¿®æ”¹è¿™ä¸ªï¼ˆ<code>temperature</code> ï¼‰ä¸º <code>top_p</code> ä½†ä¸¤è€…ä¸èƒ½åŒæ—¶å­˜åœ¨ï¼ŒäºŒé€‰ä¸€ã€‚<br>â€¢ <strong><code>top_p</code> ï¼ˆnumberï¼Œé€‰å¡«ï¼ŒDefaults to 1ï¼‰</strong><br>ä¸€ç§æ›¿ä»£æ¸©åº¦é‡‡æ ·çš„æ–¹æ³•å«åšæ ¸å¿ƒé‡‡æ ·ï¼Œæ¨¡å‹ä¼šè€ƒè™‘åˆ°å…·æœ‰ top_p æ¦‚ç‡è´¨é‡çš„æ ‡è®°ç»“æœã€‚å› æ­¤ï¼Œ0.1 è¡¨ç¤ºåªæœ‰å å‰ 10% æ¦‚ç‡è´¨é‡çš„æ ‡è®°è¢«è€ƒè™‘ã€‚<br>æˆ‘ä»¬é€šå¸¸å»ºè®®ä¿®æ”¹è¿™ä¸ªï¼ˆ<code>top_p</code> ï¼‰æˆ–è€… <code>temperature</code>ï¼Œä½†ä¸è¦åŒæ—¶ä¿®æ”¹ä¸¤è€…ã€‚<br>â€¢ <strong><code>n</code> ï¼ˆintegerï¼Œé€‰å¡«ï¼ŒDefaults to 1ï¼‰</strong><br>æ¯ä¸ªè¾“å…¥æ¶ˆæ¯è¦ç”Ÿæˆå¤šå°‘èŠå¤©å®Œæˆé€‰é¡¹æ•°<br>â€¢ <strong><code>stream</code> ï¼ˆbooleanï¼Œé€‰å¡«ï¼ŒDefaults to falseï¼‰</strong><br>å¦‚æœè®¾ç½®äº†ï¼Œå°†å‘é€éƒ¨åˆ†æ¶ˆæ¯å¢é‡ï¼Œå°±åƒåœ¨ ChatGPT ä¸­ä¸€æ ·ã€‚ä»¤ç‰Œå°†ä½œä¸ºæ•°æ® <a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FServer-sent_events%2FUsing_server-sent_events%23event_stream_format">æœåŠ¡å™¨æ¨é€äº‹ä»¶</a> éšç€å®ƒä»¬å˜å¾—å¯ç”¨è€Œè¢«å‘é€ï¼Œæµé€šè¿‡ <code>data: [DONE]</code> æ¶ˆæ¯ç»ˆæ­¢ã€‚è¯·å‚é˜…OpenAI Cookbook ä»¥è·å– <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fopenai%2Fopenai-cookbook%2Fblob%2Fmain%2Fexamples%2FHow_to_stream_completions.ipynb">ç¤ºä¾‹ä»£ç </a>ã€‚<br>â€¢ <strong>stop ï¼ˆstring or arrayï¼Œé€‰å¡«ï¼ŒDefaults to nullï¼‰</strong><br>æœ€å¤šç”Ÿæˆ4ä¸ªåºåˆ—ï¼ŒAPIå°†åœæ­¢ç”Ÿæˆæ›´å¤šçš„æ ‡è®°ã€‚<br>â€¢ <strong><code>max_tokens</code> ï¼ˆintegerï¼Œé€‰å¡«ï¼ŒDefaults to infï¼‰</strong><br>åœ¨èŠå¤©å®Œæˆä¸­ç”Ÿæˆçš„æœ€å¤§ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Ftokenizer">tokens</a> æ•°ã€‚<br>è¾“å…¥ä»¤ç‰Œå’Œç”Ÿæˆçš„ä»¤ç‰Œçš„æ€»é•¿åº¦å—æ¨¡å‹ä¸Šä¸‹æ–‡é•¿åº¦çš„é™åˆ¶ã€‚<br>â€¢ <strong><code>presence_penalty</code> ï¼ˆnumberï¼Œé€‰å¡«ï¼ŒDefaults to 0ï¼‰</strong><br>ä»‹äº <strong>-2.0 å’Œ 2.0 ä¹‹é—´</strong>çš„æ•°å­—ã€‚æ­£å€¼ä¼šæ ¹æ®å®ƒä»¬æ˜¯å¦å‡ºç°åœ¨æ–‡æœ¬ä¸­è¿„ä»Šä¸ºæ­¢æ¥æƒ©ç½šæ–°ä»¤ç‰Œï¼Œä»è€Œå¢åŠ æ¨¡å‹è°ˆè®ºæ–°ä¸»é¢˜çš„å¯èƒ½æ€§ã€‚<br><a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fparameter-details">è¯·å‚é˜…æœ‰å…³é¢‘ç‡å’ŒçŠ¶æ€æƒ©ç½šçš„æ›´å¤šä¿¡æ¯</a><br>â€¢ <strong><code>frequency_penalty</code> ï¼ˆnumberï¼Œé€‰å¡«ï¼ŒDefaults to 0ï¼‰</strong><br>ä»‹äº-2.0å’Œ2.0ä¹‹é—´çš„æ•°å­—ã€‚æ­£å€¼ä¼šæ ¹æ®æ–‡æœ¬ä¸­æ–°ä»¤ç‰Œçš„ç°æœ‰é¢‘ç‡å¯¹å…¶è¿›è¡Œæƒ©ç½šï¼Œä»è€Œé™ä½æ¨¡å‹é‡å¤ç›¸åŒè¡Œçš„å¯èƒ½æ€§ã€‚<br><a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fparameter-details">è¯·å‚é˜…æœ‰å…³é¢‘ç‡å’Œå­˜åœ¨æƒ©ç½šçš„æ›´å¤šä¿¡æ¯</a><br>â€¢ <strong><code>logit_bias</code> ï¼ˆmapï¼Œé€‰å¡«ï¼ŒDefaults to nullï¼‰</strong><br>ä¿®æ”¹å®Œæˆæ—¶æŒ‡å®šæ ‡è®°å‡ºç°çš„å¯èƒ½æ€§ã€‚<br>æ¥å—ä¸€ä¸ªJSONå¯¹è±¡ï¼Œå°†æ ‡è®°ï¼ˆç”±åˆ†è¯å™¨ä¸­çš„æ ‡è®°IDæŒ‡å®šï¼‰æ˜ å°„åˆ°ä» -100 åˆ° 100 çš„ç›¸å…³åå·®å€¼ã€‚åœ¨é‡‡æ ·ä¹‹å‰ï¼Œæ¨¡å‹ç”Ÿæˆçš„logitsä¼šåŠ ä¸Šè¿™ä¸ªåå·®ã€‚ç¡®åˆ‡çš„å½±å“å› æ¨¡å‹è€Œå¼‚ï¼Œä½†æ˜¯ -1 åˆ° 1 ä¹‹é—´çš„å€¼åº”è¯¥ä¼šå‡å°‘æˆ–å¢åŠ é€‰æ‹©æ¦‚ç‡ï¼›åƒ -100 æˆ– 100 è¿™æ ·çš„å€¼åº”è¯¥ä¼šå¯¼è‡´ç›¸å…³æ ‡è®°è¢«ç¦æ­¢æˆ–ç‹¬å é€‰æ‹©ã€‚<br>â€¢ <strong><code>user</code> ï¼ˆstringï¼Œé€‰å¡«ï¼‰</strong><br>ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œä»£è¡¨æ‚¨çš„ç»ˆç«¯ç”¨æˆ·ï¼Œå¯ä»¥å¸®åŠ©OpenAIç›‘æµ‹å’Œæ£€æµ‹æ»¥ç”¨ã€‚<a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Fsafety-best-practices%2Fend-user-ids">äº†è§£æ›´å¤šä¿¡æ¯</a>ã€‚</p><h2 id="ä¸ƒ-edits-ç¼–è¾‘">ä¸ƒ. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fedits">Edits</a> ç¼–è¾‘</h2><p>ç»™å®šä¸€ä¸ªæç¤ºå’Œä¸€æ¡æŒ‡ä»¤ï¼Œæ¨¡å‹å°†è¿”å›æç¤ºçš„ç¼–è¾‘ç‰ˆæœ¬ã€‚</p><h3 id="1-create-edit">1. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fedits%2Fcreate">Create edit</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">POST</span><br><span class="line">https://api.openai.com/v1/edits</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸ºæä¾›çš„è¾“å…¥ã€æŒ‡ä»¤å’Œå‚æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ç¼–è¾‘ã€‚</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/edits \</span><br><span class="line">  -H &quot;Content-Type: application/json&quot; \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot; \</span><br><span class="line">  -d &#x27;&#123;</span><br><span class="line">    &quot;model&quot;: &quot;text-davinci-edit-001&quot;,</span><br><span class="line">    &quot;input&quot;: &quot;What day of the wek is it?&quot;,</span><br><span class="line">    &quot;instruction&quot;: &quot;Fix the spelling mistakes&quot;</span><br><span class="line">  &#125;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;edit&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;created&quot;</span><span class="punctuation">:</span> <span class="number">1589478378</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;choices&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;What day of the week is it?&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;usage&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;prompt_tokens&quot;</span><span class="punctuation">:</span> <span class="number">25</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;completion_tokens&quot;</span><span class="punctuation">:</span> <span class="number">32</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;total_tokens&quot;</span><span class="punctuation">:</span> <span class="number">57</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>Request body(å…¥å‚è¯¦è§£)</strong><br>â€¢ <strong><code>model</code> ï¼ˆstringï¼Œå¿…å¡«ï¼‰</strong><br>è¦ä½¿ç”¨çš„æ¨¡å‹IDã€‚æ‚¨å¯ä»¥åœ¨æ­¤ç«¯ç‚¹ä¸­ä½¿ç”¨ <code>text-davinci-edit-001</code> æˆ– <code>code-davinci-edit-001</code> æ¨¡å‹ã€‚<br>â€¢ <strong><code>input</code> ï¼ˆstringï¼Œé€‰å¡«ï¼ŒDefaults to â€˜â€™ï¼‰</strong><br>ç”¨ä½œç¼–è¾‘èµ·ç‚¹çš„è¾“å…¥æ–‡æœ¬ã€‚<br>â€¢ <strong><code>instruction</code> ï¼ˆstringï¼Œå¿…å¡«ï¼‰</strong><br>æŒ‡å¯¼æ¨¡å‹å¦‚ä½•ç¼–è¾‘æç¤ºçš„è¯´æ˜ã€‚<br>â€¢ <strong><code>n</code> ï¼ˆintegerï¼Œé€‰å¡«ï¼ŒDefaults to 1ï¼‰</strong><br>è¾“å…¥å’ŒæŒ‡ä»¤éœ€è¦ç”Ÿæˆå¤šå°‘æ¬¡ç¼–è¾‘ã€‚<br>â€¢ <strong><code>temperature</code> ï¼ˆnumberï¼Œé€‰å¡«ï¼ŒDefaults to 1ï¼‰</strong><br>ä½¿ç”¨å“ªä¸ªé‡‡æ ·æ¸©åº¦ï¼Œåœ¨ <strong>0å’Œ2ä¹‹é—´</strong>ã€‚<br>è¾ƒé«˜çš„å€¼ï¼Œå¦‚0.8ä¼šä½¿è¾“å‡ºæ›´éšæœºï¼Œè€Œè¾ƒä½çš„å€¼ï¼Œå¦‚0.2ä¼šä½¿å…¶æ›´åŠ é›†ä¸­å’Œç¡®å®šæ€§ã€‚<br>æˆ‘ä»¬é€šå¸¸å»ºè®®ä¿®æ”¹è¿™ä¸ªï¼ˆ<code>temperature</code> ï¼‰ä¸º <code>top_p</code> ä½†ä¸¤è€…ä¸èƒ½åŒæ—¶å­˜åœ¨ï¼ŒäºŒé€‰ä¸€ã€‚<br>â€¢ <strong><code>top_p</code> ï¼ˆnumberï¼Œé€‰å¡«ï¼ŒDefaults to 1ï¼‰</strong><br>ä¸€ç§æ›¿ä»£æ¸©åº¦é‡‡æ ·çš„æ–¹æ³•å«åšæ ¸å¿ƒé‡‡æ ·ï¼Œæ¨¡å‹ä¼šè€ƒè™‘åˆ°å…·æœ‰ top_p æ¦‚ç‡è´¨é‡çš„æ ‡è®°ç»“æœã€‚å› æ­¤ï¼Œ0.1 è¡¨ç¤ºåªæœ‰å å‰ 10% æ¦‚ç‡è´¨é‡çš„æ ‡è®°è¢«è€ƒè™‘ã€‚<br>æˆ‘ä»¬é€šå¸¸å»ºè®®ä¿®æ”¹è¿™ä¸ªï¼ˆ<code>top_p</code> ï¼‰æˆ–è€… <code>temperature</code>ï¼Œä½†ä¸è¦åŒæ—¶ä¿®æ”¹ä¸¤è€…ã€‚</p><h2 id="å…«-images-å›¾åƒ">å…«. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fimages">Images</a> å›¾åƒ</h2><p>ç»™å®šä¸€ä¸ªæç¤ºå’Œ/æˆ–è¾“å…¥å›¾åƒï¼Œæ¨¡å‹å°†ç”Ÿæˆä¸€å¼ æ–°çš„å›¾åƒã€‚</p><p>ç›¸å…³æŒ‡å—ï¼š<a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Fimages">å›¾åƒç”Ÿæˆ</a>ã€‚</p><h3 id="1-create-image">1. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fimages%2Fcreate">Create image</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">POST</span><br><span class="line">https://api.openai.com/v1/images/generations</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºåˆ›å»ºå›¾åƒã€‚</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/images/generations \</span><br><span class="line">  -H &quot;Content-Type: application/json&quot; \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot; \</span><br><span class="line">  -d &#x27;&#123;</span><br><span class="line">    &quot;prompt&quot;: &quot;A cute baby sea otter&quot;,</span><br><span class="line">    &quot;n&quot;: 2,</span><br><span class="line">    &quot;size&quot;: &quot;1024x1024&quot;</span><br><span class="line">  &#125;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;created&quot;</span><span class="punctuation">:</span> <span class="number">1589478378</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://...&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://...&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>Request body(å…¥å‚è¯¦è§£)</strong><br>â€¢ <strong><code>prompt</code> ï¼ˆstringï¼Œå¿…å¡«ï¼‰</strong><br>æ‰€éœ€å›¾åƒçš„æ–‡æœ¬æè¿°ã€‚æœ€å¤§é•¿åº¦ä¸º1000ä¸ªå­—ç¬¦ã€‚<br>â€¢ <strong><code>n</code> ï¼ˆintegerï¼Œé€‰å¡«ï¼ŒDefaults to 1ï¼‰</strong><br>è¦ç”Ÿæˆçš„å›¾åƒæ•°é‡ã€‚å¿…é¡»åœ¨1åˆ°10ä¹‹é—´ã€‚<br>â€¢ <strong><code>size</code> ï¼ˆstringï¼Œé€‰å¡«ï¼ŒDefaults to 1024x1024ï¼‰</strong><br>ç”Ÿæˆå›¾åƒçš„å°ºå¯¸ã€‚å¿…é¡»æ˜¯ <code>256x256</code> ã€<code>512x512</code> æˆ– <code>1024x1024</code> ä¹‹ä¸€ã€‚<br>â€¢ <strong><code>response_format</code> ï¼ˆstringï¼Œé€‰å¡«ï¼ŒDefaults to urlï¼‰</strong><br>ç”Ÿæˆçš„å›¾åƒè¿”å›æ ¼å¼ã€‚å¿…é¡»æ˜¯ <code>url</code> æˆ– <code>b64_json</code> ä¹‹ä¸€ã€‚<br>â€¢ <strong><code>user</code> ï¼ˆstringï¼Œé€‰å¡«ï¼‰</strong><br>ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œä»£è¡¨æ‚¨çš„ç»ˆç«¯ç”¨æˆ·ï¼Œå¯ä»¥å¸®åŠ©OpenAIç›‘æµ‹å’Œæ£€æµ‹æ»¥ç”¨ã€‚<a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Fsafety-best-practices%2Fend-user-ids">äº†è§£æ›´å¤šä¿¡æ¯</a>ã€‚</p><p>ä½œè€…ï¼šå¤©æ€ä¹ˆä¸ä¼šå¡Œé“¾æ¥ï¼š<a href="https://juejin.cn/post/7225126264663605309%E6%9D%A5%E6%BA%90%EF%BC%9A%E7%A8%80%E5%9C%9F%E6%8E%98%E9%87%91%E8%91%97%E4%BD%9C%E6%9D%83%E5%BD%92%E4%BD%9C%E8%80%85%E6%89%80%E6%9C%89%E3%80%82%E5%95%86%E4%B8%9A%E8%BD%AC%E8%BD%BD%E8%AF%B7%E8%81%94%E7%B3%BB%E4%BD%9C%E8%80%85%E8%8E%B7%E5%BE%97%E6%8E%88%E6%9D%83%EF%BC%8C%E9%9D%9E%E5%95%86%E4%B8%9A%E8%BD%AC%E8%BD%BD%E8%AF%B7%E6%B3%A8%E6%98%8E%E5%87%BA%E5%A4%84%E3%80%82">https://juejin.cn/post/7225126264663605309æ¥æºï¼šç¨€åœŸæ˜é‡‘è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</a></p><h3 id="2-create-image-edit">2. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fimages%2Fcreate-edit">Create image edit</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">POST</span><br><span class="line">https://api.openai.com/v1/images/edits</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ ¹æ®åŸå§‹å›¾åƒå’Œæç¤ºåˆ›å»ºç¼–è¾‘æˆ–æ‰©å±•çš„å›¾åƒã€‚</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/images/edits \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot; \</span><br><span class="line">  -F image=&quot;@otter.png&quot; \</span><br><span class="line">  -F mask=&quot;@mask.png&quot; \</span><br><span class="line">  -F prompt=&quot;A cute baby sea otter wearing a beret&quot; \</span><br><span class="line">  -F n=2 \</span><br><span class="line">  -F size=&quot;1024x1024&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span>  <span class="attr">&quot;created&quot;</span><span class="punctuation">:</span> <span class="number">1589478378</span><span class="punctuation">,</span>  <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>    <span class="punctuation">&#123;</span>      <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://...&quot;</span>    <span class="punctuation">&#125;</span><span class="punctuation">,</span>    <span class="punctuation">&#123;</span>      <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://...&quot;</span>    <span class="punctuation">&#125;</span>  <span class="punctuation">]</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>Request body(å…¥å‚è¯¦è§£)</strong><br>â€¢ <strong><code>image</code> ï¼ˆstringï¼Œå¿…å¡«ï¼‰</strong><br>è¦ç¼–è¾‘çš„å›¾åƒã€‚å¿…é¡»æ˜¯æœ‰æ•ˆçš„PNGæ–‡ä»¶ï¼Œå°äº4MBä¸”ä¸ºæ­£æ–¹å½¢ã€‚å¦‚æœæœªæä¾›é®ç½©ï¼Œåˆ™å›¾åƒå¿…é¡»å…·æœ‰é€æ˜åº¦ï¼Œè¯¥é€æ˜åº¦å°†ç”¨ä½œé®ç½©ã€‚<br>â€¢ <strong><code>mask</code> ï¼ˆstringï¼Œé€‰å¡«ï¼‰</strong><br>ä¸€ä¸ªé¢å¤–çš„å›¾åƒï¼Œå…¶å®Œå…¨é€æ˜çš„åŒºåŸŸï¼ˆä¾‹å¦‚ alpha å€¼ä¸ºé›¶çš„åŒºåŸŸï¼‰æŒ‡ç¤ºåº”è¯¥ç¼–è¾‘å›¾åƒçš„ä½ç½®ã€‚<code>image</code> å¿…é¡»æ˜¯æœ‰æ•ˆçš„ PNG æ–‡ä»¶ï¼Œå°äº 4MBï¼Œå¹¶ä¸”å…·æœ‰ä¸ <code>image</code> ç›¸åŒçš„å°ºå¯¸ã€‚<br>â€¢ <strong><code>prompt</code> ï¼ˆstringï¼Œå¿…å¡«ï¼‰</strong><br>æ‰€éœ€å›¾åƒçš„æ–‡æœ¬æè¿°ã€‚æœ€å¤§é•¿åº¦ä¸º1000ä¸ªå­—ç¬¦ã€‚<br>â€¢ <strong><code>n</code> ï¼ˆintegerï¼Œé€‰å¡«ï¼ŒDefaults to 1ï¼‰</strong><br>è¦ç”Ÿæˆçš„å›¾åƒæ•°é‡ã€‚å¿…é¡»åœ¨1åˆ°10ä¹‹é—´ã€‚<br>â€¢ <strong><code>size</code> ï¼ˆstringï¼Œé€‰å¡«ï¼ŒDefaults to 1024x1024ï¼‰</strong><br>ç”Ÿæˆå›¾åƒçš„å°ºå¯¸ã€‚å¿…é¡»æ˜¯ <code>256x256</code> ã€<code>512x512</code> æˆ– <code>1024x1024</code> ä¹‹ä¸€ã€‚<br>â€¢ <strong><code>response_format</code> ï¼ˆstringï¼Œé€‰å¡«ï¼ŒDefaults to urlï¼‰</strong><br>ç”Ÿæˆçš„å›¾åƒè¿”å›æ ¼å¼ã€‚å¿…é¡»æ˜¯ <code>url</code> æˆ– <code>b64_json</code> ä¹‹ä¸€ã€‚<br>â€¢ <strong><code>user</code> ï¼ˆstringï¼Œé€‰å¡«ï¼‰</strong><br>ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œä»£è¡¨æ‚¨çš„ç»ˆç«¯ç”¨æˆ·ï¼Œå¯ä»¥å¸®åŠ©OpenAIç›‘æµ‹å’Œæ£€æµ‹æ»¥ç”¨ã€‚<a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Fsafety-best-practices%2Fend-user-ids">äº†è§£æ›´å¤šä¿¡æ¯</a>ã€‚</p><h3 id="3-create-image-variation">3. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fimages%2Fcreate-variation">Create image variation</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">POST</span><br><span class="line">https://api.openai.com/v1/images/variations</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åˆ›å»ºç»™å®šå›¾åƒçš„å˜ä½“ã€‚</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/images/variations \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot; \</span><br><span class="line">  -F image=&quot;@otter.png&quot; \</span><br><span class="line">  -F n=2 \</span><br><span class="line">  -F size=&quot;1024x1024&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">jsonå¤åˆ¶ä»£ç </span><br><span class="line"><span class="punctuation">&#123;</span>  <span class="attr">&quot;created&quot;</span><span class="punctuation">:</span> <span class="number">1589478378</span><span class="punctuation">,</span>  <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>    <span class="punctuation">&#123;</span>      <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://...&quot;</span>    <span class="punctuation">&#125;</span><span class="punctuation">,</span>    <span class="punctuation">&#123;</span>      <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://...&quot;</span>    <span class="punctuation">&#125;</span>  <span class="punctuation">]</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>Request body(å…¥å‚è¯¦è§£)</strong><br>â€¢ <strong><code>image</code> ï¼ˆstringï¼Œå¿…å¡«ï¼‰</strong><br>ç”¨ä½œå˜ä½“åŸºç¡€çš„å›¾åƒã€‚å¿…é¡»æ˜¯æœ‰æ•ˆçš„PNGæ–‡ä»¶ï¼Œå°äº4MBï¼Œå¹¶ä¸”ä¸ºæ­£æ–¹å½¢ã€‚<br>â€¢ <strong><code>n</code> ï¼ˆintegerï¼Œé€‰å¡«ï¼ŒDefaults to 1ï¼‰</strong><br>è¦ç”Ÿæˆçš„å›¾åƒæ•°é‡ã€‚å¿…é¡»åœ¨1åˆ°10ä¹‹é—´ã€‚<br>â€¢ <strong><code>size</code> ï¼ˆstringï¼Œé€‰å¡«ï¼ŒDefaults to 1024x1024ï¼‰</strong><br>ç”Ÿæˆå›¾åƒçš„å°ºå¯¸ã€‚å¿…é¡»æ˜¯ <code>256x256</code> ã€<code>512x512</code> æˆ– <code>1024x1024</code> ä¹‹ä¸€ã€‚<br>â€¢ <strong><code>response_format</code> ï¼ˆstringï¼Œé€‰å¡«ï¼ŒDefaults to urlï¼‰</strong><br>ç”Ÿæˆçš„å›¾åƒè¿”å›æ ¼å¼ã€‚å¿…é¡»æ˜¯ <code>url</code> æˆ– <code>b64_json</code> ä¹‹ä¸€ã€‚<br>â€¢ <strong><code>user</code> ï¼ˆstringï¼Œé€‰å¡«ï¼‰</strong><br>ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œä»£è¡¨æ‚¨çš„ç»ˆç«¯ç”¨æˆ·ï¼Œå¯ä»¥å¸®åŠ©OpenAIç›‘æµ‹å’Œæ£€æµ‹æ»¥ç”¨ã€‚<a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Fsafety-best-practices%2Fend-user-ids">äº†è§£æ›´å¤šä¿¡æ¯</a>ã€‚</p><h2 id="ä¹-embeddings-åµŒå…¥">ä¹. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fembeddings">Embeddings</a> åµŒå…¥</h2><p>è·å¾—ä¸€ä¸ªç»™å®šè¾“å…¥çš„å‘é‡è¡¨ç¤ºï¼Œå¯ä»¥è½»æ¾åœ°è¢«æœºå™¨å­¦ä¹ æ¨¡å‹å’Œç®—æ³•ä½¿ç”¨ã€‚</p><p>ç›¸å…³æŒ‡å—ï¼š<a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Fembeddings">åµŒå…¥</a></p><h3 id="1-create-embeddings">1. <strong><a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fembeddings%2Fcreate">Create embeddings</a></strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">httpå¤åˆ¶ä»£ç </span><br><span class="line">POST</span><br><span class="line">https://api.openai.com/v1/embeddings</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åˆ›å»ºä¸€ä¸ªåµŒå…¥å‘é‡ï¼Œä»£è¡¨è¾“å…¥çš„æ–‡æœ¬ã€‚</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">httpå¤åˆ¶ä»£ç </span><br><span class="line">curl https://api.openai.com/v1/embeddings \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot; \</span><br><span class="line">  -H &quot;Content-Type: application/json&quot; \</span><br><span class="line">  -d &#x27;&#123;</span><br><span class="line">    &quot;input&quot;: &quot;The food was delicious and the waiter...&quot;,</span><br><span class="line">    &quot;model&quot;: &quot;text-embedding-ada-002&quot;</span><br><span class="line">  &#125;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;list&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;embedding&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;embedding&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">0.0023064255</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">-0.009327292</span><span class="punctuation">,</span></span><br><span class="line">        .... (<span class="number">1536</span> floats total for ada<span class="number">-002</span>)</span><br><span class="line">        <span class="number">-0.0028842222</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text-embedding-ada-002&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;usage&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;prompt_tokens&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;total_tokens&quot;</span><span class="punctuation">:</span> <span class="number">8</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>Request body(å…¥å‚è¯¦è§£)</strong><br>â€¢ <strong><code>model</code> ï¼ˆstringï¼Œå¿…å¡«ï¼‰</strong><br>è¦ä½¿ç”¨çš„ <strong>æ¨¡å‹ID</strong>ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fmodels%2Flist">åˆ—å‡ºæ¨¡å‹</a> APIæŸ¥çœ‹æ‰€æœ‰å¯ç”¨æ¨¡å‹ï¼Œæˆ–è€…è¯·å‚é˜…æˆ‘ä»¬çš„ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fmodels%2Foverview">æ¨¡å‹æ¦‚è¿°</a> ä»¥äº†è§£å®ƒä»¬çš„æè¿°ã€‚<br>â€¢ <strong><code>input</code> ï¼ˆstring or arrayï¼Œå¿…å¡«ï¼‰</strong><br>è¾“å…¥æ–‡æœ¬ä»¥è·å–åµŒå…¥ï¼Œç¼–ç ä¸ºå­—ç¬¦ä¸²æˆ–ä»¤ç‰Œæ•°ç»„ã€‚è¦åœ¨å•ä¸ªè¯·æ±‚ä¸­è·å–å¤šä¸ªè¾“å…¥çš„åµŒå…¥ï¼Œè¯·ä¼ é€’å­—ç¬¦ä¸²æ•°ç»„æˆ–ä»¤ç‰Œæ•°ç»„çš„æ•°ç»„ã€‚æ¯ä¸ªè¾“å…¥é•¿åº¦<strong>ä¸å¾—è¶…è¿‡ 8192 ä¸ªæ ‡è®°</strong>ã€‚<br>â€¢ <strong><code>user</code> ï¼ˆstringï¼Œé€‰å¡«ï¼‰</strong><br>ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œä»£è¡¨æ‚¨çš„ç»ˆç«¯ç”¨æˆ·ï¼Œå¯ä»¥å¸®åŠ©OpenAIç›‘æµ‹å’Œæ£€æµ‹æ»¥ç”¨ã€‚<a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Fsafety-best-practices%2Fend-user-ids">äº†è§£æ›´å¤šä¿¡æ¯</a>ã€‚</p><h2 id="å-audio-éŸ³é¢‘">å. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Faudio">Audio</a> éŸ³é¢‘</h2><p>äº†è§£å¦‚ä½•å°†éŸ³é¢‘è½¬æ¢ä¸ºæ–‡æœ¬ã€‚</p><p>ç›¸å…³æŒ‡å—ï¼š<a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Fspeech-to-text">è¯­éŸ³è½¬æ–‡æœ¬</a></p><h3 id="1-create-transcription">1. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Faudio%2Fcreate">Create transcription</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">POST</span><br><span class="line">https://api.openai.com/v1/audio/transcriptions</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å°†éŸ³é¢‘è½¬å½•ä¸ºè¾“å…¥è¯­è¨€ã€‚</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/audio/transcriptions \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot; \</span><br><span class="line">  -H &quot;Content-Type: multipart/form-data&quot; \</span><br><span class="line">  -F file=&quot;@/path/to/file/audio.mp3&quot; \</span><br><span class="line">  -F model=&quot;whisper-1&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">jsonå¤åˆ¶ä»£ç </span><br><span class="line"><span class="punctuation">&#123;</span>  <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Imagine the wildest idea that you&#x27;ve ever had, and you&#x27;re curious about how it might scale to something that&#x27;s a 100, a 1,000 times bigger. This is a place where you can get to do that.&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>Request body(å…¥å‚è¯¦è§£)</strong><br>â€¢ <strong><code>file</code> ï¼ˆstringï¼Œå¿…å¡«ï¼‰</strong><br>è¦è½¬å½•çš„éŸ³é¢‘æ–‡ä»¶ï¼Œæ ¼å¼ä¸ºä»¥ä¸‹ä¹‹ä¸€ï¼šmp3ã€mp4ã€mpegã€mpgaã€m4aã€wav æˆ– webmã€‚<br>â€¢ <strong><code>model</code> ï¼ˆstringï¼Œå¿…å¡«ï¼‰</strong><br>è¦ä½¿ç”¨çš„æ¨¡å‹IDã€‚ç›®å‰ä»…æœ‰ <code>whisper-1</code> å¯ç”¨ã€‚<br>â€¢ <strong><code>prompt</code> ï¼ˆstringï¼Œé€‰å¡«ï¼‰</strong><br>ä¸€ä¸ªå¯é€‰çš„æ–‡æœ¬ï¼Œç”¨äºæŒ‡å¯¼æ¨¡å‹çš„é£æ ¼æˆ–ç»§ç»­ä¹‹å‰çš„éŸ³é¢‘ç‰‡æ®µã€‚ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Fspeech-to-text%2Fprompting">prompt</a> åº”è¯¥ä¸éŸ³é¢‘è¯­è¨€ç›¸åŒ¹é…ã€‚<br>â€¢ <strong><code>response_format</code> ï¼ˆstringï¼Œé€‰å¡«ï¼ŒDefaults to jsonï¼‰</strong><br>è½¬å½•è¾“å‡ºçš„æ ¼å¼ï¼Œå¯é€‰é¡¹åŒ…æ‹¬ï¼šjsonã€æ–‡æœ¬ã€srtã€verbose_jsonæˆ–vttã€‚<br>â€¢ <strong><code>temperature</code> ï¼ˆnumberï¼Œé€‰å¡«ï¼ŒDefaults to 0ï¼‰</strong><br>é‡‡æ ·æ¸©åº¦ä»‹äº0å’Œ1ä¹‹é—´ã€‚è¾ƒé«˜çš„å€¼ï¼ˆå¦‚0.8ï¼‰ä¼šä½¿è¾“å‡ºæ›´éšæœºï¼Œè€Œè¾ƒä½çš„å€¼ï¼ˆå¦‚0.2ï¼‰åˆ™ä¼šä½¿å…¶æ›´åŠ é›†ä¸­å’Œç¡®å®šæ€§ã€‚å¦‚æœè®¾ç½®ä¸º0ï¼Œåˆ™æ¨¡å‹å°†ä½¿ç”¨ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FLog_probability">log probability(å¯¹æ•°æ¦‚ç‡)</a> è‡ªåŠ¨å¢åŠ æ¸©åº¦ï¼Œç›´åˆ°è¾¾åˆ°æŸäº›é˜ˆå€¼ã€‚<br>â€¢ <strong><code>language</code> ï¼ˆstringï¼Œé€‰å¡«ï¼‰</strong><br>è¾“å…¥éŸ³é¢‘çš„è¯­è¨€ã€‚ä»¥ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FList_of_ISO_639-1_codes">ISO-639-1</a> æ ¼å¼æä¾›è¾“å…¥è¯­è¨€å°†æé«˜å‡†ç¡®æ€§å’Œå»¶è¿Ÿã€‚</p><h3 id="2-create-translation">2. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Faudio%2Fcreate">Create translation</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">POST</span><br><span class="line">https://api.openai.com/v1/audio/translations</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å°†éŸ³é¢‘ç¿»è¯‘æˆè‹±è¯­ã€‚</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">httpå¤åˆ¶ä»£ç </span><br><span class="line">curl https://api.openai.com/v1/audio/translations \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot; \</span><br><span class="line">  -H &quot;Content-Type: multipart/form-data&quot; \</span><br><span class="line">  -F file=&quot;@/path/to/file/german.m4a&quot; \</span><br><span class="line">  -F model=&quot;whisper-1&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">jsonå¤åˆ¶ä»£ç </span><br><span class="line"><span class="punctuation">&#123;</span>  <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Hello, my name is Wolfgang and I come from Germany. Where are you heading today?&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>Request body(å…¥å‚è¯¦è§£)</strong><br>â€¢ <code>file</code> ï¼ˆstringï¼Œå¿…å¡«ï¼‰<br>è¦ç¿»è¯‘çš„éŸ³é¢‘æ–‡ä»¶å¿…é¡»æ˜¯ä»¥ä¸‹æ ¼å¼ä¹‹ä¸€ï¼šmp3ã€mp4ã€mpegã€mpgaã€m4aã€wavæˆ–webmã€‚<br>â€¢ <strong><code>model</code> ï¼ˆstringï¼Œå¿…å¡«ï¼‰</strong><br>è¦ä½¿ç”¨çš„æ¨¡å‹IDã€‚ç›®å‰ä»…æœ‰ <code>whisper-1</code> å¯ç”¨ã€‚<br>â€¢ <strong><code>prompt</code> ï¼ˆstringï¼Œé€‰å¡«ï¼‰</strong><br>ä¸€ä¸ªå¯é€‰çš„æ–‡æœ¬ï¼Œç”¨äºæŒ‡å¯¼æ¨¡å‹çš„é£æ ¼æˆ–ç»§ç»­ä¹‹å‰çš„éŸ³é¢‘ç‰‡æ®µã€‚ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Fspeech-to-text%2Fprompting">prompt</a> åº”è¯¥ä¸éŸ³é¢‘è¯­è¨€ç›¸åŒ¹é…ã€‚<br>â€¢ <strong><code>response_format</code> ï¼ˆstringï¼Œé€‰å¡«ï¼ŒDefaults to jsonï¼‰</strong><br>è½¬å½•è¾“å‡ºçš„æ ¼å¼ï¼Œå¯é€‰é¡¹åŒ…æ‹¬ï¼šjsonã€æ–‡æœ¬ã€srtã€verbose_jsonæˆ–vttã€‚<br>â€¢ <strong><code>temperature</code> ï¼ˆnumberï¼Œé€‰å¡«ï¼ŒDefaults to 0ï¼‰</strong><br>é‡‡æ ·æ¸©åº¦ä»‹äº0å’Œ1ä¹‹é—´ã€‚è¾ƒé«˜çš„å€¼ï¼ˆå¦‚0.8ï¼‰ä¼šä½¿è¾“å‡ºæ›´éšæœºï¼Œè€Œè¾ƒä½çš„å€¼ï¼ˆå¦‚0.2ï¼‰åˆ™ä¼šä½¿å…¶æ›´åŠ é›†ä¸­å’Œç¡®å®šæ€§ã€‚å¦‚æœè®¾ç½®ä¸º0ï¼Œåˆ™æ¨¡å‹å°†ä½¿ç”¨ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FLog_probability">log probability(å¯¹æ•°æ¦‚ç‡)</a> è‡ªåŠ¨å¢åŠ æ¸©åº¦ï¼Œç›´åˆ°è¾¾åˆ°æŸäº›é˜ˆå€¼ã€‚</p><h2 id="åä¸€-files-æ–‡ä»¶">åä¸€. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Ffiles">Files</a> æ–‡ä»¶</h2><p><strong>Files</strong> ç”¨äºä¸Šä¼ æ–‡æ¡£ï¼Œå¯ä¸ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Ffine-tunes">Fine-tuning</a> ç­‰åŠŸèƒ½ä¸€èµ·ä½¿ç”¨ã€‚</p><h3 id="1-list-files">1. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Ffiles%2Flist">List files</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">GET</span><br><span class="line">https://api.openai.com/v1/files</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿”å›å±äºç”¨æˆ·ç»„ç»‡çš„æ–‡ä»¶åˆ—è¡¨ã€‚</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/files \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;file-ccdDZrC3iZVNiQVeEA6Z66wf&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;file&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;bytes&quot;</span><span class="punctuation">:</span> <span class="number">175</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1613677385</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;filename&quot;</span><span class="punctuation">:</span> <span class="string">&quot;train.jsonl&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;purpose&quot;</span><span class="punctuation">:</span> <span class="string">&quot;search&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;file-XjGxS3KTG0uNmNOK362iJua3&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;file&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;bytes&quot;</span><span class="punctuation">:</span> <span class="number">140</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1613779121</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;filename&quot;</span><span class="punctuation">:</span> <span class="string">&quot;puppy.jsonl&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;purpose&quot;</span><span class="punctuation">:</span> <span class="string">&quot;search&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;list&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-upload-file">2. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Ffiles%2Fupload">Upload file</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">POST</span><br><span class="line">https://api.openai.com/v1/files</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸Šä¼ åŒ…å«æ–‡æ¡£çš„æ–‡ä»¶ä»¥åœ¨å„ä¸ªç«¯ç‚¹/åŠŸèƒ½ä¹‹é—´ä½¿ç”¨ã€‚ç›®å‰ï¼Œä¸€ä¸ªç»„ç»‡ä¸Šä¼ çš„æ‰€æœ‰æ–‡ä»¶çš„å¤§å°å¯ä»¥é«˜è¾¾1 GBã€‚å¦‚æœæ‚¨éœ€è¦å¢åŠ å­˜å‚¨é™åˆ¶ï¼Œè¯·ä¸æˆ‘ä»¬è”ç³»ã€‚</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/files \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot; \</span><br><span class="line">  -F purpose=&quot;fine-tune&quot; \</span><br><span class="line">  -F file=&quot;@mydata.jsonl&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;file-XjGxS3KTG0uNmNOK362iJua3&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;file&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;bytes&quot;</span><span class="punctuation">:</span> <span class="number">140</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1613779121</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;filename&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mydata.jsonl&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;purpose&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fine-tune&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="none"></h3><p><strong>Request body(å…¥å‚è¯¦è§£)</strong><br>â€¢ <code>file</code> ï¼ˆstringï¼Œå¿…å¡«ï¼‰<br>è¦ä¸Šä¼ çš„ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fjsonlines.readthedocs.io%2Fen%2Flatest%2F">JSON Lines</a> æ–‡ä»¶åã€‚<br>å¦‚æœ <code>purpose</code> è®¾ç½®ä¸º <strong>â€œfine-tuneâ€</strong>ï¼Œåˆ™æ¯è¡Œéƒ½æ˜¯ä¸€ä¸ªJSONè®°å½•ï¼Œå…¶ä¸­åŒ…å«â€œpromptâ€å’Œâ€œcompletionâ€å­—æ®µï¼Œè¡¨ç¤ºæ‚¨çš„ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Ffine-tuning%2Fprepare-training-data">training examples(è®­ç»ƒç¤ºä¾‹)</a>ã€‚<br>â€¢ <code>purpose</code> ï¼ˆstringï¼Œå¿…å¡«ï¼‰<br>ä¸Šä¼ æ–‡æ¡£çš„é¢„æœŸç”¨é€”ã€‚<br>ä½¿ç”¨ <strong>â€œfine-tuneâ€</strong> è¿›è¡Œ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Ffine-tunes">Fine-tuning(å¾®è°ƒ)</a>ã€‚è¿™æ ·å¯ä»¥éªŒè¯ä¸Šä¼ æ–‡ä»¶çš„æ ¼å¼ã€‚</p><h3 id="3-delete-file">3. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Ffiles%2Fdelete">Delete file</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">DELETE</span><br><span class="line">https://api.openai.com/v1/files/&#123;file_id&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åˆ é™¤æ–‡ä»¶ã€‚</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/files/file-XjGxS3KTG0uNmNOK362iJua3 \</span><br><span class="line">  -X DELETE \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ<code>&#123;file_id&#125;</code> ä¸º stringç±»å‹çš„å¿…å¡«é¡¹ï¼Œç”¨äºæ­¤è¯·æ±‚çš„æ–‡ä»¶çš„ ID</p><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">jsonå¤åˆ¶ä»£ç </span><br><span class="line"><span class="punctuation">&#123;</span>  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;file-XjGxS3KTG0uNmNOK362iJua3&quot;</span><span class="punctuation">,</span>  <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;file&quot;</span><span class="punctuation">,</span>  <span class="attr">&quot;deleted&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="4-retrieve-file">4. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Ffiles%2Fretrieve">Retrieve file</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">GET</span><br><span class="line">https://api.openai.com/v1/files/&#123;file_id&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿”å›æœ‰å…³ç‰¹å®šæ–‡ä»¶çš„ä¿¡æ¯ã€‚</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/files/file-XjGxS3KTG0uNmNOK362iJua3 \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ<code>&#123;file_id&#125;</code> ä¸º stringç±»å‹çš„å¿…å¡«é¡¹ï¼Œç”¨äºæ­¤è¯·æ±‚çš„æ–‡ä»¶çš„ ID</p><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">jsonå¤åˆ¶ä»£ç </span><br><span class="line"><span class="punctuation">&#123;</span>  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;file-XjGxS3KTG0uNmNOK362iJua3&quot;</span><span class="punctuation">,</span> </span><br><span class="line">   <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;file&quot;</span><span class="punctuation">,</span>  <span class="attr">&quot;bytes&quot;</span><span class="punctuation">:</span> <span class="number">140</span><span class="punctuation">,</span> </span><br><span class="line">   <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1613779657</span><span class="punctuation">,</span> </span><br><span class="line">   <span class="attr">&quot;filename&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mydata.jsonl&quot;</span><span class="punctuation">,</span> </span><br><span class="line">   <span class="attr">&quot;purpose&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fine-tune&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="5-retrieve-file-content">5. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Ffiles%2Fretrieve-content">Retrieve file content</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">GET</span><br><span class="line">https://api.openai.com/v1/files/&#123;file_id&#125;/content</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/files/file-XjGxS3KTG0uNmNOK362iJua3/content \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot; &gt; file.jsonl</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ<code>&#123;file_id&#125;</code> ä¸º stringç±»å‹çš„å¿…å¡«é¡¹ï¼Œç”¨äºæ­¤è¯·æ±‚çš„æ–‡ä»¶çš„ ID</p><h2 id="åäºŒ-fine-tunes-å¾®è°ƒ">åäºŒ. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Ffine-tunes">Fine-tunes</a> å¾®è°ƒ</h2><p>ç®¡ç†å¾®è°ƒä½œä¸šä»¥å°†æ¨¡å‹å®šåˆ¶ä¸ºæ‚¨çš„ç‰¹å®šè®­ç»ƒæ•°æ®ã€‚</p><p>ç›¸å…³æŒ‡å—ï¼š<a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Ffine-tuning">Fine-tune models(å¾®è°ƒæ¨¡å‹)</a></p><h3 id="1-create-fine-tune">1. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Ffine-tunes%2Fcreate">Create fine-tune</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">httpå¤åˆ¶ä»£ç </span><br><span class="line">POST</span><br><span class="line">https://api.openai.com/v1/fine-tunes</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åˆ›å»ºä¸€ä¸ªå·¥ä½œï¼Œä»ç»™å®šçš„æ•°æ®é›†ä¸­å¾®è°ƒæŒ‡å®šæ¨¡å‹ã€‚</p><p>å“åº”åŒ…æ‹¬å·²å…¥é˜Ÿçš„ä½œä¸šçš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬ ä½œä¸šçŠ¶æ€ å’Œ å®Œæˆåå¾®è°ƒæ¨¡å‹çš„åç§°ã€‚</p><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Ffine-tuning">äº†è§£æœ‰å…³å¾®è°ƒçš„æ›´å¤šä¿¡æ¯</a>ã€‚</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">httpå¤åˆ¶ä»£ç </span><br><span class="line">curl https://api.openai.com/v1/fine-tunes \</span><br><span class="line">  -H &quot;Content-Type: application/json&quot; \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot; \</span><br><span class="line">  -d &#x27;&#123;</span><br><span class="line">    &quot;training_file&quot;: &quot;file-XGinujblHPwGLSztz8cPS8XY&quot;</span><br><span class="line">  &#125;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ft-AF1WoRqd3aJAHsqc9NY7iL8F&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fine-tune&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;curie&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1614807352</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;events&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fine-tune-event&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1614807352</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;level&quot;</span><span class="punctuation">:</span> <span class="string">&quot;info&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Job enqueued. Waiting for jobs ahead to complete. Queue number: 0.&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;fine_tuned_model&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;hyperparams&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;batch_size&quot;</span><span class="punctuation">:</span> <span class="number">4</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;learning_rate_multiplier&quot;</span><span class="punctuation">:</span> <span class="number">0.1</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;n_epochs&quot;</span><span class="punctuation">:</span> <span class="number">4</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;prompt_loss_weight&quot;</span><span class="punctuation">:</span> <span class="number">0.1</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;organization_id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;org-...&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;result_files&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pending&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;validation_files&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;training_files&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;file-XGinujblHPwGLSztz8cPS8XY&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;file&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;bytes&quot;</span><span class="punctuation">:</span> <span class="number">1547276</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1610062281</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;filename&quot;</span><span class="punctuation">:</span> <span class="string">&quot;my-data-train.jsonl&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;purpose&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fine-tune-train&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;updated_at&quot;</span><span class="punctuation">:</span> <span class="number">1614807352</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>Request body(å…¥å‚è¯¦è§£)</strong><br>â€¢ <code>training_file</code> ï¼ˆstringï¼Œå¿…å¡«ï¼‰<br>åŒ…å« <strong>è®­ç»ƒæ•°æ®</strong> çš„å·²ä¸Šä¼ æ–‡ä»¶çš„IDã€‚<br>è¯·å‚é˜… <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Ffiles%2Fupload">upload file</a> ä»¥äº†è§£å¦‚ä½•ä¸Šä¼ æ–‡ä»¶ã€‚<br>æ‚¨çš„æ•°æ®é›†å¿…é¡»æ ¼å¼åŒ–ä¸º <strong>JSONLæ–‡ä»¶</strong>ï¼Œå…¶ä¸­æ¯ä¸ªè®­ç»ƒç¤ºä¾‹éƒ½æ˜¯ä¸€ä¸ªå¸¦æœ‰ â€œpromptâ€ å’Œ â€œcompletionâ€ keys çš„ JSONå¯¹è±¡ã€‚æ­¤å¤–ï¼Œæ‚¨å¿…é¡»ä¸Šä¼ å¸¦æœ‰ <code>fine-tune</code> ç›®çš„çš„æ–‡ä»¶ã€‚<br>æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Ffine-tuning%2Fcreating-training-data">å¾®è°ƒæŒ‡å—</a>ã€‚<br>â€¢ <code>validation_file</code> ï¼ˆstringï¼Œé€‰å¡«ï¼‰<br>åŒ…å« <strong>éªŒè¯æ•°æ®</strong> çš„å·²ä¸Šä¼ æ–‡ä»¶çš„IDã€‚<br>å¦‚æœæ‚¨æä¾›æ­¤æ–‡ä»¶ï¼Œåˆ™æ•°æ®å°†åœ¨å¾®è°ƒæœŸé—´å®šæœŸç”¨äºç”ŸæˆéªŒè¯æŒ‡æ ‡ã€‚è¿™äº›æŒ‡æ ‡å¯ä»¥åœ¨ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Ffine-tuning%2Fanalyzing-your-fine-tuned-model">å¾®è°ƒç»“æœæ–‡ä»¶</a> ä¸­æŸ¥çœ‹ã€‚æ‚¨çš„è®­ç»ƒå’ŒéªŒè¯æ•°æ®åº”è¯¥æ˜¯äº’æ–¥çš„ã€‚<br>æ‚¨çš„æ•°æ®é›†å¿…é¡»æ ¼å¼åŒ–ä¸º <strong>JSONLæ–‡ä»¶</strong>ï¼Œå…¶ä¸­æ¯ä¸ªéªŒè¯ç¤ºä¾‹éƒ½æ˜¯ä¸€ä¸ªå¸¦æœ‰ â€œpromptâ€ å’Œ â€œcompletionâ€ keys çš„ JSONå¯¹è±¡ã€‚æ­¤å¤–ï¼Œæ‚¨å¿…é¡»ä¸Šä¼ å¸¦æœ‰ <code>fine-tune</code> ç›®çš„çš„æ–‡ä»¶ã€‚<br>æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Ffine-tuning%2Fcreating-training-data">å¾®è°ƒæŒ‡å—</a>ã€‚<br>â€¢ <code>model</code> ï¼ˆstringï¼Œé€‰å¡«ï¼ŒDefaults to curieï¼‰<br>è¦å¾®è°ƒçš„åŸºç¡€æ¨¡å‹åç§°ã€‚<br>æ‚¨å¯ä»¥é€‰æ‹©å…¶ä¸­ä¹‹ä¸€ï¼šâ€œadaâ€ã€â€œbabbageâ€ã€â€œcurieâ€ã€â€œdavinciâ€ï¼Œæˆ– 2022å¹´4æœˆ21æ—¥ ååˆ›å»ºçš„ç»è¿‡å¾®è°ƒçš„æ¨¡å‹ã€‚è¦äº†è§£è¿™äº›æ¨¡å‹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜… <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fmodels">Models</a> æ–‡æ¡£ã€‚<br>â€¢ <code>n_epochs</code> ï¼ˆintegerï¼Œé€‰å¡«ï¼ŒDefaults to 4ï¼‰<br>è®­ç»ƒæ¨¡å‹çš„æ—¶æœŸæ•°ã€‚ä¸€ä¸ª epoch æŒ‡çš„æ˜¯å®Œæ•´åœ°éå†ä¸€æ¬¡è®­ç»ƒæ•°æ®é›†<br>â€¢ <code>batch_size</code> ï¼ˆintegerï¼Œé€‰å¡«ï¼ŒDefaults to nullï¼‰<br>ç”¨äºè®­ç»ƒçš„æ‰¹æ¬¡å¤§å°ã€‚æ‰¹æ¬¡å¤§å°æ˜¯ç”¨äºè®­ç»ƒå•ä¸ªå‰å‘å’Œåå‘ä¼ é€’çš„è®­ç»ƒç¤ºä¾‹æ•°é‡ã€‚<br>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰¹é‡å¤§å°å°†åŠ¨æ€é…ç½®ä¸ºè®­ç»ƒé›†ç¤ºä¾‹æ•°é‡çš„çº¦ 0.2ï¼…ï¼Œä¸Šé™ä¸º256ã€‚<br>é€šå¸¸ï¼Œæˆ‘ä»¬å‘ç°è¾ƒå¤§çš„æ‰¹é‡å¤§å°å¯¹äºæ›´å¤§çš„æ•°æ®é›†æ•ˆæœæ›´å¥½ã€‚<br>â€¢ <code>learning_rate_multiplier</code> ï¼ˆnumberï¼Œé€‰å¡«ï¼ŒDefaults to nullï¼‰<br>ç”¨äºè®­ç»ƒçš„å­¦ä¹ ç‡å€å¢å™¨ã€‚å¾®è°ƒå­¦ä¹ ç‡ æ˜¯é¢„è®­ç»ƒæ—¶ä½¿ç”¨çš„ åŸå§‹å­¦ä¹ ç‡ ä¹˜ä»¥ æ­¤å€¼ å¾—åˆ°çš„ã€‚<br>é»˜è®¤æƒ…å†µä¸‹ï¼Œå­¦ä¹ ç‡çš„å€å¢å™¨ä¸º 0.05ã€0.1 æˆ– 0.2ï¼Œå…·ä½“å–å†³äºæœ€ç»ˆ <code>batch_size</code>ï¼ˆè¾ƒå¤§çš„æ‰¹é‡å¤§å°é€šå¸¸ä½¿ç”¨è¾ƒå¤§çš„å­¦ä¹ ç‡æ•ˆæœæ›´å¥½ï¼‰ã€‚æˆ‘ä»¬å»ºè®®å°è¯•åœ¨ 0.02 åˆ° 0.2 èŒƒå›´å†…å®éªŒä¸åŒå€¼ä»¥æ‰¾å‡ºäº§ç”Ÿæœ€ä½³ç»“æœçš„å€¼ã€‚<br>â€¢ <code>prompt_loss_weight</code> ï¼ˆnumberï¼Œé€‰å¡«ï¼ŒDefaults to 0.01ï¼‰<br>ç”¨äºæç¤º tokens æŸå¤±çš„æƒé‡ã€‚è¿™æ§åˆ¶äº†æ¨¡å‹å°è¯•å­¦ä¹ ç”Ÿæˆæç¤ºçš„ç¨‹åº¦ï¼ˆä¸å§‹ç»ˆå…·æœ‰ 1.0 æƒé‡çš„å®Œæˆç›¸æ¯”ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥åœ¨å®Œæˆå¾ˆçŸ­æ—¶ä¸ºè®­ç»ƒæ·»åŠ ç¨³å®šæ•ˆæœã€‚<br>å¦‚æœæç¤ºéå¸¸é•¿ï¼ˆç›¸å¯¹äºå®Œæˆè€Œè¨€ï¼‰ï¼Œé‚£ä¹ˆå‡å°‘æ­¤æƒé‡å¯èƒ½æ˜¯æœ‰æ„ä¹‰çš„ï¼Œä»¥é¿å…è¿‡åº¦ä¼˜å…ˆè€ƒè™‘å­¦ä¹ æç¤ºã€‚<br>â€¢ <code>compute_classification_metrics</code> ï¼ˆbooleanï¼Œé€‰å¡«ï¼ŒDefaults to falseï¼‰<br>å¦‚æœè®¾ç½®äº†ï¼Œæˆ‘ä»¬ä¼šåœ¨æ¯ä¸ª epoch ç»“æŸæ—¶ä½¿ç”¨éªŒè¯é›†è®¡ç®—ç‰¹å®šäºåˆ†ç±»çš„æŒ‡æ ‡ï¼Œä¾‹å¦‚å‡†ç¡®ç‡å’Œ F-1 åˆ†æ•°ã€‚è¿™äº›æŒ‡æ ‡å¯ä»¥åœ¨ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Ffine-tuning%2Fanalyzing-your-fine-tuned-model">ç»“æœæ–‡ä»¶</a> ä¸­æŸ¥çœ‹ã€‚<br>ä¸ºäº†è®¡ç®—åˆ†ç±»æŒ‡æ ‡ï¼Œæ‚¨å¿…é¡»æä¾›ä¸€ä¸ª<code>validation_file(éªŒè¯æ–‡ä»¶)</code>ã€‚æ­¤å¤–ï¼Œå¯¹äºå¤šç±»åˆ†ç±»ï¼Œæ‚¨å¿…é¡»æŒ‡å®š <code>classification_n_classes</code>ï¼›å¯¹äºäºŒå…ƒåˆ†ç±»ï¼Œåˆ™éœ€è¦æŒ‡å®š <code>classification_positive_class</code>ã€‚<br>â€¢ <code>classification_n_classes</code> ï¼ˆintegerï¼Œé€‰å¡«ï¼ŒDefaults to nullï¼‰<br>åˆ†ç±»ä»»åŠ¡ä¸­çš„ç±»åˆ«æ•°é‡ã€‚<br>è¿™ä¸ªå‚æ•°åœ¨å¤šåˆ†ç±»ä»»åŠ¡ä¸­æ˜¯å¿…éœ€çš„ã€‚<br>â€¢ <code>classification_positive_class</code> ï¼ˆstringï¼Œé€‰å¡«ï¼ŒDefaults to nullï¼‰<br>äºŒå…ƒåˆ†ç±»ä¸­çš„æ­£ç±»ã€‚<br>åœ¨è¿›è¡ŒäºŒå…ƒåˆ†ç±»æ—¶ï¼Œéœ€è¦æ­¤å‚æ•°æ¥ç”Ÿæˆç²¾ç¡®åº¦ã€å¬å›ç‡å’Œ F1 æŒ‡æ ‡ã€‚<br>â€¢ <code>classification_betas</code> ï¼ˆarrayï¼Œé€‰å¡«ï¼ŒDefaults to nullï¼‰<br>å¦‚æœæä¾›äº†è¿™ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬ä¼šåœ¨æŒ‡å®šçš„ beta å€¼ä¸Šè®¡ç®— F-betaåˆ†æ•°ã€‚F-betaåˆ†æ•° æ˜¯ F-1åˆ†æ•° çš„ä¸€èˆ¬åŒ–ã€‚è¿™ä»…ç”¨äºäºŒå…ƒåˆ†ç±»ã€‚<br>å½“ beta ä¸º1æ—¶ï¼ˆå³F-1åˆ†æ•°ï¼‰ï¼Œç²¾ç¡®åº¦å’Œå¬å›ç‡è¢«èµ‹äºˆç›¸åŒçš„æƒé‡ã€‚è¾ƒå¤§çš„ beta å€¼æ›´åŠ æ³¨é‡å¬å›ç‡è€Œä¸æ˜¯ç²¾ç¡®åº¦ã€‚è¾ƒå°çš„ beta å€¼æ›´åŠ æ³¨é‡ç²¾ç¡®åº¦è€Œä¸æ˜¯å¬å›ç‡ã€‚<br>â€¢ <code>suffix</code> ï¼ˆstringï¼Œé€‰å¡«ï¼ŒDefaults to nullï¼‰<br>ä¸€ä¸ªé•¿åº¦æœ€å¤šä¸º 40ä¸ªå­—ç¬¦ çš„å­—ç¬¦ä¸²ï¼Œå°†è¢«æ·»åŠ åˆ°æ‚¨çš„ å¾®è°ƒæ¨¡å‹åç§° ä¸­ã€‚<br>ä¾‹å¦‚ï¼Œ<code>suffix</code>  ä¸º â€œcustom-model-nameâ€ ä¼šç”Ÿæˆä¸€ä¸ªæ¨¡å‹åç§°ï¼Œå¦‚ <code>ada:ft-your-org:custom-model-name-2022-02-15-04-21-04</code>ã€‚</p><h3 id="2-list-fine-tunes">2. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Ffine-tunes%2Flist">List fine-tunes</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">GET</span><br><span class="line">https://api.openai.com/v1/fine-tunes</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åˆ—å‡ºç»„ç»‡çš„å¾®è°ƒä½œä¸š</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/fine-tunes \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;list&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ft-AF1WoRqd3aJAHsqc9NY7iL8F&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fine-tune&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;curie&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1614807352</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;fine_tuned_model&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;hyperparams&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> ... <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;organization_id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;org-...&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;result_files&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pending&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;validation_files&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;training_files&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span> ... <span class="punctuation">&#125;</span> <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;updated_at&quot;</span><span class="punctuation">:</span> <span class="number">1614807352</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span> ... <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span> ... <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-retrieve-fine-tune">3. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Ffine-tunes%2Fretrieve">Retrieve fine-tune</a>.</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">GET</span><br><span class="line">https://api.openai.com/v1/fine-tunes/&#123;fine_tune_id&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è·å–æœ‰å…³å¾®è°ƒä½œä¸šçš„ä¿¡æ¯ã€‚</p><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Ffine-tuning">äº†è§£æ›´å¤šå…³äºå¾®è°ƒçš„å†…å®¹</a>ã€‚</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/fine-tunes/ft-AF1WoRqd3aJAHsqc9NY7iL8F \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ<code>fine_tune_id</code> ä¸º stringç±»å‹ çš„å­—ç¬¦ä¸²ï¼Œ<strong>å¿…ä¼ </strong>ï¼›å¾®è°ƒä½œä¸šçš„ ID</p><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ft-AF1WoRqd3aJAHsqc9NY7iL8F&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fine-tune&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;curie&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1614807352</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;events&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fine-tune-event&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1614807352</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;level&quot;</span><span class="punctuation">:</span> <span class="string">&quot;info&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Job enqueued. Waiting for jobs ahead to complete. Queue number: 0.&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fine-tune-event&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1614807356</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;level&quot;</span><span class="punctuation">:</span> <span class="string">&quot;info&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Job started.&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fine-tune-event&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1614807861</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;level&quot;</span><span class="punctuation">:</span> <span class="string">&quot;info&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Uploaded snapshot: curie:ft-acmeco-2021-03-03-21-44-20.&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fine-tune-event&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1614807864</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;level&quot;</span><span class="punctuation">:</span> <span class="string">&quot;info&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Uploaded result files: file-QQm6ZpqdNwAaVC3aSz5sWwLT.&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fine-tune-event&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1614807864</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;level&quot;</span><span class="punctuation">:</span> <span class="string">&quot;info&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Job succeeded.&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;fine_tuned_model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;curie:ft-acmeco-2021-03-03-21-44-20&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;hyperparams&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;batch_size&quot;</span><span class="punctuation">:</span> <span class="number">4</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;learning_rate_multiplier&quot;</span><span class="punctuation">:</span> <span class="number">0.1</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;n_epochs&quot;</span><span class="punctuation">:</span> <span class="number">4</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;prompt_loss_weight&quot;</span><span class="punctuation">:</span> <span class="number">0.1</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;organization_id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;org-...&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;result_files&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;file-QQm6ZpqdNwAaVC3aSz5sWwLT&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;file&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;bytes&quot;</span><span class="punctuation">:</span> <span class="number">81509</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1614807863</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;filename&quot;</span><span class="punctuation">:</span> <span class="string">&quot;compiled_results.csv&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;purpose&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fine-tune-results&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;succeeded&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;validation_files&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;training_files&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;file-XGinujblHPwGLSztz8cPS8XY&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;file&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;bytes&quot;</span><span class="punctuation">:</span> <span class="number">1547276</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1610062281</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;filename&quot;</span><span class="punctuation">:</span> <span class="string">&quot;my-data-train.jsonl&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;purpose&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fine-tune-train&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;updated_at&quot;</span><span class="punctuation">:</span> <span class="number">1614807865</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="4-cancel-fine-tune">4. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Ffine-tunes%2Fcancel">Cancel fine-tune</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">POST</span><br><span class="line">https://api.openai.com/v1/fine-tunes/&#123;fine_tune_id&#125;/cancel</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç«‹å³å–æ¶ˆå¾®è°ƒå·¥ä½œã€‚</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/fine-tunes/ft-AF1WoRqd3aJAHsqc9NY7iL8F/cancel \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ<code>fine_tune_id</code> ä¸º stringç±»å‹ çš„å­—ç¬¦ä¸²ï¼Œ<strong>å¿…ä¼ </strong>ï¼›å¾®è°ƒä½œä¸šçš„ ID</p><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ft-xhrpBbvVUzYGo8oUO1FY4nI7&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fine-tune&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;curie&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1614807770</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;events&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span> ... <span class="punctuation">&#125;</span> <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;fine_tuned_model&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;hyperparams&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> ... <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;organization_id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;org-...&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;result_files&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cancelled&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;validation_files&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;training_files&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;file-XGinujblHPwGLSztz8cPS8XY&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;file&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;bytes&quot;</span><span class="punctuation">:</span> <span class="number">1547276</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1610062281</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;filename&quot;</span><span class="punctuation">:</span> <span class="string">&quot;my-data-train.jsonl&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;purpose&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fine-tune-train&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;updated_at&quot;</span><span class="punctuation">:</span> <span class="number">1614807789</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="5-list-fine-tune-events">5. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Ffine-tunes%2Fevents">List fine-tune events</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">GET</span><br><span class="line">https://api.openai.com/v1/fine-tunes/&#123;fine_tune_id&#125;/events</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è·å–å¾®è°ƒä½œä¸šçš„ç²¾ç»†çŠ¶æ€æ›´æ–°ã€‚</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/fine-tunes/ft-AF1WoRqd3aJAHsqc9NY7iL8F/events \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ<code>fine_tune_id</code> ä¸º stringç±»å‹ çš„å­—ç¬¦ä¸²ï¼Œ<strong>å¿…ä¼ </strong>ï¼›å¾®è°ƒä½œä¸šçš„ IDï¼›</p><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;list&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fine-tune-event&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1614807352</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;level&quot;</span><span class="punctuation">:</span> <span class="string">&quot;info&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Job enqueued. Waiting for jobs ahead to complete. Queue number: 0.&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fine-tune-event&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1614807356</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;level&quot;</span><span class="punctuation">:</span> <span class="string">&quot;info&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Job started.&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fine-tune-event&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1614807861</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;level&quot;</span><span class="punctuation">:</span> <span class="string">&quot;info&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Uploaded snapshot: curie:ft-acmeco-2021-03-03-21-44-20.&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fine-tune-event&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1614807864</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;level&quot;</span><span class="punctuation">:</span> <span class="string">&quot;info&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Uploaded result files: file-QQm6ZpqdNwAaVC3aSz5sWwLT.&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fine-tune-event&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="number">1614807864</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;level&quot;</span><span class="punctuation">:</span> <span class="string">&quot;info&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Job succeeded.&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="query-parameters">Query parameters</h3><blockquote><p><code>stream</code> ï¼ˆbooleanï¼Œé€‰å¡«ï¼ŒDefaults to falseï¼‰</p><p>æ˜¯å¦å¯¹å¾®è°ƒä½œä¸šè¿›è¡Œäº‹ä»¶æµã€‚</p><p>å¦‚æœè®¾ç½®ä¸º trueï¼Œåˆ™äº‹ä»¶å°†ä½œä¸ºæ•°æ® <a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FServer-sent_events%2FUsing_server-sent_events%23event_stream_format">æœåŠ¡å™¨å‘é€çš„äº‹ä»¶</a> éšæ—¶å¯ç”¨ã€‚å½“ä½œä¸šå®Œæˆï¼ˆæˆåŠŸã€å–æ¶ˆæˆ–å¤±è´¥ï¼‰æ—¶ï¼Œæµå°†ä»¥ <code>dataï¼š[DONE]</code> æ¶ˆæ¯ç»ˆæ­¢ã€‚</p><p>å¦‚æœè®¾ç½®ä¸º falseï¼Œåˆ™ä»…è¿”å›åˆ°ç›®å‰ä¸ºæ­¢ç”Ÿæˆçš„äº‹ä»¶ã€‚</p></blockquote><h3 id="6-delete-fine-tune-model">6. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Ffine-tunes%2Fdelete-model">Delete fine-tune model</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">DELETE</span><br><span class="line">https://api.openai.com/v1/models/&#123;model&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åˆ é™¤å¾®è°ƒçš„æ¨¡å‹ã€‚æ‚¨å¿…é¡»åœ¨ç»„ç»‡ä¸­å…·æœ‰æ‰€æœ‰è€…çš„è§’è‰²ã€‚</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/models/curie:ft-acmeco-2021-03-03-21-44-20 \</span><br><span class="line">  -X DELETE \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ<code>model</code> ä¸º stringç±»å‹ çš„å­—ç¬¦ä¸²ï¼Œ<strong>å¿…ä¼ </strong>ï¼›è¦åˆ é™¤çš„æ¨¡å‹</p><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">jsonå¤åˆ¶ä»£ç </span><br><span class="line"><span class="punctuation">&#123;</span>  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;curie:ft-acmeco-2021-03-03-21-44-20&quot;</span><span class="punctuation">,</span>  </span><br><span class="line">   <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;model&quot;</span><span class="punctuation">,</span>  </span><br><span class="line">   <span class="attr">&quot;deleted&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="åä¸‰-moderations-å®¡æ ¸">åä¸‰. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fmoderations">Moderations</a> å®¡æ ¸</h2><p>ç»™å®šä¸€ä¸ªè¾“å…¥æ–‡æœ¬ï¼Œè¾“å‡ºæ¨¡å‹æ˜¯å¦å°†å…¶åˆ†ç±»ä¸ºè¿å OpenAI å†…å®¹æ”¿ç­–ã€‚</p><p>ç›¸å…³æŒ‡å—ï¼š<a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Fmoderation">Moderations</a></p><h3 id="1-create-moderation">1. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fmoderations%2Fcreate">Create moderation</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">POST</span><br><span class="line">https://api.openai.com/v1/moderations</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åˆ†ç±»åˆ¤æ–­æ–‡æœ¬æ˜¯å¦è¿å OpenAI çš„å†…å®¹æ”¿ç­–</p><p>è¯·æ±‚æ¼”ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://api.openai.com/v1/moderations \</span><br><span class="line">  -H &quot;Content-Type: application/json&quot; \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot; \</span><br><span class="line">  -d &#x27;&#123;</span><br><span class="line">    &quot;input&quot;: &quot;I want to kill them.&quot;</span><br><span class="line">  &#125;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å“åº”ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;modr-5MWoLO&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text-moderation-001&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;results&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;categories&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;hate&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;hate/threatening&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;self-harm&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;sexual&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;sexual/minors&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;violence&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;violence/graphic&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;category_scores&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;hate&quot;</span><span class="punctuation">:</span> <span class="number">0.22714105248451233</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;hate/threatening&quot;</span><span class="punctuation">:</span> <span class="number">0.4132447838783264</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;self-harm&quot;</span><span class="punctuation">:</span> <span class="number">0.005232391878962517</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;sexual&quot;</span><span class="punctuation">:</span> <span class="number">0.01407341007143259</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;sexual/minors&quot;</span><span class="punctuation">:</span> <span class="number">0.0038522258400917053</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;violence&quot;</span><span class="punctuation">:</span> <span class="number">0.9223177433013916</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;violence/graphic&quot;</span><span class="punctuation">:</span> <span class="number">0.036865197122097015</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;flagged&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="request-body-å…¥å‚è¯¦è§£">Request body(å…¥å‚è¯¦è§£)</h3><blockquote><p>â€¢ <code>input</code> ï¼ˆstring or arrayï¼Œå¿…å¡«ï¼‰<br>è¦åˆ†ç±»çš„è¾“å…¥æ–‡æœ¬<br>â€¢ <code>model</code> ï¼ˆstringï¼Œé€‰å¡«ï¼ŒDefaults to text-moderation-latestï¼‰<br>æœ‰ä¸¤ä¸ªå†…å®¹å®¡æ ¸æ¨¡å‹å¯ç”¨ï¼š<code>text-moderation-stable</code> å’Œ <code>text-moderation-latest</code>ã€‚<br>é»˜è®¤æƒ…å†µä¸‹ï¼Œä½¿ç”¨çš„æ˜¯ <code>text-moderation-latest</code> æ¨¡å‹ï¼Œè¯¥æ¨¡å‹ä¼šéšç€æ—¶é—´è‡ªåŠ¨å‡çº§ã€‚è¿™ç¡®ä¿æ‚¨å§‹ç»ˆä½¿ç”¨æˆ‘ä»¬æœ€å‡†ç¡®çš„æ¨¡å‹ã€‚å¦‚æœæ‚¨ä½¿ç”¨ <code>text-moderation-stable</code>ï¼Œåˆ™åœ¨æ›´æ–°æ¨¡å‹ä¹‹å‰æˆ‘ä»¬å°†æä¾›é«˜çº§é€šçŸ¥ã€‚<code>text-moderation-stable</code> çš„å‡†ç¡®æ€§å¯èƒ½ç•¥ä½äº <code>text-moderation-latest</code>ã€‚</p></blockquote><h2 id="åäº”-parameter-details-å‚æ•°ç»†èŠ‚">åäº”. <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fparameter-details">Parameter details</a> å‚æ•°ç»†èŠ‚</h2><p><strong>é¢‘ç‡å’Œå­˜åœ¨æƒ©ç½š</strong></p><p>åœ¨ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fcompletions">Completions API</a> ä¸­å‘ç°çš„é¢‘ç‡å’Œå­˜åœ¨æƒ©ç½šå¯ä»¥ç”¨äºå‡å°‘é‡‡æ ·é‡å¤ä»¤ç‰Œåºåˆ—çš„å¯èƒ½æ€§ã€‚å®ƒä»¬é€šè¿‡ç›´æ¥å‘ logitsï¼ˆæœªå½’ä¸€åŒ–çš„å¯¹æ•°æ¦‚ç‡ï¼‰æ·»åŠ è´¡çŒ®æ¥è¿›è¡Œä¿®æ”¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">pythonå¤åˆ¶ä»£ç </span><br><span class="line">mu[j] -&gt; mu[j] - c[j] * alpha_frequency - <span class="built_in">float</span>(c[j] &gt; <span class="number">0</span>) * alpha_presence</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Where:</p><ul><li><code>mu[j]</code> is the logits of the j-th token</li><li><code>c[j]</code> is how often that token was sampled prior to the current position</li><li><code>float(c[j] &gt; 0)</code> is 1 if <code>c[j] &gt; 0</code> and 0 otherwise</li><li><code>alpha_frequency</code> is the frequency penalty coefficient</li><li><code>alpha_presence</code> is the presence penalty coefficient</li></ul><p>æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œå­˜åœ¨æƒ©ç½šæ˜¯ä¸€æ¬¡æ€§çš„åŠ æ³•è´¡çŒ®ï¼Œé€‚ç”¨äºæ‰€æœ‰å·²ç»è¢«é‡‡æ ·è‡³å°‘ä¸€æ¬¡çš„æ ‡è®°ï¼Œå¹¶ä¸”é¢‘ç‡æƒ©ç½šæ˜¯ä¸ç‰¹å®šæ ‡è®°å·²ç»è¢«é‡‡æ ·çš„é¢‘ç‡æˆæ¯”ä¾‹çš„è´¡çŒ®ã€‚</p><p>å¦‚æœç›®çš„åªæ˜¯ç¨å¾®å‡å°‘é‡å¤æ ·æœ¬ï¼Œé‚£ä¹ˆæƒ©ç½šç³»æ•°çš„åˆç†å€¼å¤§çº¦åœ¨ 0.1 åˆ° 1 ä¹‹é—´ã€‚å¦‚æœç›®çš„æ˜¯å¼ºçƒˆæŠ‘åˆ¶é‡å¤ï¼Œåˆ™å¯ä»¥å°†ç³»æ•°å¢åŠ åˆ° 2ï¼Œä½†è¿™å¯èƒ½ä¼šæ˜æ˜¾é™ä½æ ·æœ¬è´¨é‡ã€‚è´Ÿå€¼å¯ç”¨äºå¢åŠ é‡å¤å‡ºç°çš„å¯èƒ½æ€§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
          <category> LLM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬”è®° </tag>
            
            <tag> LLM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸ºLinuxæ–°å¢ç”¨æˆ·</title>
      <link href="/2023/10/10/%E4%B8%BALinux%E6%96%B0%E5%A2%9E%E7%94%A8%E6%88%B7/"/>
      <url>/2023/10/10/%E4%B8%BALinux%E6%96%B0%E5%A2%9E%E7%94%A8%E6%88%B7/</url>
      
        <content type="html"><![CDATA[<p>åˆ›å»ºæ–°ç”¨æˆ·æ‰€ä½¿ç”¨çš„å‘½ä»¤æ˜¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo useradd -r -m -s /bin/bash <span class="built_in">test</span></span><br></pre></td></tr></table></figure><p>å‘½ä»¤æ¥è®¾ç½®æ–°ç”¨æˆ·çš„å¯†ç ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo passwd <span class="built_in">test</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢å‘½ä»¤çš„å‚æ•°æ„ä¹‰å¦‚ä¸‹ï¼š</p><ul><li>rï¼šå»ºç«‹ç³»ç»Ÿè´¦å·</li><li>mï¼šè‡ªåŠ¨å»ºç«‹ç”¨æˆ·çš„ç™»å…¥ç›®å½•</li><li>sï¼šæŒ‡å®šç”¨æˆ·ç™»å…¥åæ‰€ä½¿ç”¨çš„shell</li></ul><p>è¾“å…¥ls /home/å¯ä»¥çœ‹åˆ°ç”¨æˆ·ç›®å½•è¢«æˆåŠŸåˆ›å»ºäº†</p><p>ç„¶åéœ€è¦ç™»é™†æ–°ç”¨æˆ·,ä¸ºæ–°ç”¨æˆ·åˆ›å»ºå¯†é’¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su <span class="built_in">test</span></span><br><span class="line">[<span class="built_in">test</span>@host ~]$ ssh-keyge</span><br></pre></td></tr></table></figure><p>åœ¨ å½“å‰ ç”¨æˆ·çš„å®¶ç›®å½•ä¸­ç”Ÿæˆäº†ä¸€ä¸ª .ssh çš„éšè—ç›®å½•ï¼Œå†…å«ä¸¤ä¸ªå¯†é’¥æ–‡ä»¶ã€‚id_rsa ä¸ºç§é’¥ï¼Œid_rsa.pub ä¸ºå…¬é’¥ã€‚<br>ä¸ºäº†ç¡®ä¿è¿æ¥æˆåŠŸï¼Œè¦ä¿è¯ä»¥ä¸‹æ–‡ä»¶æƒé™æ­£ç¡®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="built_in">test</span>@host ~]$ <span class="built_in">cd</span> .ssh</span><br><span class="line">[<span class="built_in">test</span>@host .ssh]$ <span class="built_in">cat</span> id_rsa.pub &gt;&gt; authorized_keys</span><br></pre></td></tr></table></figure><p>åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…å…¬é’¥<br>é”®å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œåœ¨æœåŠ¡å™¨ä¸Šå®‰è£…å…¬é’¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">su root</span><br><span class="line">[root@host .ssh]$ <span class="built_in">chmod</span> 600 authorized_keys</span><br><span class="line">[root@host .ssh]$ <span class="built_in">chmod</span> 700 ~/.ssh</span><br></pre></td></tr></table></figure><p>å°†ç§é’¥id_rsaä¸‹è½½åˆ°æœ¬åœ°ï¼Œå¯ä»¥é€šè¿‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> /home/test/.ssh/id_rsa /home/test/id_rsa</span><br></pre></td></tr></table></figure><p>ç„¶åå°†å¯†é’¥ä¸‹è½½åˆ°æœ¬åœ°</p><p>ä¸ºæ–°å»ºçš„ç”¨æˆ·æ·»åŠ rootæƒé™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/sudoers</span><br></pre></td></tr></table></figure><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹/etc/sudoers</span></span><br><span class="line"><span class="comment"># æ–°å¢ï¼š</span></span><br><span class="line"><span class="comment">## Allow root to run any commands anywhere</span></span><br><span class="line">root    <span class="variable constant_">ALL</span>=(<span class="variable constant_">ALL</span>)       <span class="variable constant_">ALL</span></span><br><span class="line">test    <span class="variable constant_">ALL</span>=(<span class="variable constant_">ALL</span>)       <span class="variable constant_">ALL</span></span><br><span class="line"><span class="comment"># é€€å‡ºæ—¶ï¼Œéœ€è¦å¼ºåˆ¶ä¿å­˜ï¼Œå› ä¸ºè¯¥æ–‡ä»¶æ˜¯åªè¯»çš„</span></span><br><span class="line"><span class="symbol">:wq!</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•™ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Fine Turn BLIP2</title>
      <link href="/2023/08/22/Fine-Turn-BLIP2/"/>
      <url>/2023/08/22/Fine-Turn-BLIP2/</url>
      
        <content type="html"><![CDATA[<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!pip install -q datasets</span><br></pre></td></tr></table></figure><pre><code>[1m[[0m[34;49mnotice[0m[1;39;49m][0m[39;49m A new release of pip is available: [0m[31;49m23.1.1[0m[39;49m -&gt; [0m[32;49m23.2.1[0m[1m[[0m[34;49mnotice[0m[1;39;49m][0m[39;49m To update, run: [0m[32;49mpip install --upgrade pip[0m</code></pre><p>æ•™ç¨‹ç½‘å€ï¼š<br>Fine-tune BLIP using Hugging Face transformers and datasets ğŸ¤—<br><a href="https://colab.research.google.com/drive/1lbqiSiA0sDF7JDWPeS0tccrM85LloVha?usp=sharing">https://colab.research.google.com/drive/1lbqiSiA0sDF7JDWPeS0tccrM85LloVha?usp=sharing</a></p><p>è®¨è®ºåŒºï¼š<br><a href="https://github.com/salesforce/BLIP/issues/37">https://github.com/salesforce/BLIP/issues/37</a></p><p>æ•°æ®é›†åˆ¶ä½œæ–¹æ³•ï¼š<br><a href="https://colab.research.google.com/drive/1HLxgrG7xZJ9FvXckNG61J72FkyrbqKAA?usp=sharing">https://colab.research.google.com/drive/1HLxgrG7xZJ9FvXckNG61J72FkyrbqKAA?usp=sharing</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">root = <span class="string">&quot;image_in_rainly_river/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> datasets <span class="keyword">import</span> load_dataset </span><br></pre></td></tr></table></figure><pre><code>/home/huyifan/anaconda3/envs/yolov5/lib/python3.8/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html  from .autonotebook import tqdm as notebook_tqdm</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dataset = load_dataset(<span class="string">&quot;imagefolder&quot;</span>,data_dir=root,split=<span class="string">&quot;train&quot;</span>)</span><br></pre></td></tr></table></figure><pre><code>Resolving data files: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 171/171 [00:00&lt;00:00, 201524.58it/s]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dataset</span><br></pre></td></tr></table></figure><pre><code>Dataset(&#123;    features: ['image', 'caption'],    num_rows: 170&#125;)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">example = dataset[<span class="number">0</span>]</span><br><span class="line">image = example[<span class="string">&quot;image&quot;</span>]</span><br><span class="line">width, height = image.size</span><br><span class="line">display(image.resize((<span class="built_in">int</span>(<span class="number">0.3</span>*width), <span class="built_in">int</span>(<span class="number">0.3</span>*height))))</span><br></pre></td></tr></table></figure><p><img src="https://picture.fanfer.top/Test_pics/IMG_5022.JPG" alt="png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">example[<span class="string">&quot;caption&quot;</span>]</span><br></pre></td></tr></table></figure><pre><code>'a narrow river in the city with buildings on both sides'</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> Dataset</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ImageCaptioningDataset</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, dataset, processor</span>):</span><br><span class="line">        self.dataset = dataset</span><br><span class="line">        self.processor = processor</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.dataset)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, idx</span>):</span><br><span class="line">        item = self.dataset[idx]</span><br><span class="line"></span><br><span class="line">        encoding = self.processor(images=item[<span class="string">&quot;image&quot;</span>], text=item[<span class="string">&quot;caption&quot;</span>], padding=<span class="string">&quot;max_length&quot;</span>,return_tensors=<span class="string">&quot;pt&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># remove batch dimension</span></span><br><span class="line">        encoding = &#123;k:v.squeeze() <span class="keyword">for</span> k,v <span class="keyword">in</span> encoding.items()&#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> encoding</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> Blip2Processor, Blip2ForConditionalGeneration</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">processor = Blip2Processor.from_pretrained(<span class="string">&quot;Salesforce/blip2-opt-2.7b&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model = Blip2ForConditionalGeneration.from_pretrained(<span class="string">&quot;Salesforce/blip2-opt-2.7b&quot;</span>)</span><br></pre></td></tr></table></figure><pre><code>Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:14&lt;00:00,  7.09s/it]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train_dataset = ImageCaptioningDataset(dataset, processor)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"></span><br><span class="line">train_dataloader = DataLoader(train_dataset, shuffle=<span class="literal">True</span>, batch_size=<span class="number">1</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"></span><br><span class="line">optimizer = torch.optim.AdamW(model.parameters(), lr=<span class="number">5e-5</span>)</span><br><span class="line">device = <span class="string">&quot;cuda&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span></span><br><span class="line">model.to(device)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">model.train()</span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;Epoch:&quot;</span>, epoch)</span><br><span class="line">  <span class="keyword">for</span> idx, batch <span class="keyword">in</span> <span class="built_in">enumerate</span>(train_dataloader):</span><br><span class="line">    input_ids = batch.pop(<span class="string">&quot;input_ids&quot;</span>).to(device)</span><br><span class="line">    pixel_values = batch.pop(<span class="string">&quot;pixel_values&quot;</span>).to(device)</span><br><span class="line"></span><br><span class="line">    outputs = model(input_ids=input_ids,</span><br><span class="line">                    pixel_values=pixel_values,</span><br><span class="line">                    labels=input_ids)</span><br><span class="line">    </span><br><span class="line">    loss = outputs.loss</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Loss:&quot;</span>, loss.item())</span><br><span class="line"></span><br><span class="line">    loss.backward()</span><br><span class="line"></span><br><span class="line">    optimizer.step()</span><br><span class="line">    optimizer.zero_grad()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•™ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mac è¿æ¥é…ç½®å¤šä¸ªGithubè´¦å·</title>
      <link href="/2023/08/21/mac-%E8%BF%9E%E6%8E%A5%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AAGithub%E8%B4%A6%E5%8F%B7/"/>
      <url>/2023/08/21/mac-%E8%BF%9E%E6%8E%A5%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AAGithub%E8%B4%A6%E5%8F%B7/</url>
      
        <content type="html"><![CDATA[<h3 id="1-ç”Ÿæˆå¤šä¸ªsshå¯†é’¥">1. ç”Ÿæˆå¤šä¸ªSSHå¯†é’¥:</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#bash# å°†emailä¿®æ”¹ä¸ºä½ çš„ç¬¬ä¸€è´¦æˆ·çš„emailï¼Œå»ºè®®ä¸ºå¸¸ç”¨çš„è´¦å·</span></span><br><span class="line">ssh-keygen -q -t rsa -C <span class="string">&quot;your_email_1@example.com&quot;</span> -f ~/.ssh/id_rsa_github_1 --N <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="comment"># å°†emailä¿®æ”¹ä¸ºä½ çš„ç¬¬äºŒè´¦æˆ·çš„email</span></span><br><span class="line">ssh-keygen -q -t rsa -C <span class="string">&quot;your_email_2@example.com&quot;</span> -f ~/.ssh/id_rsa_github_2 -N <span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>ä¸Šè¿°å‘½ä»¤å°†å°†ä¼šç”Ÿæˆä¸¤ä¸ªSSHå¯†é’¥å¯¹<code>id_rsa_github_1</code>å’Œ<code>id_rsa_github_2</code>,åˆ†åˆ«å¯¹åº”ä¸¤ä¸ªGitHubè´¦å·ã€‚</p><h3 id="2-æ·»åŠ sshå¯†é’¥åˆ°githubè´¦å·">2. æ·»åŠ SSHå¯†é’¥åˆ°GitHubè´¦å·:</h3><p>åˆ†åˆ«å°†<code>id_rsa_github_1.pub</code>å’Œ<code>id_rsa_github_2.pub</code>æ–‡ä»¶çš„å†…å®¹æ·»åŠ åˆ°å¯¹åº”çš„GitHubè´¦å·çš„SSH Keysè®¾ç½®é¡µé¢ï¼Œæ³¨æ„åˆ«æåäº†å“¦ï¼</p><p>å¯ä»¥ç”¨ä»¥ä¸‹å‘½ä»¤å°†æ–‡ä»¶å†…å®¹è¯»å–åˆ°å‰ªè´´æ¿ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#bash</span></span><br><span class="line">pbcopy &lt; id_rsa_github_1.pub</span><br><span class="line">pbcopy &lt; id_rsa_github_2.pub</span><br></pre></td></tr></table></figure><h3 id="3-é…ç½®ssh-configæ–‡ä»¶">3. é…ç½®SSH configæ–‡ä»¶:</h3><p>åœ¨<code>~/.ssh/</code>ç›®å½•ä¸‹åˆ›å»º<code>config</code>æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> ~/.ssh/config</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨æ–‡ä»¶ä¸­è¾“å…¥ä»¥ä¸‹å†…å®¹å¹¶ä¿å­˜ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Host github.com</span><br><span class="line">HostName github.com</span><br><span class="line">IdentityFile ~/.ssh/id_rsa_github_1</span><br><span class="line">PreferredAuthentications publickey</span><br><span class="line"></span><br><span class="line">Host github_2.com </span><br><span class="line">HostName github.com</span><br><span class="line">IdentityFile ~/.ssh/id_rsa_github_2</span><br><span class="line">PreferredAuthentications publickey</span><br></pre></td></tr></table></figure><p>è¿™ä¼šå°†github.comå¯¹åº”åˆ°ç¬¬ä¸€ä¸ªGitHubè´¦å·,github_2.comå¯¹åº”åˆ°ç¬¬äºŒä¸ªGitHubè´¦å·ã€‚</p><p><strong>macå¿«æ·é”®comman+shift+.å¯ä»¥æŸ¥çœ‹éšè—æ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä¸å¯¹æ—¶å¯ä»¥ä¿®æ”¹.sshæ–‡ä»¶å¤¹ä¸‹çš„configæ›´æ”¹git@githubçš„å†…å®¹æ¥é‡æ–°é€‰æ‹©è´¦å·</strong></p><h3 id="4-æŠŠä¸“ç”¨å¯†é’¥æ·»åŠ åˆ°é«˜é€Ÿç¼“å­˜ä¸­">4. æŠŠä¸“ç”¨å¯†é’¥æ·»åŠ åˆ°é«˜é€Ÿç¼“å­˜ä¸­</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#bash</span></span><br><span class="line">ssh-add --apple-use-keychain ~/.ssh/id_rsa_github_1</span><br><span class="line">ssh-add --apple-use-keychain ~/.ssh/id_rsa_github_2</span><br></pre></td></tr></table></figure><h3 id="5-æµ‹è¯•sshè¿æ¥">5. æµ‹è¯•SSHè¿æ¥:</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">*<span class="comment">#bash*</span></span><br><span class="line">ssh -T git@github.com</span><br><span class="line">ssh -T git@github_2.com</span><br></pre></td></tr></table></figure><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œä½ ä¼šå¾—åˆ°å¦‚ä¸‹æ¶ˆæ¯:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hi xxx! You<span class="string">&#x27;ve successfully authenticated, but GitHub does not provide shell access.</span></span><br></pre></td></tr></table></figure><p>å¦‚æœéƒ½å¯ä»¥æˆåŠŸç™»å½•,åˆ™SSHè¿æ¥é…ç½®æˆåŠŸã€‚</p><h3 id="6-æ¸…é™¤global-configé…ç½®">6. æ¸…é™¤global configé…ç½®</h3><p>å¯ä»¥ç”¨<code>git config -l</code>Â æŸ¥çœ‹æ˜¯å¦é…ç½®è¿‡<code>user.name</code>,Â <code>user.email</code>ï¼Œå¦‚æœé…ç½®è¿‡ï¼Œåˆ™ç”¨ä»¥ä¸‹å‘½ä»¤unset:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global --<span class="built_in">unset</span> user.name </span><br><span class="line">git config --global --<span class="built_in">unset</span> user.email</span><br></pre></td></tr></table></figure><h3 id="7-æ­å–œ">7.æ­å–œï¼ï¼ï¼ï¼</h3><blockquote><p>ä½¿ç”¨æ–¹æ³•ï¼šæ³¨æ„ï¼Œåœ¨å…‹éš†ä»“åº“æ—¶ç”¨ä¸ç”¨è´¦æˆ·è¦ä½¿ç”¨å¯¹åº”çš„Host.</p></blockquote><p>å½“å…‹éš†ç¬¬ä¸€ä¸ªGitHubè´¦å·çš„ä»“åº“æ—¶,ä½¿ç”¨git@github.com:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*<span class="comment">#bash*</span></span><br><span class="line">git <span class="built_in">clone</span> git@github.com:username/repo.git</span><br></pre></td></tr></table></figure><p>å½“å…‹éš†ç¬¬äºŒä¸ªGitHubè´¦å·çš„ä»“åº“æ—¶,ä½¿ç”¨git@github_2.com:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*<span class="comment">#bash* </span></span><br><span class="line">git <span class="built_in">clone</span> git@github_2.com:username/repo.git</span><br></pre></td></tr></table></figure><p>è¿™ä¼šè‡ªåŠ¨ä½¿ç”¨å¯¹åº”çš„SSHå¯†é’¥ä¸GitHubè´¦å·è¿æ¥ã€‚</p><p>æ‹‰å–æˆåŠŸåï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œä½ å¯ä»¥åœ¨<code>cd</code>åˆ°å¯¹åº”çš„ä»“åº“ç›®å½•ä¸‹ï¼Œç”¨ä¸‹è¿°å‘½ä»¤é…ç½®<code>user.name</code>å’Œ<code>user.email</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --<span class="built_in">local</span> user.name <span class="string">&quot;youname&quot;</span></span><br><span class="line">git config --<span class="built_in">local</span> user.email <span class="string">&quot;youemail@xx.com&quot;</span></span><br></pre></td></tr></table></figure><p>æŒ‰ç…§è¿™äº›æ­¥éª¤,å¯ä»¥åœ¨ä¸€å°Macä¸Šé…ç½®ä»»æ„å¤šä¸ªGitHubè´¦å·,å¹¶å¯ä»¥æ–¹ä¾¿åœ°ä¸ä¹‹äº¤äº’ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•™ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HuggingFace Accelerate</title>
      <link href="/2023/08/21/HuggingFace-Accelerate/"/>
      <url>/2023/08/21/HuggingFace-Accelerate/</url>
      
        <content type="html"><![CDATA[<h2 id="ä½¿ç”¨-ğŸ¤—-accelerate-è¿›è¡Œåˆ†å¸ƒå¼è®­ç»ƒ"><strong><strong>ä½¿ç”¨ ğŸ¤— Accelerate è¿›è¡Œåˆ†å¸ƒå¼è®­ç»ƒ</strong></strong></h2><p>éšç€æ¨¡å‹å˜å¾—è¶Šæ¥è¶Šå¤§ï¼Œå¹¶è¡Œè®­ç»ƒå·²ç»æˆä¸ºåœ¨æœ‰é™çš„ç¡¬ä»¶ä¸Šè®­ç»ƒæ›´å¤§æ¨¡å‹ï¼Œå¹¶å°†è®­ç»ƒé€Ÿåº¦æé«˜å‡ ä¸ªæ•°é‡çº§çš„å¿…å¤‡ç­–ç•¥ã€‚Hugging Face åˆ›å»ºäº†**<a href="https://huggingface.co/docs/accelerate">ğŸ¤— Accelerate</a>**åº“ï¼Œåœ¨ä»»ä½•ç±»å‹çš„åˆ†å¸ƒå¼è®¾ç½®ä¸Šè½»æ¾è®­ç»ƒ ğŸ¤— Transformers æ¨¡å‹ï¼Œæ— è®ºæ˜¯ä¸€å°æœºå™¨ä¸Šçš„å¤šä¸ª GPU è¿˜æ˜¯è·¨å¤šå°æœºå™¨çš„å¤šä¸ª GPUã€‚</p><p>æœ¬æ–‡å…³äºå¦‚ä½•è‡ªå®šä¹‰ PyTorch è®­ç»ƒå¾ªç¯ä»¥åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­å¯ç”¨è®­ç»ƒã€‚</p><h2 id="setup"><strong>Setup</strong></h2><p>é¦–å…ˆå®‰è£…ä¸‹è½½åˆ†å¸ƒå¼è®­ç»ƒåº“ <strong>ğŸ¤— Accelerate</strong> å¹¶å¯¼å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">!pip install accelerate</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> accelerate <span class="keyword">import</span> Accelerator</span><br><span class="line"></span><br><span class="line">accelerator = Accelerator()</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ éœ€è¦è‡ªå·±æ‰‹åŠ¨çš„åˆ†é…æ¯å—GPUçš„å†…å­˜ï¼Œé‚£ä¹ˆåœ¨åˆå§‹åŒ–çš„æ—¶å€™éœ€è¦ä¼ é€’å‚æ•°<code>device_placement=False</code></p><p>ç„¶åå°†æ‰€æœ‰çš„è®­ç»ƒç›¸å…³çš„å¯¹è±¡ä¼ é€’ç»™prepareå‡½æ•°ï¼ŒåŒ…æ‹¬ç”¨äºè®­ç»ƒå’Œç”¨äºæ¨¡å‹è¯„ä¼°çš„Dataloaderã€modelå’Œoptimizer</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">train_dataloader, eval_dataloader, model, optimizer = accelerator.prepare(</span><br><span class="line">    train_dataloader, eval_dataloader, model, optimizer</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>è®­ç»ƒçš„å®é™…æ‰¹é‡å¤§å°å°†æ˜¯æ‰€ä½¿ç”¨çš„è®¾å¤‡æ•°é‡ä¹˜ä»¥æ‚¨åœ¨è„šæœ¬ä¸­è®¾ç½®çš„æ‰¹é‡å¤§å°:ä¾‹å¦‚ï¼Œåœ¨åˆ›å»ºtrain_dataloaderæ—¶è®¾ç½®çš„æ‰¹é‡å¤§å°ä¸º16çš„4ä¸ªGPUä¸Šçš„è®­ç»ƒå°†åœ¨å®é™…æ‰¹é‡å¤§å°ä¸º64æ—¶è¿›è¡Œè®­ç»ƒã€‚</p><p>æˆ–è€…ï¼Œå¯ä»¥åœ¨åˆ›å»ºå’Œåˆå§‹åŒ–åŠ é€Ÿå™¨æ—¶ä½¿ç”¨<code>split_batches=True</code>é€‰é¡¹ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ— è®ºæ‚¨åœ¨1ã€2ã€4æˆ–64ä¸ªGPUä¸Šè¿è¡Œè„šæœ¬ï¼Œæ‰¹å¤„ç†å¤§å°éƒ½å°†ä¿æŒä¸å˜ã€‚</p><p>åœ¨æ‰§è¡Œæ­¤æ–¹æ³•æ—¶ï¼Œæ‚¨çš„è®­ç»ƒæ•°æ®åŠ è½½å™¨å¯èƒ½ä¼šæ›´æ”¹é•¿åº¦:å¦‚æœæ‚¨åœ¨Xä¸ªGPUä¸Šè¿è¡Œï¼Œå®ƒçš„é•¿åº¦å°†é™¤ä»¥X(å› ä¸ºæ‚¨çš„å®é™…æ‰¹å¤„ç†å¤§å°å°†ä¹˜ä»¥X)ï¼Œé™¤éè®¾ç½®<code>split_batches=True</code>ã€‚</p><h2 id="åå‘ä¼ é€’">åå‘ä¼ é€’</h2><p>å°†loss.backward()æ›¿æ¢æˆaccelerateçš„backwardæ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(num_epochs):</span><br><span class="line">    <span class="keyword">for</span> batch <span class="keyword">in</span> train_dataloader:</span><br><span class="line">        outputs = model(**batch)</span><br><span class="line">        loss = outputs.loss</span><br><span class="line">        accelerator.backward(loss)</span><br><span class="line"></span><br><span class="line">        optimizer.step()</span><br><span class="line">        lr_scheduler.step()</span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line">        progress_bar.update(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>åªéœ€è¦åšä»¥ä¸‹ä¿®æ”¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">+ <span class="keyword">from</span> accelerate <span class="keyword">import</span> Accelerator</span><br><span class="line">  <span class="keyword">from</span> transformers <span class="keyword">import</span> AdamW, AutoModelForSequenceClassification, get_scheduler</span><br><span class="line"></span><br><span class="line">+ accelerator = Accelerator()</span><br><span class="line"></span><br><span class="line">  model = AutoModelForSequenceClassification.from_pretrained(checkpoint, num_labels=<span class="number">2</span>)</span><br><span class="line">  optimizer = AdamW(model.parameters(), lr=<span class="number">3e-5</span>)</span><br><span class="line"></span><br><span class="line">- device = torch.device(<span class="string">&quot;cuda&quot;</span>) <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> torch.device(<span class="string">&quot;cpu&quot;</span>)</span><br><span class="line">- model.to(device)</span><br><span class="line"></span><br><span class="line">+ train_dataloader, eval_dataloader, model, optimizer = accelerator.prepare(</span><br><span class="line">+     train_dataloader, eval_dataloader, model, optimizer</span><br><span class="line">+ )</span><br><span class="line"></span><br><span class="line">  num_epochs = <span class="number">3</span></span><br><span class="line">  num_training_steps = num_epochs * <span class="built_in">len</span>(train_dataloader)</span><br><span class="line">  lr_scheduler = get_scheduler(</span><br><span class="line">      <span class="string">&quot;linear&quot;</span>,</span><br><span class="line">      optimizer=optimizer,</span><br><span class="line">      num_warmup_steps=<span class="number">0</span>,</span><br><span class="line">      num_training_steps=num_training_steps</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">  progress_bar = tqdm(<span class="built_in">range</span>(num_training_steps))</span><br><span class="line"></span><br><span class="line">  model.train()</span><br><span class="line">  <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(num_epochs):</span><br><span class="line">      <span class="keyword">for</span> batch <span class="keyword">in</span> train_dataloader:</span><br><span class="line">-         batch = &#123;k: v.to(device) <span class="keyword">for</span> k, v <span class="keyword">in</span> batch.items()&#125;</span><br><span class="line">          outputs = model(**batch)</span><br><span class="line">          loss = outputs.loss</span><br><span class="line">-         loss.backward()</span><br><span class="line">+         accelerator.backward(loss)</span><br><span class="line"></span><br><span class="line">          optimizer.step()</span><br><span class="line">          lr_scheduler.step()</span><br><span class="line">          optimizer.zero_grad()</span><br><span class="line">          progress_bar.update(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h2 id="æ¨¡å‹è®­ç»ƒ">æ¨¡å‹è®­ç»ƒ</h2><h3 id="train-with-a-script"><strong>Train with a script</strong></h3><p>é¦–å…ˆåˆ›å»ºå¹¶ä¿å­˜accelerate configï¼Œè¯¥é…ç½®è¢«ä¿å­˜åœ¨/home/username/.cache/huggingface/accelerate/default_config.yamlè·¯å¾„ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">accelerate config</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸éœ€è¦ä½¿ç”¨ä¸€äº›å…¶ä»–é…ç½®ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è¿è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">&quot;from accelerate.utils import write_basic_config; write_basic_config(mixed_precision=&#x27;fp16&#x27;)&quot;</span></span><br></pre></td></tr></table></figure><p>ç„¶åä½¿ç”¨ä¸‹é¢çš„æŒ‡ä»¤è¿›è¡Œè®­ç»ƒ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">accelerate launch train.py</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸‹é¢çš„æŒ‡ä»¤å¯ä»¥æŸ¥çœ‹accelerateçš„é…ç½®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">accelerate env</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚æˆ‘çš„è®­ç»ƒç¯å¢ƒä¸ºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">- `Accelerate` version: <span class="number">0.21</span><span class="number">.0</span></span><br><span class="line">- Platform: Linux-<span class="number">5.4</span><span class="number">.0</span>-<span class="number">92</span>-generic-x86_64-<span class="keyword">with</span>-glibc2<span class="number">.10</span></span><br><span class="line">- Python version: <span class="number">3.8</span><span class="number">.16</span></span><br><span class="line">- Numpy version: <span class="number">1.24</span><span class="number">.3</span></span><br><span class="line">- PyTorch version (GPU?): <span class="number">2.0</span><span class="number">.0</span>+cu117 (<span class="literal">True</span>)</span><br><span class="line">- PyTorch XPU available: <span class="literal">False</span></span><br><span class="line">- PyTorch NPU available: <span class="literal">False</span></span><br><span class="line">- System RAM: <span class="number">125.56</span> GB</span><br><span class="line">- GPU <span class="built_in">type</span>: NVIDIA GeForce RTX <span class="number">3090</span></span><br><span class="line">- `Accelerate` default config:</span><br><span class="line">        - compute_environment: LOCAL_MACHINE</span><br><span class="line">        - distributed_type: MULTI_GPU</span><br><span class="line">        - mixed_precision: fp16</span><br><span class="line">        - use_cpu: <span class="literal">False</span></span><br><span class="line">        - num_processes: <span class="number">3</span></span><br><span class="line">        - machine_rank: <span class="number">0</span></span><br><span class="line">        - num_machines: <span class="number">1</span></span><br><span class="line">        - rdzv_backend: static</span><br><span class="line">        - same_network: <span class="literal">False</span></span><br><span class="line">        - main_training_topction: main</span><br><span class="line">        - downcast_bf16: <span class="literal">False</span></span><br><span class="line">        - tpu_use_cluster: <span class="literal">False</span></span><br><span class="line">        - tpu_use_sudo: <span class="literal">False</span></span><br></pre></td></tr></table></figure><h3 id="train-with-a-notebook"><strong>Train with a notebook</strong></h3><p>ğŸ¤— Accelerate ä¹Ÿå¯ä»¥ä½¿ç”¨notebookè¿›è¡Œè®­ç»ƒÂ <strong><a href="https://huggingface.co/docs/accelerate/v0.21.0/en/package_reference/launchers#accelerate.notebook_launcher">notebook_launcher</a></strong>:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> accelerate <span class="keyword">import</span> notebook_launcher</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>notebook_launcher(training_topction)</span><br></pre></td></tr></table></figure><h2 id="æ¨¡å‹è¯„ä¼°">æ¨¡å‹è¯„ä¼°</h2><p>è‡³äºæ‚¨çš„è®­ç»ƒæ•°æ®åŠ è½½å™¨ï¼Œè¿™å°†æ„å‘³ç€(å¦‚æœæ‚¨åœ¨å¤šä¸ªè®¾å¤‡ä¸Šè¿è¡Œæ‚¨çš„è„šæœ¬)ï¼Œæ¯ä¸ªè®¾å¤‡å°†åªèƒ½çœ‹åˆ°éƒ¨åˆ†è¯„ä¼°æ•°æ®ã€‚è¿™æ„å‘³ç€ä½ éœ€è¦å°†ä½ çš„é¢„æµ‹ç»„åˆåœ¨ä¸€èµ·ã€‚ä½¿ç”¨gather_for_metrics()æ–¹æ³•å¾ˆå®¹æ˜“åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> inputs, targets <span class="keyword">in</span> validation_dataloader:</span><br><span class="line">    predictions = model(inputs)</span><br><span class="line">    <span class="comment"># Gather all predictions and targets</span></span><br><span class="line">    all_predictions, all_targets = accelerator.gather_for_metrics((predictions, targets))</span><br><span class="line">    <span class="comment"># Example of use with a *Datasets.Metric*</span></span><br><span class="line">    metric.add_batch(all_predictions, all_targets)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
          <category> HuggingFace </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬”è®° </tag>
            
            <tag> HuggingFace </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HuggingFace Pipeline</title>
      <link href="/2023/08/18/HuggingFace-Pipeline/"/>
      <url>/2023/08/18/HuggingFace-Pipeline/</url>
      
        <content type="html"><![CDATA[<h2 id="huggingface-ä¸­çš„pipeline">HuggingFace ä¸­çš„pipeline</h2><p>piplineæ˜¯ä½¿ç”¨æ¨¡å‹è¿›è¡Œæ¨ç†çš„ä¸€ç§å¾ˆå¥½ä¸”ç®€å•çš„æ–¹æ³•ã€‚ä½¿ç”¨pipline()å¯ä»¥ä½¿ç”¨**<a href="https://huggingface.co/models">Hub</a>**ä¸­çš„ä»»ä½•æ¨¡å‹æ¥æ¨ç†ä»»ä½•è¯­è¨€ã€è®¡ç®—æœºè§†è§‰ã€è¯­éŸ³å’Œå¤šæ¨¡å¼ä»»åŠ¡ã€‚è€Œä¸ç”¨è€ƒè™‘æ¨¡å‹åº•å±‚ä»£ç ã€‚</p><p>è¿™äº›piplineæ˜¯ä»åº“ä¸­æŠ½è±¡å‡ºå¤§éƒ¨åˆ†å¤æ‚ä»£ç çš„å¯¹è±¡ï¼Œæä¾›ä¸“ç”¨äºå¤šä¸ªä»»åŠ¡çš„ç®€å• API</p><h3 id="ç®€å•ä½¿ç”¨">ç®€å•ä½¿ç”¨</h3><p>æ¯ä¸ªä»»åŠ¡éƒ½æœ‰å…¶å…³è”çš„piplineï¼Œä½¿ç”¨åº”ç”¨äºç‰¹å®šä»»åŠ¡çš„pipelineçš„æ—¶å€™ï¼Œèƒ½å¤Ÿè‡ªåŠ¨åŠ è½½é»˜è®¤æ¨¡å‹å’Œèƒ½å¤Ÿå¤„ç†è¯¥ä»»åŠ¡çš„é¢„å¤„ç†ç±»</p><ol><li>é¦–å…ˆåˆ›å»º**<a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.pipeline">pipeline()</a>**å¹¶æŒ‡å®šæ¨ç†ä»»åŠ¡ï¼š</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> pipeline</span><br><span class="line"></span><br><span class="line">generator = pipeline(task=<span class="string">&quot;automatic-speech-recognition&quot;</span>)</span><br></pre></td></tr></table></figure><ol start="2"><li>å°†è¾“å…¥æ–‡æœ¬ä¼ é€’ç»™**<a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.pipeline">pipeline()</a>**ï¼š</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">generator(<span class="string">&quot;https://huggingface.co/datasets/Narsil/asr_dummy/resolve/main/mlk.flac&quot;</span>)</span><br></pre></td></tr></table></figure><p>3.ä¹Ÿå¯ä»¥æ›´æ¢å‚æ•°é‡æ›´å¤§çš„æ¨¡å‹è¿›è¡Œæ¨ç†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">generator = pipeline(model=<span class="string">&quot;openai/whisper-large&quot;</span>)</span><br><span class="line">generator(<span class="string">&quot;https://huggingface.co/datasets/Narsil/asr_dummy/resolve/main/mlk.flac&quot;</span>)</span><br></pre></td></tr></table></figure><p>4.å¯ä»¥å°†piplineç”¨åœ¨æ‰¹é‡æ•°æ®æˆ–è€…æ•°æ®é›†ä¸Š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">generator(</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&quot;https://huggingface.co/datasets/Narsil/asr_dummy/resolve/main/mlk.flac&quot;</span>,</span><br><span class="line">        <span class="string">&quot;https://huggingface.co/datasets/Narsil/asr_dummy/resolve/main/1.flac&quot;</span>,</span><br><span class="line">    ]</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h2 id="parameters">Parameters</h2><p>å‚æ•°åˆ—è¡¨å¦‚ä¸‹ï¼š</p><ul><li><p><strong>task</strong>Â (<code>str</code>) â€” The task defining which pipeline will be returned. Currently accepted tasks are:</p><ul><li><code>&quot;audio-classification&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.AudioClassificationPipeline">AudioClassificationPipeline</a></strong>.</li><li><code>&quot;automatic-speech-recognition&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.AutomaticSpeechRecognitionPipeline">AutomaticSpeechRecognitionPipeline</a></strong>.</li><li><code>&quot;conversational&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.ConversationalPipeline">ConversationalPipeline</a></strong>.</li><li><code>&quot;depth-estimation&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.DepthEstimationPipeline">DepthEstimationPipeline</a></strong>.</li><li><code>&quot;document-question-answering&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.DocumentQuestionAnsweringPipeline">DocumentQuestionAnsweringPipeline</a></strong>.</li><li><code>&quot;feature-extraction&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.FeatureExtractionPipeline">FeatureExtractionPipeline</a></strong>.</li><li><code>&quot;fill-mask&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.FillMaskPipeline">FillMaskPipeline</a></strong>:.</li><li><code>&quot;image-classification&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.ImageClassificationPipeline">ImageClassificationPipeline</a></strong>.</li><li><code>&quot;image-segmentation&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.ImageSegmentationPipeline">ImageSegmentationPipeline</a></strong>.</li><li><code>&quot;image-to-text&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.ImageToTextPipeline">ImageToTextPipeline</a></strong>.</li><li><code>&quot;mask-generation&quot;</code>: will return aÂ <code>MaskGenerationPipeline</code>.</li><li><code>&quot;object-detection&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.ObjectDetectionPipeline">ObjectDetectionPipeline</a></strong>.</li><li><code>&quot;question-answering&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.QuestionAnsweringPipeline">QuestionAnsweringPipeline</a></strong>.</li><li><code>&quot;summarization&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.SummarizationPipeline">SummarizationPipeline</a></strong>.</li><li><code>&quot;table-question-answering&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.TableQuestionAnsweringPipeline">TableQuestionAnsweringPipeline</a></strong>.</li><li><code>&quot;text2text-generation&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.Text2TextGenerationPipeline">Text2TextGenerationPipeline</a></strong>.</li><li><code>&quot;text-classification&quot;</code>Â (aliasÂ <code>&quot;sentiment-analysis&quot;</code>Â available): will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.TextClassificationPipeline">TextClassificationPipeline</a></strong>.</li><li><code>&quot;text-generation&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.TextGenerationPipeline">TextGenerationPipeline</a></strong>:.</li><li><code>&quot;token-classification&quot;</code>Â (aliasÂ <code>&quot;ner&quot;</code>Â available): will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.TokenClassificationPipeline">TokenClassificationPipeline</a></strong>.</li><li><code>&quot;translation&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.TranslationPipeline">TranslationPipeline</a></strong>.</li><li><code>&quot;translation_xx_to_yy&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.TranslationPipeline">TranslationPipeline</a></strong>.</li><li><code>&quot;video-classification&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.VideoClassificationPipeline">VideoClassificationPipeline</a></strong>.</li><li><code>&quot;visual-question-answering&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.VisualQuestionAnsweringPipeline">VisualQuestionAnsweringPipeline</a></strong>.</li><li><code>&quot;zero-shot-classification&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.ZeroShotClassificationPipeline">ZeroShotClassificationPipeline</a></strong>.</li><li><code>&quot;zero-shot-image-classification&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.ZeroShotImageClassificationPipeline">ZeroShotImageClassificationPipeline</a></strong>.</li><li><code>&quot;zero-shot-audio-classification&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.ZeroShotAudioClassificationPipeline">ZeroShotAudioClassificationPipeline</a></strong>.</li><li><code>&quot;zero-shot-object-detection&quot;</code>: will return aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/pipelines#transformers.ZeroShotObjectDetectionPipeline">ZeroShotObjectDetectionPipeline</a></strong>.</li></ul></li><li><p><strong>model</strong>Â (<code>str</code>Â orÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/model#transformers.PreTrainedModel">PreTrainedModel</a></strong>Â orÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/model#transformers.TFPreTrainedModel">TFPreTrainedModel</a></strong>,Â <em>optional</em>) â€” The model that will be used by the pipeline to make predictions. This can be a model identifier or an actual instance of a pretrained model inheriting fromÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/model#transformers.PreTrainedModel">PreTrainedModel</a></strong>Â (for PyTorch) orÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/model#transformers.TFPreTrainedModel">TFPreTrainedModel</a></strong>Â (for TensorFlow).</p><p>If not provided, the default for theÂ <code>task</code>Â will be loaded.</p></li><li><p><strong>config</strong>Â (<code>str</code>Â orÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/configuration#transformers.PretrainedConfig">PretrainedConfig</a></strong>,Â <em>optional</em>) â€” The configuration that will be used by the pipeline to instantiate the model. This can be a model identifier or an actual pretrained model configuration inheriting fromÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/configuration#transformers.PretrainedConfig">PretrainedConfig</a></strong>.</p><p>If not provided, the default configuration file for the requested model will be used. That means that ifÂ <code>model</code>Â is given, its default configuration will be used. However, ifÂ <code>model</code>Â is not supplied, thisÂ <code>task</code>â€™s default modelâ€™s config is used instead.</p></li><li><p><strong>tokenizer</strong>Â (<code>str</code>Â orÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/tokenizer#transformers.PreTrainedTokenizer">PreTrainedTokenizer</a></strong>,Â <em>optional</em>) â€” The tokenizer that will be used by the pipeline to encode data for the model. This can be a model identifier or an actual pretrained tokenizer inheriting fromÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/tokenizer#transformers.PreTrainedTokenizer">PreTrainedTokenizer</a></strong>.</p><p>If not provided, the default tokenizer for the givenÂ <code>model</code>Â will be loaded (if it is a string). IfÂ <code>model</code>Â is not specified or not a string, then the default tokenizer forÂ <code>config</code>Â is loaded (if it is a string). However, ifÂ <code>config</code>Â is also not given or not a string, then the default tokenizer for the givenÂ <code>task</code>Â will be loaded.</p></li><li><p><strong>feature_extractor</strong>Â (<code>str</code>Â orÂ <code>PreTrainedFeatureExtractor</code>,Â <em>optional</em>) â€” The feature extractor that will be used by the pipeline to encode data for the model. This can be a model identifier or an actual pretrained feature extractor inheriting fromÂ <code>PreTrainedFeatureExtractor</code>.</p><p>Feature extractors are used for non-NLP models, such as Speech or Vision models as well as multi-modal models. Multi-modal models will also require a tokenizer to be passed.</p><p>If not provided, the default feature extractor for the givenÂ <code>model</code>Â will be loaded (if it is a string). IfÂ <code>model</code>Â is not specified or not a string, then the default feature extractor forÂ <code>config</code>Â is loaded (if it is a string). However, ifÂ <code>config</code>Â is also not given or not a string, then the default feature extractor for the givenÂ <code>task</code>Â will be loaded.</p></li><li><p><strong>framework</strong>Â (<code>str</code>,Â <em>optional</em>) â€” The framework to use, eitherÂ <code>&quot;pt&quot;</code>Â for PyTorch orÂ <code>&quot;tf&quot;</code>Â for TensorFlow. The specified framework must be installed.</p><p>If no framework is specified, will default to the one currently installed. If no framework is specified and both frameworks are installed, will default to the framework of theÂ <code>model</code>, or to PyTorch if no model is provided.</p></li><li><p><strong>revision</strong>Â (<code>str</code>,Â <em>optional</em>, defaults toÂ <code>&quot;main&quot;</code>) â€” When passing a task name or a string model identifier: The specific model version to use. It can be a branch name, a tag name, or a commit id, since we use a git-based system for storing models and other artifacts on <a href="http://huggingface.co">huggingface.co</a>, soÂ <code>revision</code>Â can be any identifier allowed by git.</p></li><li><p><strong>use_fast</strong>Â (<code>bool</code>,Â <em>optional</em>, defaults toÂ <code>True</code>) â€” Whether or not to use a Fast tokenizer if possible (aÂ <strong><a href="https://huggingface.co/docs/transformers/v4.31.0/en/main_classes/tokenizer#transformers.PreTrainedTokenizerFast">PreTrainedTokenizerFast</a></strong>).</p></li><li><p><strong>use_auth_token</strong>Â (<code>str</code>Â orÂ <em>bool</em>,Â <em>optional</em>) â€” The token to use as HTTP bearer authorization for remote files. IfÂ <code>True</code>, will use the token generated when runningÂ <code>huggingface-cli login</code>Â (stored inÂ <code>~/.huggingface</code>).</p></li><li><p><strong>device</strong>Â (<code>int</code>Â orÂ <code>str</code>Â orÂ <code>torch.device</code>) â€” Defines the device (<em>e.g.</em>,Â <code>&quot;cpu&quot;</code>,Â <code>&quot;cuda:1&quot;</code>,Â <code>&quot;mps&quot;</code>, or a GPU ordinal rank likeÂ <code>1</code>) on which this pipeline will be allocated.</p></li><li><p><strong>device_map</strong>Â (<code>str</code>Â orÂ <code>Dict[str, Union[int, str, torch.device]</code>,Â <em>optional</em>) â€” Sent directly asÂ <code>model_kwargs</code>Â (just a simpler shortcut). WhenÂ <code>accelerate</code>Â library is present, setÂ <code>device_map=&quot;auto&quot;</code>Â to compute the most optimizedÂ <code>device_map</code>Â automatically (seeÂ <strong><a href="https://huggingface.co/docs/accelerate/main/en/package_reference/big_modeling#accelerate.cpu_offload">here</a></strong>Â for more information).</p><p>Do not useÂ <code>device_map</code>Â ANDÂ <code>device</code>Â at the same time as they will conflict</p></li><li><p><strong>torch_dtype</strong>Â (<code>str</code>Â orÂ <code>torch.dtype</code>,Â <em>optional</em>) â€” Sent directly asÂ <code>model_kwargs</code>Â (just a simpler shortcut) to use the available precision for this model (<code>torch.float16</code>,Â <code>torch.bfloat16</code>, â€¦ orÂ <code>&quot;auto&quot;</code>).</p></li><li><p><strong>trust_remote_code</strong>Â (<code>bool</code>,Â <em>optional</em>, defaults toÂ <code>False</code>) â€” Whether or not to allow for custom code defined on the Hub in their own modeling, configuration, tokenization or even pipeline files. This option should only be set toÂ <code>True</code>Â for repositories you trust and in which you have read the code, as it will execute code present on the Hub on your local machine.</p></li><li><p><strong>model_kwargs</strong>Â (<code>Dict[str, Any]</code>,Â <em>optional</em>) â€” Additional dictionary of keyword arguments passed along to the modelâ€™sÂ <code>from_pretrained(..., **model_kwargs)</code>Â topction.</p></li><li><p><strong>kwargs</strong>Â (<code>Dict[str, Any]</code>,Â <em>optional</em>) â€” Additional keyword arguments passed along to the specific pipeline init (see the documentation for the corresponding pipeline class for possible values).</p></li></ul><h3 id="device">Device</h3><ul><li><strong>device</strong>Â (<code>int</code>Â orÂ <code>str</code>Â orÂ <code>torch.device</code>) â€” Defines the device (<em>e.g.</em>,Â <code>&quot;cpu&quot;</code>,Â <code>&quot;cuda:1&quot;</code>,Â <code>&quot;mps&quot;</code>, or a GPU ordinal rank likeÂ <code>1</code>) on which this pipeline will be allocated.</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">generator = pipeline(model=<span class="string">&quot;openai/whisper-large&quot;</span>, device=<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>å¦‚æœæ¨¡å‹å¤ªå¤§ï¼Œä½¿ç”¨å•å¼ GPUä¸å¤Ÿï¼Œå¯ä»¥é€šè¿‡è®¾ç½® device_map = â€œautoâ€ä½¿ç”¨ ğŸ¤—Â <strong><a href="https://huggingface.co/docs/accelerate">Accelerate</a></strong>Â è‡ªåŠ¨åˆ†é…æ˜¾å­˜ï¼ŒåŠ è½½æ¨¡å‹å‚æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!pip install accelerate</span></span><br><span class="line">generator = pipeline(model=<span class="string">&quot;openai/whisper-large&quot;</span>, device_map=<span class="string">&quot;auto&quot;</span>)</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ ä½¿ç”¨äº†device_map = â€œautoâ€ï¼Œé‚£ä¹ˆåœ¨å®ä¾‹åŒ–piplineçš„æ—¶å€™å°±ä¸éœ€è¦è®¾ç½®deviceå‚æ•°çš„å€¼</p><ul><li><strong>device_map</strong>Â (<code>str</code>Â orÂ <code>Dict[str, Union[int, str, torch.device]</code>,Â <em>optional</em>) â€” Sent directly asÂ <code>model_kwargs</code>Â (just a simpler shortcut). WhenÂ <code>accelerate</code>Â library is present, setÂ <code>device_map=&quot;auto&quot;</code>Â to compute the most optimizedÂ <code>device_map</code>Â automatically (seeÂ <strong><a href="https://huggingface.co/docs/accelerate/main/en/package_reference/big_modeling#accelerate.cpu_offload">here</a></strong>Â for more information).</li></ul><h3 id="batch-size">Batch Size</h3><p>é»˜è®¤æƒ…å†µä¸‹piplineä¸ä¼šè¿›è¡Œæ‰¹å¤„ç†ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼ä½¿ç”¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">generator = pipeline(model=<span class="string">&quot;openai/whisper-large&quot;</span>, device=<span class="number">0</span>, batch_size=<span class="number">2</span>)</span><br><span class="line">audio_filenames = [<span class="string">f&quot;audio_<span class="subst">&#123;i&#125;</span>.flac&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)]</span><br><span class="line">texts = generator(audio_filenames)</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°çš„ä»£ç ä½¿ç”¨piplineå¯¹10ä¸ªéŸ³é¢‘æ–‡ä»¶è¿›è¡Œæ¨ç†ï¼Œä½†æ˜¯ä¼šæŒ‰ç…§ä¸¤ä¸ªæ‰¹æ¬¡ä¼ é€’ç»™ä½äºGPUä¸Šæ¨¡å‹ã€‚</p><p>å¯¹äºlistæˆ–è€…datasetæˆ–è€…generatoréƒ½å¯ä»¥ä½¿ç”¨æ‰¹å¤„ç†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> pipeline</span><br><span class="line"><span class="keyword">from</span> transformers.pipelines.pt_utils <span class="keyword">import</span> KeyDataset</span><br><span class="line"><span class="keyword">import</span> datasets</span><br><span class="line"></span><br><span class="line">dataset = datasets.load_dataset(<span class="string">&quot;imdb&quot;</span>, name=<span class="string">&quot;plain_text&quot;</span>, split=<span class="string">&quot;unsupervised&quot;</span>)</span><br><span class="line">pipe = pipeline(<span class="string">&quot;text-classification&quot;</span>, device=<span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> out <span class="keyword">in</span> pipe(KeyDataset(dataset, <span class="string">&quot;text&quot;</span>), batch_size=<span class="number">8</span>, truncation=<span class="string">&quot;only_first&quot;</span>):</span><br><span class="line">    <span class="built_in">print</span>(out)</span><br><span class="line">    <span class="comment"># [&#123;&#x27;label&#x27;: &#x27;POSITIVE&#x27;, &#x27;score&#x27;: 0.9998743534088135&#125;]</span></span><br><span class="line">    <span class="comment"># Exactly the same output as before, but the content are passed</span></span><br><span class="line">    <span class="comment"># as batches to the model</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æ‰¹å¤„ç†ä¹Ÿä¸æ˜¯éƒ½ä¼šç»™æ¨¡å‹åŠ é€Ÿï¼Œå¯èƒ½ä¼šå˜æ…¢ï¼Œç”šè‡³å¯¼è‡´å†…å­˜æ³„æ¼</p><p><strong>Dataset1</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> pipeline</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> Dataset</span><br><span class="line"><span class="keyword">from</span> tqdm.auto <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">pipe = pipeline(<span class="string">&quot;text-classification&quot;</span>, device=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyDataset</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">5000</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, i</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;This is a test&quot;</span></span><br><span class="line"></span><br><span class="line">dataset = MyDataset()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> batch_size <span class="keyword">in</span> [<span class="number">1</span>, <span class="number">8</span>, <span class="number">64</span>, <span class="number">256</span>]:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">30</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Streaming batch_size=<span class="subst">&#123;batch_size&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> out <span class="keyword">in</span> tqdm(pipe(dataset, batch_size=batch_size), total=<span class="built_in">len</span>(dataset)):</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># On GTX 970</span></span><br><span class="line">------------------------------</span><br><span class="line">Streaming no batching</span><br><span class="line"><span class="number">100</span>%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| <span class="number">5000</span>/<span class="number">5000</span> [<span class="number">00</span>:<span class="number">26</span>&lt;<span class="number">00</span>:<span class="number">00</span>, <span class="number">187.52</span>it/s]</span><br><span class="line">------------------------------</span><br><span class="line">Streaming batch_size=<span class="number">8</span></span><br><span class="line"><span class="number">100</span>%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| <span class="number">5000</span>/<span class="number">5000</span> [<span class="number">00</span>:04&lt;<span class="number">00</span>:<span class="number">00</span>, <span class="number">1205.95</span>it/s]</span><br><span class="line">------------------------------</span><br><span class="line">Streaming batch_size=<span class="number">64</span></span><br><span class="line"><span class="number">100</span>%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| <span class="number">5000</span>/<span class="number">5000</span> [<span class="number">00</span>:02&lt;<span class="number">00</span>:<span class="number">00</span>, <span class="number">2478.24</span>it/s]</span><br><span class="line">------------------------------</span><br><span class="line">Streaming batch_size=<span class="number">256</span></span><br><span class="line"><span class="number">100</span>%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| <span class="number">5000</span>/<span class="number">5000</span> [<span class="number">00</span>:01&lt;<span class="number">00</span>:<span class="number">00</span>, <span class="number">2554.43</span>it/s]</span><br><span class="line">(diminishing returns, saturated the GPU)</span><br></pre></td></tr></table></figure><p><strong>Dataset2</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyDataset</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">5000</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, i</span>):</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">64</span> == <span class="number">0</span>:</span><br><span class="line">            n = <span class="number">100</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            n = <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;This is a test&quot;</span> * n</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">------------------------------</span><br><span class="line">Streaming no batching</span><br><span class="line"><span class="number">100</span>%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| <span class="number">1000</span>/<span class="number">1000</span> [<span class="number">00</span>:05&lt;<span class="number">00</span>:<span class="number">00</span>, <span class="number">183.69</span>it/s]</span><br><span class="line">------------------------------</span><br><span class="line">Streaming batch_size=<span class="number">8</span></span><br><span class="line"><span class="number">100</span>%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| <span class="number">1000</span>/<span class="number">1000</span> [<span class="number">00</span>:03&lt;<span class="number">00</span>:<span class="number">00</span>, <span class="number">265.74</span>it/s]</span><br><span class="line">------------------------------</span><br><span class="line">Streaming batch_size=<span class="number">64</span></span><br><span class="line"><span class="number">100</span>%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| <span class="number">1000</span>/<span class="number">1000</span> [<span class="number">00</span>:<span class="number">26</span>&lt;<span class="number">00</span>:<span class="number">00</span>, <span class="number">37.80</span>it/s]</span><br><span class="line">------------------------------</span><br><span class="line">Streaming batch_size=<span class="number">256</span></span><br><span class="line">  <span class="number">0</span>%|                                                                                 | <span class="number">0</span>/<span class="number">1000</span> [<span class="number">00</span>:<span class="number">00</span>&lt;?, ?it/s]</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;/home/nicolas/src/transformers/test.py&quot;</span>, line <span class="number">42</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    <span class="keyword">for</span> out <span class="keyword">in</span> tqdm(pipe(dataset, batch_size=<span class="number">256</span>), total=<span class="built_in">len</span>(dataset)):</span><br><span class="line">....</span><br><span class="line">    q = q / math.sqrt(dim_per_head)  <span class="comment"># (bs, n_heads, q_length, dim_per_head)</span></span><br><span class="line">RuntimeError: CUDA out of memory. Tried to allocate <span class="number">376.00</span> MiB (GPU <span class="number">0</span>; <span class="number">3.95</span> GiB total capacity; <span class="number">1.72</span> GiB already allocated; <span class="number">354.88</span> MiB free; <span class="number">2.46</span> GiB reserved <span class="keyword">in</span> total by PyTorch)</span><br></pre></td></tr></table></figure><p>ç”±äºç¬¬äºŒä¸ªæ•°æ®é›†ä¸­ï¼Œå­˜åœ¨ä¸ªåˆ«ç‰¹åˆ«é•¿çš„æ•°æ®ï¼Œå°±å¯¼è‡´åŒä¸€æ‰¹æ¬¡çš„æ‰€æœ‰æ•°æ®éƒ½è¦paddingåˆ°400ä¸ªtokené•¿ï¼Œé‚£ä¸ªä¸€ä¸ªbatchå°±ä¼šä»ä¹‹å‰çš„ã€64ï¼Œ4ã€‘å˜æˆã€64ï¼Œ400ã€‘ï¼Œå½“æ‰¹æ¬¡å†å¢å¤§åˆ°256çš„æ—¶å€™ï¼Œç¨‹åºå°±ä¼šå´©æºƒã€‚</p><p>ä½†æ˜¯å¯¹äºè¿™æ ·çš„é—®é¢˜ï¼Œæ²¡æœ‰é€šç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œåªèƒ½æ ¹æ®ç»éªŒå’Œå®é™…çš„æ•°æ®è¿›è¡Œæµ‹è¯•</p><p>ä¸‹é¢è¿™äº›æƒ…å†µä¸è¦ä½¿ç”¨Batch</p><p>å¯¹äºæ¨¡å‹æ¨ç†çš„å®æ—¶æ€§è¦æ±‚è¾ƒé«˜ã€å¦‚æœä½¿ç”¨CPUã€å¦‚æœå¯¹äºå¯èƒ½çš„è¾“å…¥çš„sequence_lengthæœªçŸ¥</p><p>å¦‚æœä½¿ç”¨äº†batchingï¼Œé‚£ä¹ˆéœ€è¦æ³¨æ„OOMs(out of memory)</p><h3 id="pipeline-chunk-batching">Pipeline chunk batching</h3><p>åƒzero-shot- classificationå’ŒQAé—®é¢˜è¿™æ ·çš„ï¼Œä¸€ä¸ªè¾“å…¥å¯èƒ½éœ€è¦å¯¹ä¸€ä¸ªæ¨¡å‹åšå¤šä¸ªå‰å‘ä¼ æ’­ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ChunkPipelineè€Œä¸æ˜¯æ™®é€šçš„Pipeline</p><p>æ™®é€šæ¨¡å‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">preprocessed = pipe.preprocess(inputs)</span><br><span class="line">model_outputs = pipe.forward(preprocessed)</span><br><span class="line">outputs = pipe.postprocess(model_outputs)</span><br></pre></td></tr></table></figure><p>chunk pipeline:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">all_model_outputs = []</span><br><span class="line"><span class="keyword">for</span> preprocessed <span class="keyword">in</span> pipe.preprocess(inputs):</span><br><span class="line">    model_outputs = pipe.forward(preprocessed)</span><br><span class="line">    all_model_outputs.append(model_outputs)</span><br><span class="line">outputs = pipe.postprocess(all_model_outputs)</span><br></pre></td></tr></table></figure><h2 id="åœ¨datasetä¸Šä½¿ç”¨pipeline">åœ¨datasetä¸Šä½¿ç”¨pipeline</h2><p>ä»ğŸ¤—Â <strong><a href="https://github.com/huggingface/datasets/">Datasets</a>åŠ è½½å¹¶è¿­ä»£æ•°æ®é›†</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># KeyDataset is a util that will just output the item we&#x27;re interested in.</span></span><br><span class="line"><span class="keyword">from</span> transformers.pipelines.pt_utils <span class="keyword">import</span> KeyDataset</span><br><span class="line"><span class="keyword">from</span> datasets <span class="keyword">import</span> load_dataset</span><br><span class="line"></span><br><span class="line">pipe = pipeline(model=<span class="string">&quot;hf-internal-testing/tiny-random-wav2vec2&quot;</span>, device=<span class="number">0</span>)</span><br><span class="line">dataset = load_dataset(<span class="string">&quot;hf-internal-testing/librispeech_asr_dummy&quot;</span>, <span class="string">&quot;clean&quot;</span>, split=<span class="string">&quot;validation[:10]&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> out <span class="keyword">in</span> pipe(KeyDataset(dataset, <span class="string">&quot;audio&quot;</span>)):</span><br><span class="line">    <span class="built_in">print</span>(out)</span><br></pre></td></tr></table></figure><h2 id="åœ¨å¤§æ¨¡å‹ä¸Šé€šè¿‡accelerateä½¿ç”¨pipeline">åœ¨å¤§æ¨¡å‹ä¸Šé€šè¿‡accelerateä½¿ç”¨pipeline</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pip install accelerate</span></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> pipeline</span><br><span class="line"></span><br><span class="line">pipe = pipeline(model=<span class="string">&quot;facebook/opt-1.3b&quot;</span>, torch_dtype=torch.bfloat16, device_map=<span class="string">&quot;auto&quot;</span>)</span><br><span class="line">output = pipe(<span class="string">&quot;This is a cool example!&quot;</span>, do_sample=<span class="literal">True</span>, top_p=<span class="number">0.95</span>)</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä¼ é€’ 8 ä½åŠ è½½æ¨¡å‹<code>load_in_8bit=True</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pip install accelerate bitsandbytes</span></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> pipeline</span><br><span class="line"></span><br><span class="line">pipe = pipeline(model=<span class="string">&quot;facebook/opt-1.3b&quot;</span>, device_map=<span class="string">&quot;auto&quot;</span>, model_kwargs=&#123;<span class="string">&quot;load_in_8bit&quot;</span>: <span class="literal">True</span>&#125;)</span><br><span class="line">output = pipe(<span class="string">&quot;This is a cool example!&quot;</span>, do_sample=<span class="literal">True</span>, top_p=<span class="number">0.95</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
          <category> HuggingFace </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬”è®° </tag>
            
            <tag> HuggingFace </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Transformers Quick Start</title>
      <link href="/2023/08/17/transformer-quick-start/"/>
      <url>/2023/08/17/transformer-quick-start/</url>
      
        <content type="html"><![CDATA[<h1 id="huggingfaceå…¥é—¨æ•™ç¨‹">HuggingFaceå…¥é—¨æ•™ç¨‹</h1><h2 id="å¿«é€Ÿå…¥é—¨">å¿«é€Ÿå…¥é—¨</h2><p>åœ¨å¼€å§‹ä¹‹å‰, ç¡®ä¿ä½ å·²ç»å®‰è£…äº†æ‰€æœ‰å¿…è¦çš„åº“:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!pip install transformers datasets</span><br></pre></td></tr></table></figure><p>ä½ è¿˜éœ€è¦å®‰è£…å–œæ¬¢çš„æœºå™¨å­¦ä¹ æ¡†æ¶: pytorch</p><p>ä½¿ç”¨<code>pipeline()</code>æ˜¯åˆ©ç”¨é¢„è®­ç»ƒæ¨¡å‹è¿›è¡Œæ¨ç†çš„æœ€ç®€å•çš„æ–¹å¼. ä½ èƒ½å¤Ÿå°†<code>pipeline()</code>å¼€ç®±å³ç”¨åœ°ç”¨äºè·¨ä¸åŒæ¨¡æ€çš„å¤šç§ä»»åŠ¡. å®ƒæ”¯æŒçš„ä»»åŠ¡åˆ—è¡¨:</p><p><img src="https://picture.fanfer.top/img/huggingface1.png" alt="Untitled"></p><h2 id="ä½¿ç”¨å®˜æ–¹æ¨¡å‹åº“ä¸­çš„æ¨¡å‹">ä½¿ç”¨å®˜æ–¹æ¨¡å‹åº“ä¸­çš„æ¨¡å‹</h2><p>ä½¿ç”¨BLIP2ä½œä¸ºä¾‹å­ï¼Œè¿™æ˜¯ä¸€ä¸ªimage-captioningçš„Image2Languageæ¨¡å‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> Blip2Processor, Blip2ForConditionalGeneration</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨GPUåŠ é€Ÿæ¨¡å‹ï¼Œé€šè¿‡processorå°†å›¾ç‰‡è½¬åŒ–ä¸ºæ¨¡å‹è¾“å…¥ï¼Œé€šè¿‡modelå®ç°è¾“</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">processor = Blip2Processor.from_pretrained(<span class="string">&quot;Salesforce/blip2-opt-2.7b&quot;</span>)</span><br><span class="line">model = Blip2ForConditionalGeneration.from_pretrained(<span class="string">&quot;Salesforce/blip2-opt-2.7b&quot;</span>, device_map=<span class="string">&quot;auto&quot;</span>)</span><br><span class="line">device = <span class="string">&quot;cuda&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span></span><br></pre></td></tr></table></figure><p>è¯»å–ä¸€å¼ ç…§ç‰‡å®Œæˆæ¨ç†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">image = Image.<span class="built_in">open</span>(requests.get(<span class="string">&quot;https://picture.fanfer.top/Test_pics/1681699301.322593.jpg&quot;</span>, stream=<span class="literal">True</span>).raw).convert(<span class="string">&#x27;RGB&#x27;</span>)</span><br><span class="line">inputs = processor(images=image, return_tensors=<span class="string">&quot;pt&quot;</span>).to(device, torch.float16)</span><br><span class="line">generated_ids = model.generate(**inputs)</span><br><span class="line">generated_text = processor.batch_decode(generated_ids, skip_special_tokens=<span class="literal">True</span>)[<span class="number">0</span>].strip()</span><br><span class="line"><span class="built_in">print</span>(generated_text)</span><br></pre></td></tr></table></figure><p>ä¿å­˜æ¨¡å‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pt_save_directory = <span class="string">&quot;./pt_save_pretrained&quot;</span></span><br><span class="line">processor.save_pretrained(pt_save_directory)</span><br><span class="line">model.save_pretrained(pt_save_directory)</span><br></pre></td></tr></table></figure><p>é‡æ–°ä»ä¿å­˜çš„æ¨¡å‹å¤„åŠ åœ¨æ¨¡å‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">processor = Blip2Processor.from_pretrained(tf_save_directory)</span><br><span class="line">pt_model = Blip2ForConditionalGeneration.from_pretrained(tf_save_directory, from_tf=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><h2 id="æ ¹æ®configè‡ªå®šä¹‰æ¨¡å‹">æ ¹æ®Configè‡ªå®šä¹‰æ¨¡å‹</h2><p>å¯ä»¥ä¿®æ”¹æ¨¡å‹çš„é…ç½®ç±»æ¥æ›´æ”¹æ¨¡å‹çš„æ„å»ºæ–¹å¼ã€‚é…ç½®æŒ‡å®šæ¨¡å‹çš„å±æ€§ï¼Œä¾‹å¦‚éšè—å±‚æˆ–æ³¨æ„åŠ›å¤´çš„æ•°é‡ã€‚ä»è‡ªå®šä¹‰é…ç½®ç±»åˆå§‹åŒ–æ¨¡å‹æ—¶ï¼Œæ¨¡å‹å‚æ•°æ˜¯éšæœºåˆå§‹åŒ–çš„ï¼Œéœ€è¦å…ˆè®­ç»ƒæ¨¡å‹ï¼Œç„¶åæ‰èƒ½ä½¿ç”¨å®ƒæ¥è·å¾—æœ‰æ„ä¹‰çš„ç»“æœã€‚</p><p><a href="https://huggingface.co/docs/transformers/main/en/create_a_model">Create a custom architecture</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> AutoConfig</span><br><span class="line">my_config = AutoConfig.from_pretrained(<span class="string">&quot;distilbert-base-uncased&quot;</span>, n_heads=<span class="number">12</span>)</span><br><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> AutoModel</span><br><span class="line">my_model = AutoModel.from_config(my_config)</span><br></pre></td></tr></table></figure><h2 id="è®­ç»ƒæ¨¡å‹">è®­ç»ƒæ¨¡å‹</h2><p>æ‰€æœ‰çš„æ¨¡å‹éƒ½æ˜¯Â <strong><code>[torch.nn.Module](https://pytorch.org/docs/stable/nn.html#torch.nn.Module)</code></strong>Â æ‰€ä»¥å¯ä»¥å®Œæˆtrain loop. ğŸ¤— Transformers ä¸ºPyTorchæä¾›äº†Â <strong><a href="https://huggingface.co/docs/transformers/main/en/main_classes/trainer#transformers.Trainer">Trainer</a></strong>Â ç±»ï¼Œå¯ä»¥æŒ‰ç…§ä¸‹é¢çš„æ–¹æ³•è¿›è¡Œè®­ç»ƒ</p><p>1.å¯¼å…¥é¢„è®­ç»ƒæ¨¡å‹æˆ–è€…è‡ªå®šä¹‰æ¨¡å‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> AutoModelForSequenceClassification</span><br><span class="line">model = AutoModelForSequenceClassification.from_pretrained(<span class="string">&quot;distilbert-base-uncased&quot;</span>)</span><br></pre></td></tr></table></figure><p>2.**<a href="https://huggingface.co/docs/transformers/main/en/main_classes/trainer#transformers.TrainingArguments">TrainingArguments</a>**åŒ…å«å¯ä»¥æ›´æ”¹çš„æ¨¡å‹è¶…å‚æ•°ï¼Œä¾‹å¦‚å­¦ä¹ ç‡ã€æ‰¹é‡å¤§å°å’Œè®­ç»ƒå‘¨æœŸæ•°ã€‚å¦‚æœä¸æŒ‡å®šä»»ä½•è®­ç»ƒå‚æ•°ï¼Œåˆ™ä½¿ç”¨é»˜è®¤å€¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> TrainingArguments</span><br><span class="line"></span><br><span class="line">training_args = TrainingArguments(</span><br><span class="line">    output_dir=<span class="string">&quot;path/to/save/folder/&quot;</span>,</span><br><span class="line">    learning_rate=<span class="number">2e-5</span>,</span><br><span class="line">    per_device_train_batch_size=<span class="number">8</span>,</span><br><span class="line">    per_device_eval_batch_size=<span class="number">8</span>,</span><br><span class="line">    num_train_epochs=<span class="number">2</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>3.åŠ è½½é¢„å¤„ç†ç±»ï¼Œä¾‹å¦‚tokenizer, image processor, feature extractor, processor</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> AutoTokenizer</span><br><span class="line">tokenizer = AutoTokenizer.from_pretrained(<span class="string">&quot;distilbert-base-uncased&quot;</span>)</span><br></pre></td></tr></table></figure><p>4.åŠ è½½æ•°æ®é›†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datasets <span class="keyword">import</span> load_dataset</span><br><span class="line">dataset = load_dataset(<span class="string">&quot;rotten_tomatoes&quot;</span>)  <span class="comment"># doctest: +IGNORE_RESULT</span></span><br></pre></td></tr></table></figure><p>5.å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">tokenize_dataset</span>(<span class="params">dataset</span>):</span><br><span class="line">...</span><br><span class="line">    <span class="keyword">return</span> tokenizer(dataset[<span class="string">&quot;text&quot;</span>])</span><br><span class="line"></span><br><span class="line">dataset = dataset.<span class="built_in">map</span>(tokenize_dataset, batched=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>6.Â <strong><a href="https://huggingface.co/docs/transformers/main/en/main_classes/data_collator#transformers.DataCollatorWithPadding">DataCollatorWithPadding</a></strong>Â ä»datasetä¸­åˆ›å»ºbatch</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> DataCollatorWithPadding</span><br><span class="line">data_collator = DataCollatorWithPadding(tokenizer=tokenizer)</span><br></pre></td></tr></table></figure><p>7.åˆ›å»ºTrainerå¯¹è±¡å¹¶è®­ç»ƒ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> Trainer</span><br><span class="line"></span><br><span class="line">trainer = Trainer(</span><br><span class="line">    model=model,</span><br><span class="line">    args=training_args,</span><br><span class="line">    train_dataset=dataset[<span class="string">&quot;train&quot;</span>],</span><br><span class="line">    eval_dataset=dataset[<span class="string">&quot;test&quot;</span>],</span><br><span class="line">    tokenizer=tokenizer,</span><br><span class="line">    data_collator=data_collator,</span><br><span class="line">)  <span class="comment"># doctest: +SKIP</span></span><br><span class="line"></span><br><span class="line">trainer.train()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
          <category> HuggingFace </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬”è®° </tag>
            
            <tag> HuggingFace </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GameFormer</title>
      <link href="/2023/08/12/GameFormer/"/>
      <url>/2023/08/12/GameFormer/</url>
      
        <content type="html"><![CDATA[<p>Author: Zhiyu Huang, Haochen Liu, Chen Lv<br>Code: <a href="https://mczhi.github.io/GameFormer/">https://mczhi.github.io/GameFormer/</a><br>Comment: level-k game theory for planning<br>Key Words: Fusion, Object Detection<br>Score: â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸<br>Source: ICCV2023</p><p>â€œhierarchical game theoryâ€ çš„ä¸­æ–‡ç¿»è¯‘æ˜¯ â€œåˆ†å±‚åšå¼ˆè®ºâ€ã€‚</p><p>trajectoriesç¿»è¯‘æˆä¸­æ–‡æ˜¯â€œè½¨è¿¹â€ã€‚</p><p>motion prediction è¿åŠ¨é¢„æµ‹</p><p>level-k ç†è®ºæ˜¯ä¸€ä¸ªåœ¨è¡Œä¸ºç»æµå­¦å’Œæ¸¸æˆç†è®ºä¸­ä½¿ç”¨çš„äººç±»è¡Œä¸ºæ¨¡å‹ã€‚å®ƒå‡è®¾å‚ä¸æˆ˜ç•¥æ¸¸æˆçš„ç©å®¶æ ¹æ®å…¶ä»–ç©å®¶çš„è¡ŒåŠ¨é¢„æµ‹æ¥å†³å®šè‡ªå·±çš„ä¸¾åŠ¨ã€‚ç©å®¶å› æ­¤å¯ä»¥æŒ‰ç…§ç†è§£å…¶ä»–ç©å®¶ä¸¾åŠ¨çš„æ·±åº¦æ¥åˆ†ç±»ã€‚çº§åˆ«-kç†è®ºå‡è®¾æ¯ä¸ªç©å®¶éƒ½è®¤ä¸ºè‡ªå·±æ˜¯æ¸¸æˆä¸­æœ€ç²¾æ˜çš„äººã€‚è¿™è¢«å½’å› äºè®¸å¤šå› ç´ ,å¦‚â€œç»´æŠ¤æˆæœ¬â€æˆ–å•çº¯çš„è¿‡åˆ†è‡ªä¿¡ã€‚ç©å®¶å› æ­¤æ ¹æ®ç©å®¶è®¤ä¸ºå…¶ä»–ç«äº‰è€…æ‰€å¤„çš„å¤æ‚ç¨‹åº¦è€Œè¢«å½’ç±»ä¸ºkçº§åˆ«ã€‚ä½ è®¤ä¸ºä»–äººæ„ˆå¹¼ç¨š,ä½ çš„åˆ†ç±»å°±æ„ˆä½ã€‚è¿™ç§æ¨¡å¼å»¶ç»­è‡³æ›´é«˜çº§åˆ«çš„ç©å®¶,ä½†æ¯ä¸ªç©å®¶åªæœ‰æœ‰é™çš„æ¨ç†æ·±åº¦,æ„å‘³ç€ä¸ªä½“ç©å®¶åœ¨æˆ˜ç•¥æ€è€ƒçš„æ·±åº¦ä¸Šæœ‰æ‰€é™åˆ¶ã€‚</p><h2 id="abstract">Abstract</h2><p>1.æœ¬æ–‡é€šè¿‡é‡‡ç”¨åˆ†å±‚åšå¼ˆè®ºæ¥é˜è¿°äº¤äº’é¢„æµ‹é—®é¢˜</p><p>2.æå‡ºäº†GameFormeræ¡†æ¶ï¼šä½¿ç”¨Transformerè§£ç å™¨ç»“æ„ï¼Œä½¿ç”¨ä¸Šä¸€çº§çš„é¢„æµ‹ç»“æœå’Œç¯å¢ƒèƒŒæ™¯æ¥è¿­ä»£åœ°æ”¹è¿›äº¤äº’è¿‡ç¨‹</p><p>3.æå‡ºä¸€ä¸ªå­¦ä¹ è¿‡ç¨‹ï¼Œä»¥è°ƒèŠ‚agentåœ¨å½“å‰çº§åˆ«çš„è¡Œä¸ºï¼Œä»¥å“åº”ä¸Šä¸€çº§åˆ«å…¶ä»–agentçš„è¡Œä¸º</p><h2 id="conclusion">Conclusion</h2><p>æœ¬è®ºæ–‡ä»‹ç»äº† GameFormerï¼Œè¿™æ˜¯ä¸€ç§åŸºäº Transformer çš„æ¨¡å‹ï¼Œåˆ©ç”¨åˆ†å±‚åšå¼ˆè®ºè¿›è¡Œäº¤äº’å¼é¢„æµ‹å’Œè§„åˆ’ã€‚æˆ‘ä»¬æå‡ºçš„æ–¹æ³•åœ¨é¢„æµ‹æ¨¡å‹ä¸­åŠ å…¥äº†æ–°é¢–çš„level-kè§£ç å™¨ï¼Œç”¨äºè¿­ä»£åœ°æ”¹å–„äº¤äº’ä»£ç†çš„æœªæ¥è½¨è¿¹ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€ä¸ªå­¦ä¹ è¿‡ç¨‹ï¼Œæ ¹æ®ä¸Šä¸€çº§çš„é¢„æµ‹ç»“æœæ¥è°ƒèŠ‚ä»£ç†çš„é¢„æµ‹è¡Œä¸ºã€‚åœ¨ Waymo å¼€æ”¾æ•°æ®é›†ä¸Šçš„å®éªŒç»“æœè¡¨æ˜ï¼Œæˆ‘ä»¬çš„æ¨¡å‹åœ¨äº¤äº’é¢„æµ‹æ–¹é¢è¾¾åˆ°äº†æœ€å…ˆè¿›çš„ç²¾åº¦ï¼Œå¹¶åœ¨å¼€ç¯å’Œé—­ç¯è§„åˆ’æµ‹è¯•ä¸­ä¼˜äºåŸºçº¿æ–¹æ³•ã€‚</p><h2 id="introduction">Introduction</h2><p>é—®é¢˜ï¼šå‡†ç¡®é¢„æµ‹å‘¨å›´äº¤é€šå‚ä¸è€…çš„æœªæ¥è¡Œä¸ºå¹¶åšå‡ºå®‰å…¨çš„ç¬¦åˆè§„èŒƒçš„å†³ç­–ï¼ˆMotion Prediction and planningï¼‰</p><p>æŒ‘æˆ˜ï¼šäº¤é€šå‚ä¸è€…çš„è¡Œä¸ºä¾èµ–äºé“è·¯ç»“æ„ï¼Œäº¤é€šè§„èŒƒå’Œäº¤é€šå‚ä¸è€…ä¹‹é—´çš„ç›¸äº’ä½œç”¨</p><p>Transformeræ¨¡å‹ï¼šflexibility and effectiveness æ“…é•¿å¤„ç†å¤šç§ç±»åˆ«çš„æ··åˆä¿¡æ¯ï¼Œä»¥åŠå¤„ç†è¿™äº›ä¸åŒç±»åˆ«å…ƒç´ ä¹‹é—´çš„å…³ç³»ã€‚æ‰€ä»¥åœ¨è¿åŠ¨æ¨¡å‹é¢„æµ‹ä¸­åº”ç”¨å¹¿æ³›</p><p>å½“å‰æ–¹æ³•çš„é—®é¢˜ï¼šå¯¹äºé©¾é©¶åœºæ™¯ç¼–ç ï¼Œåˆ©ç”¨agentè¿‡å»çš„è½¨è¿¹è¡¨ç¤ºäº¤äº’ï¼Œç¼ºå°‘å¯¹æœªæ¥äº¤äº’çš„æ˜ç¡®å»ºæ¨¡ã€‚ç¼ºå°‘äº†è‡ªåŠ¨é©¾é©¶è½¦è¾†ä¹‹é—´çš„äº¤äº’ã€‚</p><p>æ¡ä»¶é¢„æµ‹æ¨¡å‹ï¼šä½¿ç”¨è‡ªåŠ¨é©¾é©¶è½¦è¾†çš„å†…éƒ¨è®¡åˆ’æ¥é¢„æµ‹å…¶ä»–ä»£ç†å¯¹è‡ªåŠ¨é©¾é©¶è½¦è¾†çš„ååº”ã€‚è¿™ç§å•å‘äº¤äº’æ–¹æ¡ˆä»ç„¶å¿½ç•¥äº†è‡ªåŠ¨é©¾é©¶è½¦è¾†å’Œå…¶ä»–é“è·¯ç”¨æˆ·ä¹‹é—´çš„åŠ¨æ€ç›¸äº’å½±å“ã€‚ä»åšå¼ˆè®ºçš„è§’åº¦æ¥çœ‹ï¼Œå½“å‰çš„é¢„æµ‹/è§„åˆ’æ¨¡å‹å¯ä»¥è¢«çœ‹ä½œæ˜¯å…·æœ‰æœ‰é™äº¤äº’å±‚çº§çš„é¢†å¯¼è€…-è¿½éšè€…åšå¼ˆã€‚</p><p><img src="https://picture.fanfer.top/img/gameformer1.png" alt="Gameformer1"></p><p>å›¾ä¸€ï¼š</p><p>æˆ‘ä»¬é‡‡ç”¨åˆ†å±‚æ¨ç†åšå¼ˆä»¥è¿­ä»£çš„æ–¹å¼æ¥å»ºæ¨¡ä»£ç†ä¹‹é—´çš„æœªæ¥äº¤äº’ï¼Œä»¥æ›´å¥½åœ°åæ˜ è®¤çŸ¥æ¨ç†è¿‡ç¨‹ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨Transformerç¼–ç å™¨å°†é©¾é©¶åœºæ™¯ç¼–ç ä¸ºèƒŒæ™¯ä¿¡æ¯ï¼ŒåŒ…æ‹¬å‘é‡åŒ–åœ°å›¾å’Œè§‚å¯Ÿåˆ°çš„ä»£ç†çŠ¶æ€ã€‚åœ¨æœªæ¥çš„è§£ç é˜¶æ®µï¼Œæˆ‘ä»¬éµå¾ªk-levelåšå¼ˆè®ºï¼Œå‡è®¾ä»£ç†è¿›è¡Œæœ‰é™æ¬¡çš„ç­–ç•¥æ¨ç†ã€‚</p><p>0å±‚agentç‹¬ç«‹è¡ŒåŠ¨è€Œä¸è€ƒè™‘å…¶ä»–ä»£ç†ï¼Œè€Œkå±‚agentåˆ™å‡å®šå…¶ä»–agentå¤„äºk-1å±‚ï¼Œå¹¶åšå‡ºååº”ã€‚å…·ä½“è€Œè¨€ï¼Œæˆ‘ä»¬è®¾ç½®äº†ä¸€ç³»åˆ—Transformerè§£ç å™¨æ¥å®ç°k-levelæ¨ç†ã€‚</p><p>level-0è§£ç å™¨ä»…ä½¿ç”¨åˆå§‹çš„æ¨¡æ€æŸ¥è¯¢å’Œç¼–ç çš„åœºæ™¯ä¸Šä¸‹æ–‡ä½œä¸ºé”®å’Œå€¼æ¥é¢„æµ‹ä»£ç†çš„å¤šæ¨¡æ€æœªæ¥è½¨è¿¹ã€‚ç„¶åï¼Œåœ¨æ¯ä¸ªè¿­ä»£kä¸­ï¼Œlevel-kè§£ç å™¨å°†æ¥è‡ªlevel-(k-1)è§£ç å™¨çš„é¢„æµ‹è½¨è¿¹ï¼Œä»¥åŠèƒŒæ™¯ä¿¡æ¯ä½œä¸ºè¾“å…¥ï¼Œæ¥é¢„æµ‹å½“å‰çº§åˆ«ä¸‹ä»£ç†çš„è½¨è¿¹ã€‚</p><p>æ­¤å¤–ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªå­¦ä¹ è¿‡ç¨‹ï¼Œé€šè¿‡è§„èŒƒåŒ–ä»£ç†çš„è½¨è¿¹æ¥é¿å…ä¸ä¸Šä¸€çº§å…¶ä»–ä»£ç†çš„è½¨è¿¹å‘ç”Ÿç¢°æ’ï¼ŒåŒæ—¶ä¹Ÿç¡®ä¿æ¥è¿‘äºäººç±»é©¾é©¶æ•°æ®ã€‚</p><p>æœ¬æ–‡è´¡çŒ®ï¼š</p><ol><li>æˆ‘ä»¬æå‡ºäº†GameFormerï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäºTransformerçš„äº¤äº’é¢„æµ‹å’Œè§„åˆ’æ¡†æ¶ï¼Œåˆ©ç”¨åˆ†å±‚æ¨ç†æ¥å»ºæ¨¡agentä¹‹é—´çš„äº¤äº’ã€‚</li><li>æˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªå­¦ä¹ è¿‡ç¨‹ï¼ŒåŸºäºlevel-kåšå¼ˆæ¥è®­ç»ƒè¯¥æ¡†æ¶ã€‚</li><li>åœ¨Waymoäº¤äº’é¢„æµ‹çš„benchmarkä¸­è·å¾—SOTA</li><li>æˆ‘ä»¬éªŒè¯äº†è¯¥æ¡†æ¶åœ¨å¼€ç¯é©¾é©¶åœºæ™¯å’Œé—­ç¯æ¨¡æ‹Ÿä¸­çš„è§„åˆ’æ€§èƒ½ï¼Œå¹¶ç ”ç©¶äº†åšå¼ˆè®ºè®¾ç½®çš„å½±å“ã€‚</li></ol><h2 id="methodology-game-former">Methodologyï¼ˆGame Formerï¼‰</h2><p>æå‡ºçš„æ¡†æ¶ä»ä»£ç†äº¤äº’çš„å±‚æ¬¡åšå¼ˆæ¨¡å‹ä¸­å¾—åˆ°å¯å‘ã€‚è¯¥æ¡†æ¶é€šè¿‡åŸºäºè½¬æ¢å™¨çš„ç¼–ç å™¨å°†ä»£ç†å’Œåœ°å›¾çš„å†å²çŠ¶æ€ç¼–ç ä¸ºèƒŒæ™¯ä¿¡æ¯ã€‚åŸºäºåˆå§‹æ¨¡æ€æŸ¥è¯¢ï¼Œ0çº§ä»£ç†çš„æœªæ¥è½¨è¿¹è¢«ç‹¬ç«‹è§£ç ã€‚åœ¨level-kï¼Œä¸€ä¸ªä»£ç†å“åº”level-(k-1)çš„æ‰€æœ‰å…¶ä»–ä»£ç†ã€‚0çº§è§£ç å™¨ä½¿ç”¨æ¨¡æ€åµŒå…¥å’Œä»£ç†å†å²ç¼–ç ä½œä¸ºæŸ¥è¯¢è¾“å…¥ï¼Œä»¥ç‹¬ç«‹è§£ç 0çº§ä»£ç†çš„æœªæ¥è½¨è¿¹å’Œåˆ†æ•°ã€‚kçº§è§£ç å™¨åŒ…å«ä¸€ä¸ªè‡ªæˆ‘å…³æ³¨æ¨¡å—ï¼Œä»¥æ¨¡æ‹Ÿåœ¨level-(k-1)çº§çš„æœªæ¥äº¤äº’ï¼Œå¹¶å°†è¯¥ä¿¡æ¯é™„åŠ åˆ°åœºæ™¯ä¸Šä¸‹æ–‡ç¼–ç ä¸­ã€‚<br><img src="https://picture.fanfer.top/img/gameformer2.png" alt="Gameformer2"></p><p>GameFormeræ¶æ„ï¼ˆEncoder-Decoderï¼‰</p><p><img src="https://picture.fanfer.top/img/gameformer3.png" alt="Gameformer3"></p><h2 id="experiments">Experiments</h2><p><strong>open-loop and closed-loop</strong></p><p>close-loopæ˜¯ä¸€ä¸ªåŠ¨ä½œè¿›è¡Œä¸€æ¬¡äº¤äº’ï¼Œå¾—åˆ°æ–°çš„çŠ¶æ€ã€‚</p><p>open-loopæ˜¯æŒ‡è§‚å¯Ÿç¬¬ä¸€ä¸ªçŠ¶æ€ï¼Œç„¶åè¿”å›ä¸€ç³»åˆ—åŠ¨ä½œï¼Œè¿™äº›éƒ½æ˜¯agentè‡ªå·±æƒ³çš„ã€‚</p><p>æ•°æ®é›†ï¼šWaymo Open Motion Dataset(åŒ…å«1200hçœŸå®é©¾é©¶æ•°æ®)<br>ç»™å®šæ™ºèƒ½ä½“è¿‡å» 1 ç§’åœ¨ç›¸åº”åœ°å›¾ä¸Šçš„è½¨è¿¹ï¼Œé¢„æµ‹æœ€å¤š 8 åæ™ºèƒ½ä½“æœªæ¥ 8 ç§’çš„ä½ç½®ã€‚<br>æµ‹è¯•é›†çš„çœŸå®æœªæ¥æ•°æ®éšè—ã€‚å› æ­¤ï¼Œæµ‹è¯•é›†ä»…åŒ…å« 1 ç§’çš„å†å²æ•°æ®ã€‚<br>éªŒè¯é›†åŒ…å«ç”¨äºæ¨¡å‹å¼€å‘çš„çœŸå®æœªæ¥æ•°æ®ã€‚<br>æ­¤å¤–ï¼Œæµ‹è¯•é›†å’ŒéªŒè¯é›†è¿˜æä¾›äº†è¦é¢„æµ‹çš„åœºæ™¯ä¸­æœ€å¤š 8 ä¸ªå¯¹è±¡è½¨è¿¹çš„åˆ—è¡¨ã€‚</p><p>æ‰€æœ‰æŒ‡æ ‡éƒ½æ˜¯é€šè¿‡é¦–å…ˆå°†æ‰€æœ‰å¯¹è±¡å­˜å‚¨åˆ°å¯¹è±¡ç±»å‹ä¸­æ¥è®¡ç®—çš„ã€‚ç„¶åæŒ‰ç±»å‹è®¡ç®—æŒ‡æ ‡ã€‚æ¯ç§å¯¹è±¡ç±»å‹çš„æŒ‡æ ‡ï¼ˆminiADEã€miniFDEã€Miss Rateã€å’Œ mAPï¼‰å‡åœ¨ 3ã€5 å’Œ 8 ç§’æ—¶é—´ç‚¹å¤„è®¡ç®—</p>]]></content>
      
      
      <categories>
          
          <category> è®ºæ–‡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬”è®° </tag>
            
            <tag> è®ºæ–‡ </tag>
            
            <tag> iccv </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VoxelNet</title>
      <link href="/2023/07/21/VoxelNet/"/>
      <url>/2023/07/21/VoxelNet/</url>
      
        <content type="html"><![CDATA[<h2 id="abstract">Abstract</h2><p>æœ¬æ–‡æ¶ˆé™¤äº†å¯¹3Dç‚¹äº‘çš„æ‰‹åŠ¨ç‰¹å¾å·¥ç¨‹çš„éœ€è¦ï¼Œæå‡ºäº†VoxelNetï¼Œå°†ç‰¹å¾æå–å’Œbounding boxç»Ÿä¸€åˆ°å•ä¸ªé˜¶æ®µã€ç«¯åˆ°ç«¯çš„å¯è®­ç»ƒæ·±åº¦ç½‘ç»œä¸­ã€‚</p><p>VoxelNetå°†ç‚¹äº‘åˆ’åˆ†ä¸ºç­‰è·çš„3Dä½“ç´ ï¼Œé€šè¿‡å¼•å…¥æé€Ÿç‰¹å¾ç¼–ç ï¼ˆVFEï¼‰å±‚å°†æ¯ä¸ªä½“ç´ å†…çš„ä¸€ç»„ç‚¹è½¬åŒ–ä¸ºç»Ÿä¸€çš„ç‰¹å¾è¡¨ç¤ºã€‚</p><h2 id="introduction">Introduction</h2><p>é’ˆå¯¹ç°åœ¨å¯¹äº3Dç‚¹äº‘è¿˜éœ€è¦æ‰‹åŠ¨ç‰¹å¾å·¥ç¨‹çš„éœ€æ±‚ï¼Œæˆ‘ä»¬æå‡ºäº†VoxelNetï¼šè¿™æ˜¯ä¸€ä¸ªé€šç”¨çš„3Dæ£€æµ‹æ¡†æ¶ï¼Œå®ƒä»¥ç«¯åˆ°ç«¯çš„æ–¹å¼åŒæ—¶ä»ç‚¹äº‘ä¸­å­¦ä¹ æœ‰åŒºåˆ«çš„ç‰¹å¾è¡¨ç¤ºï¼Œå¹¶é¢„æµ‹ç²¾ç¡®çš„3Dè¾¹ç•Œæ¡†</p><p><strong>ä¸»è¦è´¡çŒ®ï¼š</strong></p><ol><li>æˆ‘ä»¬æå‡ºäº†ä¸€ç§æ–°çš„ç«¯åˆ°ç«¯å¯è®­ç»ƒçš„æ·±åº¦æ¶æ„ï¼Œç”¨äºåŸºäºç‚¹äº‘çš„ä¸‰ç»´æ£€æµ‹VoxelNetï¼Œç›´æ¥åœ¨ç¨€ç–çš„ä¸‰ç»´ç‚¹ä¸Šæ“ä½œï¼Œé¿å…äº†äººå·¥ç‰¹å¾å·¥ç¨‹å¼•å…¥çš„ä¿¡æ¯ç“¶é¢ˆã€‚</li><li>æˆ‘ä»¬æå‡ºäº†ä¸€ç§æœ‰æ•ˆçš„æ–¹æ³•æ¥å®ç°ä½“ç´ ç½‘ï¼Œå®ƒæ—¢å—ç›Šäºç¨€ç–ç‚¹ç»“æ„ï¼Œåˆå—ç›Šäºä½“ç´ ç½‘æ ¼ä¸Šçš„é«˜æ•ˆå¹¶è¡Œå¤„ç†ã€‚</li><li>æˆ‘ä»¬åœ¨KITTI benchmarkä¸Šè¿›è¡Œå®éªŒï¼Œç»“æœè¡¨æ˜ï¼Œåœ¨åŸºäºæ¿€å…‰é›·è¾¾çš„æ±½è½¦ã€è¡Œäººå’Œè‡ªè¡Œè½¦æ£€æµ‹åŸºå‡†ä¸­ï¼ŒVoxelNetäº§ç”Ÿäº†SOTAç»“æœ</li></ol><h2 id="methodology">Methodology</h2><p>åˆ†ä¸ºä¸‰ä¸ªåŠŸèƒ½æ¨¡å—ï¼šç‰¹å¾å­¦ä¹ ç½‘ç»œã€å·ç§¯ç¥ç»ç½‘ç»œã€åŒºåŸŸæå–ç½‘ç»œ</p><p><img src="https://picture.fanfer.top/img/voxnet1.png" alt="Untitled"></p><p>ç‰¹å¾å­¦ä¹ ç½‘ç»œå°†åŸå§‹ç‚¹äº‘ä½œä¸ºè¾“å…¥ï¼Œå°†ç©ºé—´åˆ’åˆ†ä¸ºä½“ç´ ï¼Œå¹¶å°†æ¯ä¸ªä½“ç´ å†…çš„ç‚¹è½¬æ¢ä¸ºè¡¨å¾å½¢çŠ¶ä¿¡æ¯çš„çŸ¢é‡è¡¨ç¤ºã€‚è¿™ä¸ªç©ºé—´è¢«è¡¨ç¤ºä¸ºä¸€ä¸ªç¨€ç–çš„4Då¼ é‡ã€‚å·ç§¯ä¸­é—´å±‚å¤„ç†4Då¼ é‡ä»¥èšé›†ç©ºé—´ä¸Šä¸‹æ–‡ã€‚æœ€åï¼ŒRPNç”Ÿæˆ3Dæ£€æµ‹</p><aside>ğŸ’¡ RPNï¼šRegion Proposal NetworkåŒºåŸŸç”Ÿæˆç½‘ç»œï¼Œç”¨æ¥æå–å€™é€‰æ¡†</aside><h3 id="feature-learning-network">Feature Learning Network</h3><ol><li><p>åˆ’åˆ†ä½“ç´ ï¼Œå°†æ•´ä¸ªç©ºé—´åˆ’åˆ†æˆå¤§å°ç›¸åŒçš„Voxel</p></li><li><p>åˆ†ç»„ï¼Œå°†æ¿€å…‰é›·è¾¾ç‚¹åˆ†é…åˆ°ç›¸åº”çš„Voxelä¸­ï¼Œç”±äºé›·è¾¾çš„ç¨€ç–å’Œä¸å‡åŒ€é‡‡æ ·ï¼Œä¸åŒçš„ä½“ç´ åŒ…å«æ•°é‡å¯å˜çš„æ¿€å…‰é›·è¾¾ç‚¹ã€‚</p></li><li><p>éšæœºé‡‡æ ·ã€‚ä»åŒ…å«è¶…è¿‡Tä¸ªç‚¹çš„ä½“ç´ ä¸­éšæœºæŠ½å–å›ºå®šæ•°é‡Tçš„ç‚¹ã€‚è¿™ä¸ªç­–ç•¥æœ‰ä¸¤ä¸ªç›®çš„ï¼š(1)èŠ‚çœè®¡ç®—èµ„æº (2)å‡å°‘äº†ä½“ç´ ä¹‹é—´ç‚¹çš„æ•°é‡çš„ä¸å‡è¡¡ï¼Œå‡å°‘äº†é‡‡æ ·åå·®ï¼Œå¢åŠ äº†æ›´å¤šçš„å˜åŒ–ã€‚</p></li><li><p><strong>ä½“ç´ ç‰¹å¾ç¼–ç  ï¼ˆstacked Voxel feature encodingï¼‰</strong></p><p><img src="https://picture.fanfer.top/img/voxnet2.png" alt="Untitled"></p><p><img src="https://picture.fanfer.top/img/voxnet3.png" alt="Untitled"></p><p>ä¸Šå›¾ä¸­Voxelæœ‰3ä¸ªç‚¹äº‘æ•°æ®ã€‚ä½œè€…å…ˆç”¨ä¸€ä¸ªFCNå±‚ï¼ˆå°è±¡ä¸­FCNæŒ‡çš„æ˜¯å…¨å·ç§¯å±‚ï¼Œä½†è¿™é‡ŒæŒ‡çš„æ˜¯å…¨è¿æ¥å±‚ï¼‰æå–è¿™3ä¸ªç‚¹äº‘æ•°æ®çš„ç‰¹å¾ï¼Œè·å¾—3ä¸ªPoint-wise Featureã€‚</p><p>å› ä¸ºè¿™ä¸ªæ“ä½œæ˜¯<strong>é€ç‚¹è¿ç®—</strong>çš„ï¼Œå¹¶æ²¡æœ‰å¼•å…¥ç‚¹ä¸ç‚¹ä¹‹é—´çš„å…³ç³»ï¼Œä¹Ÿå°±æ˜¯local featureã€‚ä½œè€…åœ¨æ­¤åŸºç¡€ä¸Šå¼•å…¥Element-wise maxpoolï¼Œè·å¾—<strong>Locally Aggregated Featureã€‚<strong>Locally Aggregated Featureååº”äº†è¿™äº›ç‚¹çš„ä¸€ä¸ª</strong>å±€éƒ¨</strong>å…³ç³»ã€‚</p><p>ä½œè€…å°†<strong>Point-wise Feature</strong>å’Œ<strong>Locally Aggregated Feature</strong>è¿›è¡Œäº†ç®€å•çš„<strong>å †å èåˆ</strong>ï¼Œä½œä¸ºä¸‹ä¸€ä¸ªVFEå±‚çš„è¾“å…¥ã€‚</p><p>è¿™æ ·è¿ç»­å †å å‡ æ¬¡VFEå±‚åï¼Œå°±è·å¾—æ›´ä¸°å¯Œçš„ç‰¹å¾è¡¨ç¤ºã€‚æœ€åï¼Œä½¿ç”¨ä¸€ä¸ªElement-wise maxpoolè·å¾—æœ€åçš„ä¸€ä¸ªVoxel-wise Featureã€‚ä¹Ÿå°±æ˜¯ç¬¬ä¸€å¼ å›¾ç‰‡ä¸­çš„è¿™ä¸ªéƒ¨åˆ†</p><p><img src="https://picture.fanfer.top/img/voxnet4.png" alt="Untitled"></p><p>ç”¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>F</mi><mi>E</mi><mo>âˆ’</mo><mi>i</mi><mo stretchy="false">(</mo><msub><mi>c</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><msub><mi>c</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">VFE-i(c_{in},c_{out})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">i</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>è¡¨ç¤ºç¬¬iä¸ªVFEå±‚ï¼Œè¯¥å±‚å°†ç»´åº¦cinçš„è¾“å…¥ç‰¹å¾è½¬æ¢ä¸ºç»´åº¦coutçš„è¾“å‡ºç‰¹å¾ã€‚çº¿æ€§å±‚å­¦ä¹ ä¸€ä¸ªå¤§å°ä¸ºcin *(cout/2)çš„çŸ©é˜µï¼Œé€ç‚¹æ‹¼æ¥äº§ç”Ÿç»´æ•°ä¸ºcoutçš„è¾“å‡ºã€‚</p></li><li><p>Sparse Tensor Representationï¼šä»…ä»…å¤„ç†éç©ºä½“ç´ ï¼Œè·å¾—äº†ä½“ç´ ç‰¹å¾åˆ—è¡¨ï¼Œæ˜¯ä¸€ä¸ª4D çš„ç¨€ç–å¼ é‡ ç”±äºå¤§é‡çš„æ˜¯ç©ºä½“ç´ ï¼Œå› æ­¤å¤§å¤§å‡å°‘äº†å†…å­˜ä½¿ç”¨å’Œè®¡ç®—æˆæœ¬</p></li></ol><p><strong>è¡¥å……Mask</strong></p><p>ç”±äºä½“ç´ å…·æœ‰æ•°é‡å¯å˜çš„ç‚¹ï¼Œå› æ­¤é€šè¿‡maskçš„æ–¹å¼ï¼Œè¿›è¡Œå¤„ç†åå†äº¤ç»™gpuè¿ç®—ã€‚</p><p><img src="https://picture.fanfer.top/img/voxnet5.png" alt="Untitled"></p><p>é¦–å…ˆåˆå§‹åŒ–ä¸€ä¸ªK<em>T</em>7çš„å¼ é‡æ¥å­˜å‚¨ä½“ç´ è¾“å…¥ç‰¹å¾ï¼ŒKæ˜¯éç©ºä½“ç´ çš„æœ€å¤§æ•°é‡ï¼ŒTæ˜¯æ¯ä¸ªä½“ç´ çš„æœ€å¤§çš„ç‚¹æ•°ï¼Œ7æ˜¯æ¯ä¸ªç‚¹çš„è¾“å…¥ç¼–ç çš„ç»´åº¦ã€‚</p><p>æ³¨æ„å†å®ŒæˆVFEçš„è¿æ¥åï¼Œå°†ç©ºç‚¹æ‰€å¯¹åº”çš„ç‰¹å¾é‡ç½®ä¸º0.</p><h3 id="convolutional-middle-layers">Convolutional Middle Layers</h3><p>ç‚¹äº‘æ•°æ®é€šè¿‡ç‰¹å¾å­¦ä¹ ç½‘ç»œåå¯ä»¥è¢«è¡¨ç¤ºæˆä¸€ä¸ª<strong>ç¨€ç–çš„4Då¼ é‡</strong>ï¼Œç»´åº¦è®°åšï¼ˆC,Dâ€²,Hâ€²,Wâ€²ï¼‰Â ã€‚å…¶ä¸­ï¼ŒÂ CÂ ä¸ºVoxel-wise Featureçš„å‘é‡ç»´åº¦ï¼ˆä¹Ÿå°±æ˜¯å›¾3ä¸­å‘é‡çš„é«˜åº¦ï¼‰ï¼ŒÂ Dâ€²,Hâ€²,Wâ€²Â ä¸ºç©ºé—´çš„æ·±åº¦ã€é«˜åº¦å’Œå®½åº¦ï¼ˆå•ä½ä¸ºVoxelæ•°é‡ï¼‰ã€‚</p><p>å› ä¸ºå¼ é‡æ˜¯4ç»´çš„ï¼Œä½œè€…å°±ç”¨3Då·ç§¯æ¥æ„å»ºè¿™ä¸ªä¸­é—´å·ç§¯å±‚ã€‚ç›®çš„æ˜¾ç„¶æ˜¯ä¸ºäº†æ‰©å¤§æ„Ÿå—é‡ï¼Œå¢åŠ æ›´å¤šçš„ä¿¡æ¯æè¿°ã€‚</p><h3 id="region-proposal-network">Region Proposal Network</h3><p><img src="https://picture.fanfer.top/img/voxnet6.png" alt="Untitled"></p><p>RPNå±‚åœ¨2Dç‰©ä½“æ£€æµ‹ä¸­å±‚å‡ºä¸ç©·ï¼Œæ—©åœ¨Faster-RCNNä¸­å°±è¢«æå‡ºæ¥äº†ã€‚RPNå±‚ä¸»è¦ç”¨æ¥æ ¹æ®å­¦ä¹ åˆ°çš„ç‰¹å¾ï¼Œå¹¶ç»“åˆAnchorï¼Œåœ¨åŸå›¾ä¸­æ‰¾åˆ°ç‰©ä½“æ‰€åœ¨<strong>æ£€æµ‹æ¡†</strong>å’Œ<strong>å¯¹åº”çš„ç±»åˆ«</strong>ã€‚</p><p>ä¸€èˆ¬è€Œè¨€ï¼ŒRPNå±‚æœ‰ä¸¤ä¸ªåˆ†æ”¯ï¼Œä¸€ä¸ªç”¨æ¥è¾“å‡º<strong>ç±»åˆ«çš„æ¦‚ç‡åˆ†å¸ƒ</strong>ï¼ˆé€šå¸¸å«åšScore Mapï¼‰ï¼Œä¸€ä¸ªç”¨æ¥è¾“å‡º<strong>Anchoråˆ°çœŸå®æ¡†çš„å˜åŒ–è¿‡ç¨‹</strong>ï¼ˆé€šå¸¸å«åš Regression Mapï¼‰</p><p>ä½œè€…æå‡ºçš„RPNå±‚çš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚è¯¥ç½‘ç»œä»¥ä¸­é—´å·ç§¯å±‚çš„è¾“å‡ºç‰¹å¾å›¾ä¸ºè¾“å…¥ï¼Œåˆ†åˆ«ç»è¿‡ä¸‰æ¬¡ä¸‹é‡‡æ ·ï¼ˆæ¯æ¬¡stride=2ï¼‰è·å¾—ä¸‰ä¸ªä¸åŒç»´åº¦çš„ç‰¹å¾å›¾ã€‚ä½œè€…å°†è¿™ä¸ªä¸‰ä¸ªç‰¹å¾å›¾ç¼©æ”¾è‡³åŒä¸€ç»´åº¦åè¿›è¡Œæ‹¼æ¥ï¼Œæœ‰ç‚¹FPNï¼ˆç‰¹å¾é‡‘å­—å¡”ç½‘ç»œï¼‰çš„æ„Ÿè§‰ã€‚æœ€åï¼Œæ‹¼æ¥çš„ç‰¹å¾è¢«æ˜ å°„æˆä¸¤ä¸ªè¾“å‡ºç‰¹å¾å›¾</p><h2 id="æŸå¤±å‡½æ•°">æŸå¤±å‡½æ•°</h2><p>ä½œè€…å¼•å…¥äº†<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">n_{pos}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>ä¸ªæ­£anchorå’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mrow><mi>n</mi><mi>e</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N_{neg}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>ä¸ªè´Ÿanchorã€‚ä¸€ä¸ªgt-3D æ£€æµ‹æ¡†å¯ä»¥ç”¨ä¸€ä¸ª7ç»´å‘é‡è¡¨ç¤ºï¼Œåˆ†åˆ«æ˜¯<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>c</mi><mi>g</mi></msubsup><mo separator="true">,</mo><msubsup><mi>y</mi><mi>c</mi><mi>g</mi></msubsup><mo separator="true">,</mo><msubsup><mi>z</mi><mi>c</mi><mi>g</mi></msubsup><mo separator="true">,</mo><msup><mi>l</mi><mi>g</mi></msup><mo separator="true">,</mo><msup><mi>w</mi><mi>g</mi></msup><mo separator="true">,</mo><msup><mi>h</mi><mi>g</mi></msup><mo separator="true">,</mo><msup><mi>Î¸</mi><mi>g</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_c^g,y_c^g,z_c^g,l^g,w^g,h^g,\theta^g)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.4530000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.å‰ä¸‰é¡¹æ˜¯æ¡†çš„ä¸­å¿ƒåæ ‡ç‚¹ï¼Œç„¶åæ˜¯é•¿å®½é«˜ï¼Œæœ€åæ˜¯ç»•Zè½´çš„åèˆªè§’</p><p>å‡è®¾ä¸gt-bboxåŒ¹é…çš„positive anchorçš„å‚æ•°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>c</mi><mi>a</mi></msubsup><mo separator="true">,</mo><msubsup><mi>y</mi><mi>c</mi><mi>a</mi></msubsup><mo separator="true">,</mo><msubsup><mi>z</mi><mi>c</mi><mi>a</mi></msubsup><mo separator="true">,</mo><msup><mi>l</mi><mi>a</mi></msup><mo separator="true">,</mo><msup><mi>w</mi><mi>a</mi></msup><mo separator="true">,</mo><msup><mi>h</mi><mi>a</mi></msup><mo separator="true">,</mo><msup><mi>Î¸</mi><mi>a</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_c^a,y_c^a,z_c^a,l^a,w^a,h^a,\theta^a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.4530000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ã€‚é‚£ä¹ˆRPNå±‚ä¸­çš„regressionåˆ†æ”¯è¦å­¦çš„ä¸œè¥¿ï¼Œå°±æ˜¯ä»positive anchoråˆ°gt-bboxçš„å˜åŒ–è¿‡ç¨‹å‚æ•°ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p><p><img src="https://picture.fanfer.top/img/voxnet7.png" alt="Untitled"></p><p>é‚£ä¹ˆæŸå¤±å‡½æ•°çš„å®šä¹‰ä¸»è¦åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œåˆ†åˆ«ä¸ºï¼ˆ1ï¼‰åˆ†ç±»æŸå¤±ï¼ˆ3ï¼‰ä¸Šè¿°7ä¸ªå‚æ•°çš„å›å½’æŸå¤±ã€‚</p><p>å…¶ä¸­åˆ†ç±»æŸå¤±åŒ…æ‹¬Positive anchorå’ŒNegative anchorçš„æŸå¤±ã€‚</p><p>å…·ä½“å®šä¹‰å¦‚ä¸‹ï¼š<br><img src="https://picture.fanfer.top/img/voxnet8.png" alt="Untitled"></p>]]></content>
      
      
      <categories>
          
          <category> è®ºæ–‡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬”è®° </tag>
            
            <tag> è®ºæ–‡ </tag>
            
            <tag> cvpr </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BEVFusion</title>
      <link href="/2023/06/06/BEVFusion/"/>
      <url>/2023/06/06/BEVFusion/</url>
      
        <content type="html"><![CDATA[<h1 id="bevfusion-multi-task-multi-sensor-fusion-with-unified-bird-s-eye-view-representation">BEVFusion: Multi-Task Multi-Sensor Fusion with Unified Birdâ€™s-Eye View Representation</h1><p>Author: MIT HanSong<br>Code: <a href="https://github.com/ADLab-AutoDrive/BEVFusion">https://github.com/ADLab-AutoDrive/BEVFusion</a><br>Comment: BEV , attention<br>Completed: December 11, 2022<br>Key Words: Fusion, Object Detection<br>Score: â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸<br>Source: CVPR2022</p><h2 id="abstract">Abstract</h2><p>å°†å¤šä¼ æ„Ÿå™¨èåˆå¯¹äºå‡†ç¡®å¯é çš„è‡ªåŠ¨é©¾é©¶ç³»ç»Ÿè‡³å…³é‡è¦ã€‚æœ€è¿‘æå‡ºçš„æ–¹æ³•åŸºäº<strong>ç‚¹çº§ï¼ˆpoint-levelï¼‰èåˆ</strong>ï¼šä½¿ç”¨æ‘„åƒå¤´ç‰¹å¾å¢å¼ºæ¿€å…‰é›·è¾¾ç‚¹äº‘ã€‚ç„¶è€Œï¼Œæ‘„åƒå¤´åˆ°æ¿€å…‰é›·è¾¾çš„æŠ•å½±ä¸¢å¼ƒäº†æ‘„åƒå¤´ç‰¹å¾çš„è¯­ä¹‰å¯†åº¦ï¼ˆsemantic densityï¼‰ï¼Œé˜»ç¢äº†æ­¤ç±»æ–¹æ³•çš„æœ‰æ•ˆæ€§ï¼Œå°¤å…¶æ˜¯å¯¹äºé¢å‘è¯­ä¹‰çš„ä»»åŠ¡ï¼ˆå¦‚3Dåœºæ™¯åˆ†å‰²ï¼‰ã€‚</p><p>æœ¬æ–‡æå‡ºçš„BEVFusionæ˜¯ä¸€ç§å¤šä»»åŠ¡å¤šä¼ æ„Ÿå™¨èåˆæ¡†æ¶ï¼Œå…¶ç»Ÿä¸€BEVè¡¨å¾ç©ºé—´ä¸­çš„å¤šæ¨¡æ€ç‰¹å¾ï¼Œå¾ˆå¥½åœ°ä¿ç•™äº†å‡ ä½•å’Œè¯­ä¹‰ä¿¡æ¯ã€‚ä¸ºå®ç°è¿™ä¸€ç‚¹ï¼Œä¼˜åŒ–BEVæ± åŒ–ï¼Œè¯Šæ–­å¹¶è§£é™¤è§†å›¾è½¬æ¢ä¸­çš„å…³é”®æ•ˆç‡ç“¶é¢ˆï¼Œå°†å»¶è¿Ÿå‡å°‘äº†40å€ã€‚BEVFusionä»æ ¹æœ¬ä¸Šæ¥è¯´æ˜¯ä»»åŠ¡æ— å…³çš„ï¼Œæ— ç¼æ”¯æŒä¸åŒçš„3Dæ„ŸçŸ¥ä»»åŠ¡ï¼Œå‡ ä¹æ²¡æœ‰æ¶æ„çš„æ›´æ”¹ã€‚</p><p>åœ¨nuScenesæ•°æ®é›†çš„3Dç›®æ ‡æ£€æµ‹ä¸Šå®ç°1.3%çš„mAPå’ŒNDSæå‡ï¼Œåœ¨BEVåˆ†å‰²ä¸Šå®ç°äº†13.6%çš„mIoUæå‡ï¼Œè®¡ç®—æˆæœ¬é™ä½äº†1.9å€ã€‚</p><h2 id="introduction">Introduction</h2><p>ç”¨è¯­ä¹‰æ ‡æ³¨ã€CNNç‰¹å¾æˆ–2Då›¾åƒä¸­çš„è™šæ‹Ÿç‚¹ï¼ˆvirtual pointsï¼‰æ¥å¢å¼ºæ¿€å…‰é›·è¾¾ç‚¹äº‘ï¼Œç„¶ååº”ç”¨ç°æœ‰åŸºäºæ¿€å…‰é›·è¾¾çš„æ£€æµ‹å™¨é¢„æµ‹3Dè¾¹æ¡†ã€‚å°½ç®¡è¿™äº›ç‚¹çº§èåˆæ–¹æ³•åœ¨å¤§è§„æ¨¡æ£€æµ‹åŸºå‡†ä¸Šè¡¨ç°å‡ºäº†å“è¶Šçš„æ€§èƒ½ï¼Œä½†å‡ ä¹ä¸é€‚ç”¨äºé¢å‘è¯­ä¹‰çš„ä»»åŠ¡ï¼Œå¦‚BEVåœ°å›¾åˆ†å‰²ã€‚è¿™æ˜¯å› ä¸ºæ‘„åƒå¤´åˆ°æ¿€å…‰é›·è¾¾çš„æŠ•å½±åœ¨è¯­ä¹‰ä¸Šæ˜¯æœ‰æŸçš„ï¼Œè€ŒBEB Fusionå°±æ˜¯æƒ³é¿å…è¿™ä¸ªå‡ ä½•å’Œè¯­ä¹‰çš„æŸå¤±ï¼Œå»ºç«‹BEVç‰¹å¾çš„èåˆè¡¨å¾ï¼Œå®ç°3Dè¯­ä¹‰ä»»åŠ¡ã€‚</p><p>å¦‚å›¾æ‰€ç¤ºï¼šå¯¹äºå…¸å‹çš„32çº¿æ¿€å…‰é›·è¾¾æ‰«æï¼Œåªæœ‰5%çš„æ‘„åƒå¤´ç‰¹å¾ä¸æ¿€å…‰é›·è¾¾ç‚¹åŒ¹é…ï¼Œè€Œå…¶ä»–æ‰€æœ‰ç‰¹å¾éƒ½å°†è¢«åˆ é™¤ã€‚å¯¹äºæ›´ç¨€ç–çš„æ¿€å…‰é›·è¾¾ï¼ˆæˆ–æˆåƒé›·è¾¾ï¼‰ï¼Œè¿™ç§å¯†åº¦å·®å¼‚å°†å˜å¾—æ›´åŠ å‰§çƒˆã€‚</p><p><img src="https://picture.fanfer.top/img/bevfusion1.png" alt="Untitled"></p><p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº†BEVFusion ä½¿ç”¨åŒä¸€ä¸ªBEVè§†å›¾æ¥è¡¨ç¤ºç©ºé—´ä¸­çš„å¤šæ¨¡æ€ç‰¹å¾ï¼ŒåŒæ—¶ä¿æŒäº†ç…§ç›¸æœºçš„è¯­ä¹‰å¯†åº¦å’Œæ¿€å…‰é›·è¾¾çš„ç©ºé—´ç‰¹å¾ï¼Œæ”¯æŒå¤§å¤šæ•°çš„3Dæ„ŸçŸ¥ä»»åŠ¡ï¼ŒåŒæ—¶å‘ç°è½¬åŒ–æ•ˆç‡çš„ç“¶é¢ˆä¸»è¦æ˜¯BEVæ± åŒ–æ“ä½œï¼Œå› æ­¤è®¾è®¡äº†å…·æœ‰é¢„è¿ç®—å’Œç¼©çŸ­é—´éš”çš„ä¸“ç”¨å†…æ ¸æ¥æ¶ˆé™¤ç“¶é¢ˆã€‚æœ€åä½¿ç”¨å…¨å·ç§¯BEVç¼–ç å™¨æ¥èåˆç»Ÿä¸€çš„BEVç‰¹å¾ï¼Œå¹¶æ·»åŠ ä»»åŠ¡ç‰¹å®šçš„æ£€æµ‹å¤´æ¥æ”¯æŒä¸åŒçš„ä»»åŠ¡ã€‚</p><h2 id="methodology">Methodology</h2><p><img src="https://picture.fanfer.top/img/bevfusion2.png" alt="Untitled"></p><p>BEVFusionä»å¤šæ¨¡æ€è¾“å…¥ä¸­æå–ç‰¹å¾ï¼Œå¹¶é€šè¿‡è§†å›¾è½¬æ¢è½¬æ¢æˆBEVç©ºé—´ï¼Œå°†ç»Ÿä¸€çš„BEVç‰¹å¾å’Œå…¨å·ç§¯BEVç¼–ç å™¨èåˆåœ¨ä¸€èµ·ï¼Œå¹¶æ”¯æŒå…·æœ‰ç‰¹å®šä»»åŠ¡å¤´çš„ä¸åŒä»»åŠ¡ã€‚</p><blockquote><p><strong>BEVFusion Pipline:</strong></p><ol><li>å¯¹äºä¸åŒçš„æ¨¡æ€çš„æ•°æ®é‡‡ç”¨ä¸åŒçš„ç‰¹å¾æå–å™¨æå–ç‰¹å¾</li><li>å°†å¤šæ¨¡æ€çš„ç‰¹å¾è½¬åŒ–æˆåŒä¸€ä¸ªå…±äº«BEVç©ºé—´ä¸­ï¼ŒåŒæ—¶ä¿ç•™äº†ç©ºé—´å‡ ä½•ä¿¡æ¯å’Œä¸°å¯Œçš„è¯­ä¹‰ä¿¡æ¯</li><li>ä½¿ç”¨é¢„è®¡ç®—å’Œç¼©çŸ­é—´éš”æ¥æ¶ˆé™¤è§†å›¾è½¬æ¢è¿‡ç¨‹ä¸­çš„æ•ˆç‡ç“¶é¢ˆï¼ŒåŠ é€ŸBEVæ± åŒ–</li><li>å¯¹BEVç‰¹å¾ä½¿ç”¨åŸºäºå·ç§¯çš„ç¼–ç å™¨</li><li>é’ˆå¯¹ä¸åŒçš„ä»»åŠ¡ä½¿ç”¨ä¸åŒçš„æ£€æµ‹å¤´</li></ol></blockquote><h3 id="unified-represetation">Unified Represetation</h3><p>é‡‡ç”¨BEVä½œä¸ºèåˆçš„ç»Ÿä¸€è¡¨å¾ï¼Œè¯¥è§†å›¾å¯¹å‡ ä¹æ‰€æœ‰æ„ŸçŸ¥ä»»åŠ¡éƒ½å¾ˆå‹å¥½ï¼Œå› ä¸ºè¾“å‡ºç©ºé—´ä¹Ÿåœ¨BEVã€‚æ›´é‡è¦çš„æ˜¯ï¼Œåˆ°BEVçš„è½¬æ¢åŒæ—¶ä¿æŒäº†å‡ ä½•ç»“æ„ï¼ˆæ¥è‡ªæ¿€å…‰é›·è¾¾ç‰¹å¾ï¼‰å’Œè¯­ä¹‰å¯†åº¦ï¼ˆæ¥è‡ªæ‘„åƒå¤´ç‰¹å¾ï¼‰ã€‚ä¸€æ–¹é¢ï¼ŒLiDARåˆ°BEVæŠ•å½±å°†ç¨€ç–LiDARç‰¹å¾æ²¿é«˜åº¦ç»´åº¦ï¼ˆheight dimensionï¼‰å±•å¹³ï¼Œå› æ­¤ä¸ä¼šäº§ç”Ÿå‡ ä½•å¤±çœŸã€‚å¦ä¸€æ–¹é¢ï¼Œæ‘„åƒå¤´åˆ°BEVæŠ•å½±å°†æ¯ä¸ªæ‘„åƒå¤´ç‰¹å¾åƒç´ æŠ•å°„å›3Dç©ºé—´çš„ä¸€æ¡å…‰çº¿ä¸­ï¼ˆray castingï¼‰ï¼Œè¿™å¯ä»¥ç”Ÿæˆå¯†é›†çš„BEVç‰¹å¾å›¾ï¼Œå¹¶ä¿ç•™äº†æ‘„åƒå¤´çš„å…¨éƒ¨è¯­ä¹‰ä¿¡æ¯ã€‚</p><h3 id="camera-to-bev-transformation">Camera-to-BEV Transformation</h3><p>æ‘„åƒå¤´åˆ°BEVçš„å˜æ¢éå¸¸é‡è¦ï¼Œå› ä¸ºä¸æ¯ä¸ªæ‘„åƒå¤´å›¾åƒç‰¹å¾åƒç´ å…³è”çš„æ·±åº¦ï¼ˆdepthï¼‰æœ¬è´¨ä¸Šæ˜¯ä¸æ˜ç¡®çš„ã€‚æ ¹æ®LSSï¼Œæ˜ç¡®é¢„æµ‹æ¯ä¸ªåƒç´ çš„ç¦»æ•£æ·±åº¦åˆ†å¸ƒã€‚ç„¶åï¼Œæ²¿ç€æ‘„åƒå¤´å…‰çº¿å°†æ¯ä¸ªç‰¹å¾åƒç´ åˆ†æ•£æˆDä¸ªç¦»æ•£ç‚¹ï¼Œå¹¶æ ¹æ®ç›¸åº”çš„æ·±åº¦æ¦‚ç‡é‡ç¼©æ”¾ï¼ˆrescaleï¼‰ç›¸å…³ç‰¹å¾ã€‚è¿™å°†ç”Ÿæˆå¤§å°ä¸ºN<strong>H</strong>W*Dçš„æ‘„åƒå¤´ç‰¹å¾ç‚¹äº‘ï¼Œå…¶ä¸­Næ˜¯æ‘„åƒå¤´æ•°ï¼Œï¼ˆHï¼ŒWï¼‰æ˜¯æ‘„åƒå¤´ç‰¹å¾å›¾å¤§å°ã€‚æ­¤ç±»3Dç‰¹å¾ç‚¹äº‘æ²¿xã€yè½´é‡åŒ–ï¼Œæ­¥é•¿ä¸ºrï¼ˆä¾‹å¦‚ï¼Œ0.4mï¼‰ã€‚ç”¨BEVæ± åŒ–æ“ä½œæ¥èšåˆæ¯ä¸ªrÃ—r BEVç½‘æ ¼å†…çš„æ‰€æœ‰ç‰¹å¾ï¼Œå¹¶æ²¿zè½´å±•å¹³ç‰¹å¾</p><p>è™½ç„¶ç®€å•ï¼Œä½†BEVæ± åŒ–çš„æ•ˆç‡å’Œé€Ÿåº¦æƒŠäººåœ°ä½ï¼Œåœ¨RTX 3090 GPUä¸Šéœ€è¦500æ¯«ç§’ä»¥ä¸Šï¼ˆè€Œæ¨¡å‹çš„å…¶ä½™éƒ¨åˆ†è®¡ç®—åªéœ€è¦100æ¯«ç§’å·¦å³ï¼‰ã€‚è¿™æ˜¯å› ä¸ºæ‘„åƒå¤´ç‰¹å¾ç‚¹äº‘éå¸¸å¤§ï¼Œå³å…¸å‹çš„å·¥ä½œè´Ÿè½½ï¼Œæ¯å¸§å¯èƒ½ç”Ÿæˆçº¦200ä¸‡ä¸ªç‚¹ï¼Œæ¯”æ¿€å…‰é›·è¾¾ç‰¹å¾ç‚¹äº‘å¯†åº¦é«˜ä¸¤ä¸ªæ•°é‡çº§ã€‚ä¸ºäº†æ¶ˆé™¤è¿™ä¸€æ•ˆç‡ç“¶é¢ˆï¼Œå»ºè®®é€šè¿‡é¢„è®¡ç®—å’Œé—´æ­‡é™ä½æ¥ä¼˜åŒ–BEVæ± åŒ–è¿›ç¨‹ã€‚</p><p><img src="https://picture.fanfer.top/img/bevfusion3.png" alt="Untitled"></p><p>å¦‚å›¾æ‰€ç¤ºï¼šæ‘„åƒæœºåˆ°BEVå˜æ¢ï¼ˆaï¼‰æ˜¯åœ¨ç»Ÿä¸€çš„BEVç©ºé—´è¿›è¡Œä¼ æ„Ÿå™¨èåˆçš„å…³é”®æ­¥éª¤ã€‚ç„¶è€Œï¼Œç°æœ‰çš„å®ç°é€Ÿåº¦éå¸¸æ…¢ï¼Œå•ä¸ªåœºæ™¯å¯èƒ½éœ€è¦2ç§’çš„æ—¶é—´ã€‚æ–‡ç« æå‡ºäº†æœ‰æ•ˆçš„BEVæ± åŒ–æ–¹æ³•ï¼ˆbï¼‰ï¼Œé€šè¿‡é¢„è®¡ç®—ä½¿é—´æ­‡é™ä½å’ŒåŠ å¿«ç½‘æ ¼å…³è”ï¼Œè§†å›¾è½¬æ¢æ¨¡å—ï¼ˆcï¼Œdï¼‰çš„æ‰§è¡Œé€Ÿåº¦æé«˜äº†40å€</p><h3 id="é¢„è®¡ç®—">é¢„è®¡ç®—</h3><p>BEVæ± åŒ–çš„ç¬¬ä¸€æ­¥æ˜¯å°†æ‘„åƒå¤´ç‰¹å¾ç‚¹äº‘çš„æ¯ä¸ªç‚¹ä¸BEVç½‘æ ¼ç›¸å…³è”ã€‚ä¸æ¿€å…‰é›·è¾¾ç‚¹äº‘ä¸åŒï¼Œæ‘„åƒå¤´ç‰¹å¾ç‚¹äº‘çš„åæ ‡æ˜¯å›ºå®šçš„ï¼ˆåªè¦æ‘„åƒå¤´å†…å‚å¤–å‚ä¿æŒä¸å˜ï¼Œé€šå¸¸åœ¨é€‚å½“æ ‡å®šåï¼‰ã€‚åŸºäºæ­¤ï¼Œé¢„è®¡ç®—æ¯ä¸ªç‚¹çš„3Dåæ ‡å’ŒBEVç½‘æ ¼ç´¢å¼•ã€‚è¿˜æœ‰ï¼Œæ ¹æ®ç½‘æ ¼ç´¢å¼•å¯¹æ‰€æœ‰ç‚¹è¿›è¡Œæ’åºï¼Œå¹¶è®°å½•æ¯ä¸ªç‚¹æ’åã€‚åœ¨æ¨ç†è¿‡ç¨‹ä¸­ï¼Œåªéœ€è¦æ ¹æ®é¢„è®¡ç®—çš„æ’åºå¯¹æ‰€æœ‰ç‰¹å¾ç‚¹é‡æ’åºã€‚è¿™ç§ç¼“å­˜æœºåˆ¶å¯ä»¥å°†ç½‘æ ¼å…³è”çš„å»¶è¿Ÿä»17mså‡å°‘åˆ°4msã€‚</p><h3 id="é—´æ­‡é™ä½">é—´æ­‡é™ä½</h3><p>ç½‘æ ¼å…³è”åï¼ŒåŒä¸€BEVç½‘æ ¼çš„æ‰€æœ‰ç‚¹å°†åœ¨å¼ é‡è¡¨å¾ä¸­è¿ç»­ã€‚BEVæ± åŒ–çš„ä¸‹ä¸€æ­¥æ˜¯é€šè¿‡ä¸€äº›å¯¹ç§°å‡½æ•°ï¼ˆä¾‹å¦‚ï¼Œå¹³å‡å€¼ã€æœ€å¤§å€¼å’Œæ±‚å’Œï¼‰èšåˆæ¯ä¸ªBEVç½‘æ ¼å†…çš„ç‰¹å¾ã€‚ç°æœ‰çš„å®ç°æ–¹æ³•é¦–å…ˆè®¡ç®—æ‰€æœ‰ç‚¹çš„å‰ç¼€å’Œï¼ˆprefix sumï¼‰ï¼Œç„¶åå‡å»ç´¢å¼•å‘ç”Ÿå˜åŒ–çš„è¾¹ç•Œå€¼ã€‚ç„¶è€Œï¼Œå‰ç¼€å’Œæ“ä½œï¼Œéœ€è¦åœ¨GPUè¿›è¡Œæ ‘ç¼©å‡ï¼ˆtree reductionï¼‰ï¼Œå¹¶ç”Ÿæˆè®¸å¤šæœªä½¿ç”¨çš„éƒ¨åˆ†å’Œï¼ˆå› ä¸ºåªéœ€è¦è¾¹ç•Œå€¼ï¼‰ï¼Œè¿™ä¸¤ç§æ“ä½œéƒ½æ˜¯ä½æ•ˆçš„ã€‚ä¸ºäº†åŠ é€Ÿç‰¹å¾èšåˆï¼Œæ–‡ç« é‡Œå®ç°ä¸€ä¸ªä¸“é—¨çš„GPUå†…æ ¸ï¼Œç›´æ¥åœ¨BEVç½‘æ ¼å¹¶è¡ŒåŒ–ï¼šä¸ºæ¯ä¸ªç½‘æ ¼åˆ†é…ä¸€ä¸ªGPUçº¿ç¨‹ï¼Œè¯¥çº¿ç¨‹è®¡ç®—å…¶é—´æ­‡å’Œï¼ˆinterval sumï¼‰å¹¶å°†ç»“æœå†™å›ã€‚è¯¥å†…æ ¸æ¶ˆé™¤è¾“å‡ºä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼ˆå› æ­¤ä¸éœ€è¦å¤šçº§æ ‘ç¼©å‡ï¼‰ï¼Œå¹¶é¿å…å°†éƒ¨åˆ†å’Œå†™å…¥DRAMï¼Œä»è€Œå°†ç‰¹å¾èšåˆçš„å»¶è¿Ÿä»500mså‡å°‘åˆ°2msã€‚</p><aside>ğŸ’¡ é€šè¿‡ä¼˜åŒ–çš„BEVæ± åŒ–ï¼Œæ‘„åƒå¤´åˆ°BEVçš„è½¬æ¢é€Ÿåº¦æé«˜äº†40å€ï¼šå»¶è¿Ÿä»500mså‡å°‘åˆ°12msï¼ˆä»…ä¸ºæ¨¡å‹ç«¯åˆ°ç«¯è¿è¡Œæ—¶é—´çš„10%ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä¸åŒçš„åˆ†ç‰¹å¾è¾¨ç‡ä¹‹é—´å¾ˆå¥½åœ°æ‰©å±•ã€‚åœ¨å…±äº«BEVè¡¨å¾ä¸­ï¼Œè¿™æ˜¯ç»Ÿä¸€å¤šæ¨¡æ€æ„ŸçŸ¥ç‰¹å¾çš„å…³é”®ä¿ƒæˆå› ç´ ã€‚ä¸¤é¡¹å¹¶è¡ŒåŒ–å·¥ä½œä¹Ÿå‘ç°äº†çº¯æ‘„åƒå¤´3Dæ£€æµ‹çš„è¿™ä¸€æ•ˆç‡ç“¶é¢ˆã€‚å‡è®¾å‡åŒ€æ·±åº¦åˆ†å¸ƒï¼Œæˆ–æˆªæ–­æ¯ä¸ªBEVç½‘æ ¼å†…çš„ç‚¹ï¼Œå¯ä»¥è¿‘ä¼¼è§†å›¾transformerè®¡ç®—ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œè¯¥æŠ€æœ¯åœ¨æ²¡æœ‰ä»»ä½•è¿‘ä¼¼çš„æƒ…å†µä¸‹æ˜¯ç²¾ç¡®çš„ï¼Œä½†ä»ç„¶æ›´å¿«ã€‚</aside><h2 id="fully-convolutional-fusion">Fully-Convolutional Fusion</h2><p>å°†æ‰€æœ‰çš„æ„Ÿå®˜ç‰¹å¾è½¬æ¢ä¸ºå…±äº«çš„BEVè¡¨ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°å°†å®ƒä»¬ä¸å…ƒç´ æ“ä½œç¬¦(ä¾‹å¦‚æ‹¼æ¥)èåˆåœ¨ä¸€èµ·ã€‚å°½ç®¡åœ¨åŒä¸€ç©ºé—´ä¸­ï¼Œç”±äºè§†å›¾è½¬æ¢å™¨çš„æ·±åº¦ä¸å‡†ç¡®ï¼ŒLiDAR BEVç‰¹å¾å’Œç›¸æœºBEVç‰¹å¾ä»ç„¶ä¼šåœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡ºç°ç©ºé—´é”™ä½ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬åº”ç”¨äº†ä¸€ä¸ªåŸºäºå·ç§¯çš„BEVç¼–ç å™¨(å¸¦æœ‰ä¸€äº›å‰©ä½™å—)æ¥è¡¥å¿è¿™ç§å±€éƒ¨å¤±è°ƒã€‚æˆ‘ä»¬çš„æ–¹æ³•å¯èƒ½ä»æ›´ç²¾ç¡®çš„æ·±åº¦ä¼°è®¡ä¸­å—ç›Š</p>]]></content>
      
      
      <categories>
          
          <category> è®ºæ–‡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬”è®° </tag>
            
            <tag> è®ºæ–‡ </tag>
            
            <tag> cvpr </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°å­—å›¾åƒå¤„ç†</title>
      <link href="/2023/05/07/ImageTackle/"/>
      <url>/2023/05/07/ImageTackle/</url>
      
        <content type="html"><![CDATA[<h2 id="è¾¹ç¼˜æå–åŸºæœ¬åŸç†">è¾¹ç¼˜æå–åŸºæœ¬åŸç†</h2><p>â€‹å›¾åƒè¾¹ç¼˜æ˜¯å›¾åƒæœ€åŸºæœ¬çš„ç‰¹å¾ï¼Œæ‰€è°“è¾¹ç¼˜(Edge) æ˜¯æŒ‡å›¾åƒå±€éƒ¨ç‰¹æ€§çš„ä¸è¿ç»­æ€§ã€‚ç°åº¦æˆ–ç»“æ„ç­‰ä¿¡æ¯çš„çªå˜å¤„ç§°ä¹‹ä¸ºè¾¹ç¼˜ã€‚ä¾‹å¦‚ï¼Œç°åº¦çº§çš„çªå˜ã€é¢œè‰²çš„çªå˜,ã€çº¹ç†ç»“æ„çš„çªå˜ç­‰ã€‚è¾¹ç¼˜æ˜¯ä¸€ä¸ªåŒºåŸŸçš„ç»“æŸï¼Œä¹Ÿæ˜¯å¦ä¸€ä¸ªåŒºåŸŸçš„å¼€å§‹ï¼Œåˆ©ç”¨è¯¥ç‰¹å¾å¯ä»¥åˆ†å‰²å›¾åƒã€‚</p><p>â€‹å›¾åƒçš„è¾¹ç¼˜æœ‰æ–¹å‘å’Œå¹…åº¦ä¸¤ç§å±æ€§ã€‚è¾¹ç¼˜é€šå¸¸å¯ä»¥é€šè¿‡ä¸€é˜¶å¯¼æ•°æˆ–äºŒé˜¶å¯¼æ•°æ£€æµ‹å¾—åˆ°ã€‚ä¸€é˜¶å¯¼æ•°æ˜¯ä»¥æœ€å¤§å€¼ä½œä¸ºå¯¹åº”çš„è¾¹ç¼˜çš„ä½ç½®ï¼Œè€ŒäºŒé˜¶å¯¼æ•°åˆ™ä»¥è¿‡é›¶ç‚¹ä½œä¸ºå¯¹åº”è¾¹ç¼˜çš„ä½ç½®ã€‚</p><p>â€‹è¦å¾—åˆ°ä¸€å¹…å›¾åƒçš„æ¢¯åº¦ï¼Œåˆ™è¦æ±‚åœ¨å›¾åƒçš„æ¯ä¸ªåƒç´ ç‚¹ä½ç½®å¤„è®¡ç®—åå¯¼æ•°ã€‚æˆ‘ä»¬å¤„ç†çš„æ˜¯æ•°å­—é‡ï¼Œå› æ­¤è¦æ±‚å…³äºä¸€ç‚¹çš„é‚»åŸŸä¸Šçš„åå¯¼æ•°çš„æ•°å­—è¿‘ä¼¼ï¼Œå› æ­¤ä¸€å¹…å›¾åƒåœ¨(x,y)ä½ç½®å’Œx,yæ–¹å‘ä¸Šçš„æ¢¯åº¦å¤§å°è®¡ç®—å¦‚ä¸‹ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">âˆ‚</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">âˆ‚</mi><mi>x</mi></mrow></mfrac><mo>=</mo><munder><mo><mi>lim</mi><mo>â¡</mo></mo><mrow><mi>x</mi><mo>â†’</mo><mn>0</mn></mrow></munder><mfrac><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mi>Ïµ</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>âˆ’</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mi>Ïµ</mi></mfrac></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(1.1)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\frac {\partial f(x,y) } {\partial x }=\lim_{x \to 0} \frac{f(x+\epsilon,y)-f(x,y)}{\epsilon}  \tag{1.1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">âˆ‚</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">âˆ‚</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.144108em;vertical-align:-0.717108em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-2.382892em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mrel mtight">â†’</span><span class="mord mtight">0</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">lim</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.717108em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">Ïµ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">Ïµ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="tag"><span class="strut" style="height:2.144108em;vertical-align:-0.717108em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">1</span></span><span class="mord">)</span></span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">âˆ‚</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">âˆ‚</mi><mi>y</mi></mrow></mfrac><mo>=</mo><munder><mo><mi>lim</mi><mo>â¡</mo></mo><mrow><mi>x</mi><mo>â†’</mo><mn>0</mn></mrow></munder><mfrac><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mi>Ïµ</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>âˆ’</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mi>Ïµ</mi></mfrac></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(1.2)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\frac {\partial f(x,y) } {\partial y }=\lim_{x \to 0} \frac{f(x+\epsilon,y)-f(x,y)}{\epsilon} \tag{1.2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.30744em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">âˆ‚</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">âˆ‚</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.144108em;vertical-align:-0.717108em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-2.382892em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mrel mtight">â†’</span><span class="mord mtight">0</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">lim</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.717108em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">Ïµ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">Ïµ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="tag"><span class="strut" style="height:2.30744em;vertical-align:-0.8804400000000001em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">2</span></span><span class="mord">)</span></span></span></span></span></span></p><p>ï¼ˆ1ï¼‰ä¸€é˜¶å¯¼æ•°çš„è¾¹ç¼˜ç®—å­</p><p>é€šè¿‡æ¨¡æ¿ä½œä¸ºæ ¸ä¸å›¾åƒçš„æ¯ä¸ªåƒç´ ç‚¹åšå·ç§¯å’Œè¿ç®—ï¼Œç„¶åé€‰å–åˆé€‚çš„é˜ˆå€¼æ¥æå–å›¾åƒçš„è¾¹ç¼˜ã€‚å¸¸è§çš„æœ‰Robertsç®—å­ã€Sobelç®—å­å’ŒPrewittç®—å­ã€‚</p><p>ï¼ˆ2ï¼‰äºŒé˜¶å¯¼æ•°çš„è¾¹ç¼˜ç®—å­</p><p>ä¾æ®äºäºŒé˜¶å¯¼æ•°è¿‡é›¶ç‚¹ï¼Œå¸¸è§çš„æœ‰Laplacian ç®—å­ï¼Œæ­¤ç±»ç®—å­å¯¹å™ªå£°æ•æ„Ÿã€‚</p><p>ï¼ˆ3ï¼‰å…¶ä»–è¾¹ç¼˜ç®—å­</p><p>å‰é¢ä¸¤ç±»å‡æ˜¯é€šè¿‡å¾®åˆ†ç®—å­æ¥æ£€æµ‹å›¾åƒè¾¹ç¼˜ï¼Œè¿˜æœ‰ä¸€ç§å°±æ˜¯Cannyç®—å­ï¼Œå…¶æ˜¯åœ¨æ»¡è¶³ä¸€å®šçº¦æŸæ¡ä»¶ä¸‹æ¨å¯¼å‡ºæ¥çš„è¾¹ç¼˜æ£€æµ‹æœ€ä¼˜åŒ–ç®—å­ã€‚</p><p>å¯¹äºä¸åŒçš„æ»¤æ³¢å™¨æ¨¡æ¿å¾—åˆ°çš„æ¢¯åº¦æ˜¯ä¸åŒçš„ï¼Œè¿™ä¹Ÿå°±è¡ç”Ÿå‡ºå¾ˆå¤šç®—å­ï¼Œå¦‚Robertsã€Prewittã€Sobelå’ŒLaplacianç®—å­ç­‰ã€‚</p><h3 id="sobelç®—å­">Sobelç®—å­</h3><p>Sobelç®—å­æ˜¯ä¸€ç§ç”¨äºè¾¹ç¼˜æ£€æµ‹çš„ç¦»æ•£å¾®åˆ†ç®—å­ï¼Œå®ƒç»“åˆäº†é«˜æ–¯å¹³æ»‘å’Œå¾®åˆ†æ±‚å¯¼ã€‚è¯¥ç®—å­ç”¨äºè®¡ç®—å›¾åƒæ˜æš—ç¨‹åº¦è¿‘ä¼¼å€¼ï¼Œæ ¹æ®å›¾åƒè¾¹ç¼˜æ—è¾¹æ˜æš—ç¨‹åº¦æŠŠè¯¥åŒºåŸŸå†…è¶…è¿‡æŸä¸ªæ•°çš„ç‰¹å®šç‚¹è®°ä¸ºè¾¹ç¼˜ã€‚Sobelç®—å­åœ¨Prewittç®—å­çš„åŸºç¡€ä¸Šå¢åŠ äº†æƒé‡çš„æ¦‚å¿µï¼Œè®¤ä¸ºç›¸é‚»ç‚¹çš„è·ç¦»è¿œè¿‘å¯¹å½“å‰åƒç´ ç‚¹çš„å½±å“æ˜¯ä¸åŒçš„ï¼Œè·ç¦»è¶Šè¿‘çš„åƒç´ ç‚¹å¯¹åº”å½“å‰åƒç´ çš„å½±å“è¶Šå¤§ï¼Œä»è€Œå®ç°å›¾åƒé”åŒ–å¹¶çªå‡ºè¾¹ç¼˜è½®å»“ã€‚</p><p>Sobelç®—å­æ ¹æ®åƒç´ ç‚¹ä¸Šä¸‹ã€å·¦å³é‚»ç‚¹ç°åº¦åŠ æƒå·®ï¼Œåœ¨è¾¹ç¼˜å¤„è¾¾åˆ°æå€¼è¿™ä¸€ç°è±¡æ£€æµ‹è¾¹ç¼˜ã€‚å¯¹å™ªå£°å…·æœ‰å¹³æ»‘ä½œç”¨ï¼Œæä¾›è¾ƒä¸ºç²¾ç¡®çš„è¾¹ç¼˜æ–¹å‘ä¿¡æ¯ã€‚å› ä¸ºSobelç®—å­ç»“åˆäº†é«˜æ–¯å¹³æ»‘å’Œå¾®åˆ†æ±‚å¯¼ï¼ˆåˆ†åŒ–ï¼‰ï¼Œå› æ­¤ç»“æœä¼šå…·æœ‰æ›´å¤šçš„æŠ—å™ªæ€§ï¼Œå½“å¯¹ç²¾åº¦è¦æ±‚ä¸æ˜¯å¾ˆé«˜æ—¶ï¼ŒSobelç®—å­æ˜¯ä¸€ç§è¾ƒä¸ºå¸¸ç”¨çš„è¾¹ç¼˜æ£€æµ‹æ–¹æ³•ã€‚</p><p>Sobelç®—å­çš„è¾¹ç¼˜å®šä½æ›´å‡†ç¡®ï¼Œå¸¸ç”¨äºå™ªå£°è¾ƒå¤šã€ç°åº¦æ¸å˜çš„å›¾åƒã€‚å…¶ç®—æ³•æ¨¡æ¿å¦‚ä¸‹é¢çš„å…¬å¼æ‰€ç¤ºï¼Œå…¶ä¸­  è¡¨ç¤ºæ°´å¹³æ–¹å‘ï¼Œ è¡¨ç¤ºå‚ç›´æ–¹å‘ã€‚</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>x</mi></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mspace width="1em"/><msub><mi>d</mi><mi>y</mi></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mspace width="1em"/></mrow><annotation encoding="application/x-tex">d_x=\begin{bmatrix} -1 &amp; 0 &amp;1 \\ -2 &amp; 0 &amp; 2\\-1 &amp; 0 &amp;1 \end{bmatrix}\quad d_y=\begin{bmatrix} -1 &amp; -2 &amp;1 \\ 0 &amp; 0 &amp; 0\\1 &amp; 2 &amp;1 \end{bmatrix}\quad</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.6010299999999997em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">2</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.6010299999999997em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">2</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span></span></span></span></span></p><h3 id="robertsç®—å­">Robertsç®—å­</h3><p>Robertsç®—å­åˆç§°ä¸ºäº¤å‰å¾®åˆ†ç®—æ³•ï¼Œå®ƒæ˜¯åŸºäºäº¤å‰å·®åˆ†çš„æ¢¯åº¦ç®—æ³•ï¼Œé€šè¿‡å±€éƒ¨å·®åˆ†è®¡ç®—æ£€æµ‹è¾¹ç¼˜çº¿æ¡ã€‚å¸¸ç”¨æ¥å¤„ç†å…·æœ‰é™¡å³­çš„ä½å™ªå£°å›¾åƒï¼Œå½“å›¾åƒè¾¹ç¼˜æ¥è¿‘äºæ­£45åº¦æˆ–è´Ÿ45åº¦æ—¶ï¼Œè¯¥ç®—æ³•å¤„ç†æ•ˆæœæ›´ç†æƒ³ã€‚å…¶ç¼ºç‚¹æ˜¯å¯¹è¾¹ç¼˜çš„å®šä½ä¸å¤ªå‡†ç¡®ï¼Œæå–çš„è¾¹ç¼˜çº¿æ¡è¾ƒç²—ã€‚Robertsç®—å­çš„æ¨¡æ¿åˆ†ä¸ºæ°´å¹³æ–¹å‘å’Œå‚ç›´æ–¹å‘ï¼Œå¦‚ä¸‹å¼æ‰€ç¤ºï¼Œä»å…¶æ¨¡æ¿å¯ä»¥çœ‹å‡ºï¼ŒRobertsç®—å­èƒ½è¾ƒå¥½çš„å¢å¼ºæ­£è´Ÿ45åº¦çš„å›¾åƒè¾¹ç¼˜ã€‚</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>x</mi></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mspace width="1em"/><msub><mi>d</mi><mi>y</mi></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mspace width="1em"/></mrow><annotation encoding="application/x-tex">d_x=\begin{bmatrix} -1 &amp; 0 \\ 0 &amp; 1 \end{bmatrix}\quad d_y=\begin{bmatrix} 0 &amp; -1 \\ 1 &amp; 0 \end{bmatrix}\quad</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:1em;"></span></span></span></span></span></p><h3 id="prewittç®—å­">Prewittç®—å­</h3><p>Prewittç®—å­æ˜¯ä¸€ç§å›¾åƒè¾¹ç¼˜æ£€æµ‹çš„å¾®åˆ†ç®—å­ï¼Œå…¶åŸç†æ˜¯åˆ©ç”¨ç‰¹å®šåŒºåŸŸå†…åƒç´ ç°åº¦å€¼äº§ç”Ÿçš„å·®åˆ†å®ç°è¾¹ç¼˜æ£€æµ‹ã€‚ç”±äºPrewittç®—å­é‡‡ç”¨ 33 æ¨¡æ¿å¯¹åŒºåŸŸå†…çš„åƒç´ å€¼è¿›è¡Œè®¡ç®—ï¼Œè€ŒRobertç®—å­çš„æ¨¡æ¿ä¸º 22ï¼Œæ•…Prewittç®—å­çš„è¾¹ç¼˜æ£€æµ‹ç»“æœåœ¨æ°´å¹³æ–¹å‘å’Œå‚ç›´æ–¹å‘å‡æ¯”Robertç®—å­æ›´åŠ æ˜æ˜¾ã€‚Prewittç®—å­é€‚åˆç”¨æ¥è¯†åˆ«å™ªå£°è¾ƒå¤šã€ç°åº¦æ¸å˜çš„å›¾åƒï¼Œå…¶è®¡ç®—å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>x</mi></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mspace width="1em"/><msub><mi>d</mi><mi>y</mi></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mspace width="1em"/></mrow><annotation encoding="application/x-tex">d_x=\begin{bmatrix} -1 &amp; 0 &amp;1 \\ -1 &amp; 0 &amp;1\\-1 &amp; 0 &amp;1 \end{bmatrix}\quad d_y=\begin{bmatrix} -1 &amp; -1 &amp;-1 \\ 0 &amp; 0 &amp; 0\\1 &amp; 1 &amp;1 \end{bmatrix}\quad</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.6010299999999997em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.6010299999999997em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span></span></span></span></span></p><h3 id="marrç®—å­">Marrç®—å­</h3><p>ä¸€ç§åˆ©ç”¨å›¾åƒå¼ºåº¦äºŒé˜¶å¯¼æ•°çš„é›¶äº¤å‰ç‚¹æ¥æ±‚è¾¹ç¼˜ç‚¹çš„ç®—æ³•å¯¹å™ªå£°ååˆ†æ•æ„Ÿï¼Œæ‰€ä»¥åœ¨è¾¹ç¼˜å¢å¼ºå‰æ»¤é™¤å™ªå£°ã€‚è¿™æ˜¯ä¸€ç§æ ¹æ®äººç±»è§†è§‰ç‰¹æ€§æå‡ºäº†ä¸€ç§è¾¹ç¼˜æ£€æµ‹çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†é«˜æ–¯æ»¤æ³¢å’Œæ‹‰æ™®æ‹‰æ–¯æ£€æµ‹ç®—å­ç»“åˆåœ¨ä¸€èµ·è¿›è¡Œè¾¹ç¼˜æ£€æµ‹çš„æ–¹æ³•ã€‚Marrå’ŒHildrethè¯æ˜äº†è¾¹ç¼˜æ£€æµ‹ä¸­ç°åº¦å˜åŒ–å’Œå›¾åƒçš„å°ºå¯¸æ— å…³æ£€æµ‹ç®—å­å¯ä»¥ä¸ºä¸åŒå°ºåº¦ï¼›ç°åº¦å˜åŒ–æ¢¯åº¦åœ¨ä¸€é˜¶å¯¼æ•°çš„æå€¼ç‚¹ï¼Œæˆ–åœ¨äºŒé˜¶å¯¼æ•°ä¸ºé›¶çš„äº¤å‰ç‚¹ã€‚</p><p>åœ¨laplaceç®—å­ ä¸­ï¼Œæ»¡è¶³fæ˜¯æ ‡å‡†å·®çš„äºŒç»´é«˜æ–¯åˆ†å¸ƒå‡½æ•°ä¸º</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>e</mi><mrow><mo>âˆ’</mo><mfrac><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn><msup><mi>Ïƒ</mi><mn>2</mn></msup></mrow></mfrac></mrow></msup></mrow><annotation encoding="application/x-tex">f(x,y)=e^{-\frac{x^2+y^2}{2\sigma^2 } }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.3013099999999997em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.3013099999999997em;"><span style="top:-3.4534200000000004em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2112714285714286em;"><span style="top:-2.5061857142857145em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9384399999999999em;"><span style="top:-2.93844em;margin-right:0.1em;"><span class="pstrut" style="height:2.64444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.4623857142857144em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.04844em;"><span style="top:-3.04844em;margin-right:0.1em;"><span class="pstrut" style="height:2.64444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.04844em;"><span style="top:-3.04844em;margin-right:0.1em;"><span class="pstrut" style="height:2.64444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.49381428571428565em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>å¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> æ±‚å¾®åˆ†å¾—ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mo>â–½</mo><mn>2</mn></msup><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mtext>Â </mtext><msup><mi mathvariant="normal">âˆ‚</mi><mn>2</mn></msup><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">âˆ‚</mi><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac><mo>+</mo><mfrac><mrow><mtext>Â </mtext><msup><mi mathvariant="normal">âˆ‚</mi><mn>2</mn></msup><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">âˆ‚</mi><msup><mi>y</mi><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">\bigtriangledown ^2f(x,y)=\frac{\ {\partial^2}  f(x,y)}{\partial x^2} +\frac{\ {\partial^2}  f(x,y)}{\partial y^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mbin">â–½</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.177108em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">âˆ‚</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mspace">Â </span><span class="mord"><span class="mord"><span class="mord" style="margin-right:0.05556em;">âˆ‚</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.371548em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">âˆ‚</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mspace">Â </span><span class="mord"><span class="mord"><span class="mord" style="margin-right:0.05556em;">âˆ‚</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mo>â–½</mo><mn>2</mn></msup><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">[</mo><mfrac><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo>âˆ’</mo><mn>2</mn><msup><mi>Ïƒ</mi><mn>2</mn></msup></mrow><msup><mi>Ïƒ</mi><mn>4</mn></msup></mfrac><mo fence="true">]</mo></mrow><msup><mi>e</mi><mrow><mo>âˆ’</mo><mfrac><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn><msup><mi>Ïƒ</mi><mn>2</mn></msup></mrow></mfrac></mrow></msup></mrow><annotation encoding="application/x-tex">\bigtriangledown ^2f(x,y)=\left [ \frac{x^2+y^2-2\sigma ^2}{\sigma ^4}  \right ]  e^{-\frac{x^2+y^2}{2\sigma ^2} }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mbin">â–½</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.441138em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.3013099999999997em;"><span style="top:-3.4534200000000004em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2112714285714286em;"><span style="top:-2.5061857142857145em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9384399999999999em;"><span style="top:-2.93844em;margin-right:0.1em;"><span class="pstrut" style="height:2.64444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.4623857142857144em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.04844em;"><span style="top:-3.04844em;margin-right:0.1em;"><span class="pstrut" style="height:2.64444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.04844em;"><span style="top:-3.04844em;margin-right:0.1em;"><span class="pstrut" style="height:2.64444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.49381428571428565em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>å…¶ä¸­ä¸Šå¼è¢«ç§°ä¸ºé«˜æ–¯æ‹‰æ™®æ‹‰æ–¯(LoG)ï¼ŒLoGçš„é›¶ç‚¹å‡ºç°åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><mn>2</mn><msup><mi>Ïƒ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">x^2+y^2=2\sigma^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>å¤„ã€‚</p><h3 id="cannyè¾¹ç¼˜æ£€æµ‹">Cannyè¾¹ç¼˜æ£€æµ‹</h3><p>â€‹Cannyè¾¹ç¼˜æ£€æµ‹ç®—æ³•æ˜¯æ¯”è¾ƒå‡ºè‰²çš„ç®—æ³•ï¼Œå®ƒåŒ…å«ä»¥ä¸‹å››ä¸ªæ­¥éª¤ï¼š</p><p>1.<strong>é«˜æ–¯æ»¤æ³¢</strong></p><p>æ»¤æ³¢çš„ä¸»è¦ç›®çš„æ˜¯é™å™ªï¼Œä¸€èˆ¬çš„å›¾åƒå¤„ç†ç®—æ³•éƒ½éœ€è¦å…ˆè¿›è¡Œé™å™ªã€‚è€Œé«˜æ–¯æ»¤æ³¢ä¸»è¦ä½¿å›¾åƒå˜å¾—å¹³æ»‘ï¼ˆæ¨¡ç³Šï¼‰ï¼ŒåŒæ—¶ä¹Ÿæœ‰å¯èƒ½å¢å¤§äº†è¾¹ç¼˜çš„å®½åº¦ã€‚</p><p>é«˜æ–¯å‡½æ•°æ˜¯ä¸€ä¸ªç±»ä¼¼ä¸æ­£æ€åˆ†å¸ƒçš„ä¸­é—´å¤§ä¸¤è¾¹å°çš„å‡½æ•°ã€‚</p><p>å¯¹äºä¸€ä¸ªä½ç½®ï¼ˆm,nï¼‰çš„åƒç´ ç‚¹ï¼Œå…¶ç°åº¦å€¼ä¸ºf(m,n)ã€‚</p><p>é‚£ä¹ˆç»è¿‡é«˜æ–¯æ»¤æ³¢åçš„ç°åº¦å€¼å°†å˜ä¸ºï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>Ïƒ</mi></msub><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><msqrt><mrow><mn>2</mn><mi>Ï€</mi><msup><mi>Ïƒ</mi><mn>2</mn></msup></mrow></msqrt></mfrac><msup><mi>e</mi><mrow><mo>âˆ’</mo><mfrac><mrow><msup><mi>m</mi><mn>2</mn></msup><mo>+</mo><msup><mi>n</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn><msup><mi>Ïƒ</mi><mn>2</mn></msup></mrow></mfrac></mrow></msup><mo>â‹…</mo><mi>f</mi><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g_\sigma (m,n)=\frac{ 1}{\sqrt{2\pi \sigma ^2}} e^{-\frac{m^2+n^2}{2\sigma^2} }\cdot f(m,n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ïƒ</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.25144em;vertical-align:-0.93em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.154946em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9550540000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.03588em;">Ï€</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-2.915054em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.08494599999999997em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.24644em;"><span style="top:-3.4534200000000004em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1328857142857145em;"><span style="top:-2.5061857142857145em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9384399999999999em;"><span style="top:-2.93844em;margin-right:0.1em;"><span class="pstrut" style="height:2.64444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.04844em;"><span style="top:-3.04844em;margin-right:0.1em;"><span class="pstrut" style="height:2.64444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.04844em;"><span style="top:-3.04844em;margin-right:0.1em;"><span class="pstrut" style="height:2.64444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.49381428571428565em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></span></p><p>â€‹ç®€å•è¯´å°±æ˜¯ç”¨ä¸€ä¸ªé«˜æ–¯çŸ©é˜µä¹˜ä»¥æ¯ä¸€ä¸ªåƒç´ ç‚¹åŠå…¶é‚»åŸŸï¼Œå–å…¶å¸¦æƒé‡çš„å¹³å‡å€¼ä½œä¸ºæœ€åçš„ç°åº¦å€¼ã€‚</p><p><strong>2. è®¡ç®—æ¢¯åº¦å€¼å’Œæ¢¯åº¦æ–¹å‘</strong></p><p>â€‹è¾¹ç¼˜æ˜¯ä»€ä¹ˆï¼Ÿè¾¹ç¼˜å°±æ˜¯ç°åº¦å€¼å˜åŒ–è¾ƒå¤§çš„çš„åƒç´ ç‚¹çš„é›†åˆã€‚ä¸€é“é»‘è¾¹ä¸€é“ç™½è¾¹ä¸­é—´å°±æ˜¯è¾¹ç¼˜ï¼Œå®ƒçš„ç°åº¦å€¼å˜åŒ–æ˜¯æœ€å¤§çš„ï¼Œåœ¨å›¾åƒä¸­ï¼Œç”¨æ¢¯åº¦æ¥è¡¨ç¤ºç°åº¦å€¼çš„å˜åŒ–ç¨‹åº¦å’Œæ–¹å‘ã€‚</p><p>â€‹å®ƒå¯ä»¥é€šè¿‡ç‚¹ä¹˜ä¸€ä¸ªsobelæˆ–å…¶å®ƒç®—å­å¾—åˆ°ä¸åŒæ–¹å‘çš„æ¢¯åº¦å€¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>x</mi></msub><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>g</mi><mi>y</mi></msub><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g_x(m,n),g_y(m,n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>ã€‚</p><p>â€‹æ¢¯åº¦é€šè¿‡ä»¥ä¸‹å…¬å¼è®¡ç®—æ¢¯åº¦å€¼å’Œæ¢¯åº¦æ–¹å‘ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><msqrt><mrow><msub><mi>g</mi><mi>x</mi></msub><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><msub><mi>g</mi><mi>y</mi></msub><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">G(m,n)=\sqrt{g_x(m,n)^2+g_y(m,n)^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">G</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.84em;vertical-align:-0.574179em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.265821em;"><span class="svg-align" style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.225821em;"><span class="pstrut" style="height:3.8em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.8800000000000001em;"><svg width='400em' height='1.8800000000000001em' viewBox='0 0 400000 1944' preserveAspectRatio='xMinYMin slice'><path d='M983 90l0 -0c4,-6.7,10,-10,18,-10 H400000v40H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5c53.7,-170.3,84.5,-266.8,92.5,-289.5zM1001 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.574179em;"><span></span></span></span></span></span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi><mo>=</mo><mi>a</mi><mi>r</mi><mi>c</mi><mi>t</mi><mi>a</mi><mi>n</mi><mfrac><mrow><msub><mi>g</mi><mi>y</mi></msub><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><mrow><msub><mi>g</mi><mi>x</mi></msub><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\theta=arctan\frac{g_y(m,n)}{g_x(m,n)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><strong>3. è¿‡æ»¤éæœ€å¤§å€¼</strong></p><p>â€‹åœ¨é«˜æ–¯æ»¤æ³¢è¿‡ç¨‹ä¸­ï¼Œè¾¹ç¼˜æœ‰å¯èƒ½è¢«æ”¾å¤§äº†ã€‚è¿™ä¸ªæ­¥éª¤ä½¿ç”¨ä¸€ä¸ªè§„åˆ™æ¥è¿‡æ»¤ä¸æ˜¯è¾¹ç¼˜çš„ç‚¹ï¼Œä½¿è¾¹ç¼˜çš„å®½åº¦å°½å¯èƒ½ä¸º1ä¸ªåƒç´ ç‚¹ï¼šå¦‚æœä¸€ä¸ªåƒç´ ç‚¹å±äºè¾¹ç¼˜ï¼Œé‚£ä¹ˆè¿™ä¸ªåƒç´ ç‚¹åœ¨æ¢¯åº¦æ–¹å‘ä¸Šçš„æ¢¯åº¦å€¼æ˜¯æœ€å¤§çš„ã€‚å¦åˆ™ä¸æ˜¯è¾¹ç¼˜ï¼Œå°†ç°åº¦å€¼è®¾ä¸º0ã€‚</p><p class='katex-block katex-error' title='ParseError: KaTeX parse error: No such environment: equation at position 16: M_T(m,n)=\begin{Ì²eÌ²qÌ²uÌ²aÌ²tÌ²iÌ²oÌ²nÌ²}Ì²\left\{\beginâ€¦'>M_T(m,n)=\begin{equation}\left\{\begin{array}{lr}M(m,n) &amp; \textsf{if}\ M(m,n)&gt;T\\0 &amp; otherwise\\\end{array}\right.\end{equation}</p><p><strong>4. ä½¿ç”¨ä¸Šä¸‹é˜ˆå€¼æ¥æ£€æµ‹è¾¹ç¼˜</strong></p><p>â€‹ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä½¿ç”¨ä¸€ä¸ªé˜ˆå€¼æ¥æ£€æµ‹è¾¹ç¼˜ï¼Œä½†æ˜¯è¿™æ ·åšæœªå…å¤ªæ­¦æ–­äº†ã€‚å¦‚æœèƒ½å¤Ÿä½¿ç”¨å¯å‘å¼çš„æ–¹æ³•ç¡®å®šä¸€ä¸ªä¸Šé˜€å€¼å’Œä¸‹é˜€å€¼ï¼Œä½äºä¸‹é˜€å€¼ä¹‹ä¸Šçš„éƒ½å¯ä»¥ä½œä¸ºè¾¹ç¼˜ï¼Œè¿™æ ·å°±å¯èƒ½æé«˜å‡†ç¡®åº¦ã€‚</p><h2 id="å„ç±»ç®—å­æ•ˆæœæ¯”è¾ƒ">å„ç±»ç®—å­æ•ˆæœæ¯”è¾ƒ</h2><p>ï¼ˆ1ï¼‰Roberts ç®—å­</p><p>â€‹Robertsç®—å­åˆ©ç”¨å±€éƒ¨å·®åˆ†ç®—å­å¯»æ‰¾è¾¹ç¼˜ï¼Œè¾¹ç¼˜å®šä½ç²¾åº¦è¾ƒé«˜ï¼Œä½†å®¹æ˜“ä¸¢å¤±ä¸€éƒ¨åˆ†è¾¹ç¼˜ï¼Œä¸å…·å¤‡æŠ‘åˆ¶å™ªå£°çš„èƒ½åŠ›ã€‚è¯¥ç®—å­å¯¹å…·æœ‰é™¡å³­è¾¹ç¼˜ä¸”å«å™ªå£°å°‘çš„å›¾åƒæ•ˆæœè¾ƒå¥½ï¼Œå°¤å…¶æ˜¯è¾¹ç¼˜æ­£è´Ÿ45åº¦è¾ƒå¤šçš„å›¾åƒï¼Œä½†å®šä½å‡†ç¡®ç‡è¾ƒå·®ï¼›</p><p>ï¼ˆ2ï¼‰Sobel ç®—å­</p><p>â€‹Sobelç®—å­è€ƒè™‘äº†ç»¼åˆå› ç´ ï¼Œå¯¹å™ªå£°è¾ƒå¤šçš„å›¾åƒå¤„ç†æ•ˆæœæ›´å¥½ï¼ŒSobel ç®—å­è¾¹ç¼˜å®šä½æ•ˆæœä¸é”™ï¼Œä½†æ£€æµ‹å‡ºçš„è¾¹ç¼˜å®¹æ˜“å‡ºç°å¤šåƒç´ å®½åº¦ã€‚</p><p>ï¼ˆ3ï¼‰ Prewitt ç®—å­</p><p>â€‹Prewittç®—å­å¯¹ç°åº¦æ¸å˜çš„å›¾åƒè¾¹ç¼˜æå–æ•ˆæœè¾ƒå¥½ï¼Œè€Œæ²¡æœ‰è€ƒè™‘ç›¸é‚»ç‚¹çš„è·ç¦»è¿œè¿‘å¯¹å½“å‰åƒç´ ç‚¹çš„å½±å“ï¼Œä¸Sobel ç®—å­ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯åœ¨å¹³æ»‘éƒ¨åˆ†çš„æƒé‡å¤§å°æœ‰äº›å·®å¼‚ï¼›</p><p>ï¼ˆ4ï¼‰Marrç®—å­</p><p>â€‹Marr ç®—å­ä¸ä¾èµ–äºè¾¹ç¼˜æ–¹å‘çš„äºŒé˜¶å¾®åˆ†ç®—å­ï¼Œå¯¹å›¾åƒä¸­çš„é˜¶è·ƒå‹è¾¹ç¼˜ç‚¹å®šä½å‡†ç¡®ï¼Œè¯¥ç®—å­å¯¹å™ªå£°éå¸¸æ•æ„Ÿï¼Œå®ƒä½¿å™ªå£°æˆåˆ†å¾—åˆ°åŠ å¼ºï¼Œè¿™ä¸¤ä¸ªç‰¹æ€§ä½¿å¾—è¯¥ç®—å­å®¹æ˜“ä¸¢å¤±ä¸€éƒ¨åˆ†è¾¹ç¼˜çš„æ–¹å‘ä¿¡æ¯ï¼Œé€ æˆä¸€äº›ä¸è¿ç»­çš„æ£€æµ‹è¾¹ç¼˜ï¼ŒåŒæ—¶æŠ—å™ªå£°èƒ½åŠ›æ¯”è¾ƒå·®.</p><p>ï¼ˆ5ï¼‰Cannyè¾¹ç¼˜æ£€æµ‹</p><p>â€‹Cannyè¾¹ç¼˜æ£€æµ‹ç®—å­æ˜¯æ‰€æœ‰è¾¹ç¼˜æ£€æµ‹ç®—å­ä¸­æœ€ä¼˜ç§€çš„ï¼Œå…·æœ‰ä½é”™è¯¯ç‡ã€‚å·²å®šä½çš„è¾¹ç¼˜å°½å¯èƒ½çš„æ¥è¿‘çœŸå®è¾¹ç¼˜ï¼Œç”±æ£€æµ‹å­æ ‡è®°ä¸ºè¾¹ç¼˜çš„ä¸€ç‚¹å’ŒçœŸå®è¾¹ç¼˜çš„ä¸­å¿ƒä¹‹é—´çš„è·ç¦»æœ€å°ã€‚å¯¹äºæ²¡ä¸€ä¸ªçœŸå®çš„è¾¹ç¼˜ç‚¹ï¼Œæ£€æµ‹å­éƒ½åªè¿”å›ä¸€ä¸ªç‚¹ï¼Œæ„å‘³ç€çœŸå®è¾¹ç¼˜å‘¨å›´çš„å±€éƒ¨æœ€å¤§æ•°æœ€å°ã€‚</p><h2 id="å®ç°">å®ç°</h2><p>â€‹æœ¬æ¬¡å®éªŒè¿‡ç¨‹ä¸­ï¼Œé‡‡ç”¨çš„æ˜¯ç»å…¸çš„Model.jpg,åœ¨anaconda pythonç‰ˆæœ¬3.7 Jupyter-notebookä¸­è¿›è¡Œå®éªŒã€‚åœ¨è¯»å–å›¾ç‰‡åç»Ÿä¸€å¯¹å›¾åƒè¿›è¡Œäº†ç°åº¦åŒ–ï¼Œå¹¶è¿›è¡Œé«˜æ–¯æ»¤æ³¢å’Œé˜ˆå€¼å¤„ç†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è¯»å–å›¾åƒ</span></span><br><span class="line">img = cv2.imread(<span class="string">&#x27;model.jpg&#x27;</span>)</span><br><span class="line">img_RGB = cv2.cvtColor(img, cv2.COLOR_BGR2RGB) </span><br><span class="line"><span class="comment">#ç°åº¦åŒ–å¤„ç†å›¾åƒ</span></span><br><span class="line">grayImage = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)</span><br><span class="line"><span class="comment">#é«˜æ–¯æ»¤æ³¢</span></span><br><span class="line">gaussianBlur = cv2.GaussianBlur(grayImage, (<span class="number">3</span>,<span class="number">3</span>), <span class="number">0</span>)</span><br><span class="line"><span class="comment">#é˜ˆå€¼å¤„ç†</span></span><br><span class="line">ret, binary = cv2.threshold(gaussianBlur, <span class="number">127</span>, <span class="number">255</span>, cv2.THRESH_BINARY)</span><br></pre></td></tr></table></figure><p>â€‹åœ¨å®éªŒè¿‡ç¨‹ä¸­ï¼Œä¾æ¬¡å°†å›¾åƒç»è¿‡è‡ªå®šä¹‰çš„å‡½æ•°è¿›è¡Œå¤„ç†æå–å›¾åƒè¾¹ç¼˜ã€‚</p><p>â€‹ä½¿ç”¨Sobelç®—å­è¿›è¡Œè¾¹ç¼˜æå–ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">usSobel</span>(<span class="params">grayImage</span>):</span><br><span class="line">    x = cv2.Sobel(grayImage, cv2.CV_16S, <span class="number">1</span>, <span class="number">0</span>)  <span class="comment"># å¯¹xæ±‚ä¸€é˜¶å¯¼</span></span><br><span class="line">    y = cv2.Sobel(grayImage, cv2.CV_16S, <span class="number">0</span>, <span class="number">1</span>)  <span class="comment"># å¯¹yæ±‚ä¸€é˜¶å¯¼</span></span><br><span class="line">    absX = cv2.convertScaleAbs(x)</span><br><span class="line">    absY = cv2.convertScaleAbs(y)</span><br><span class="line">    Sobel = cv2.addWeighted(absX, <span class="number">0.5</span>, absY, <span class="number">0.5</span>, <span class="number">0</span>) </span><br><span class="line">    ret, binary = cv2.threshold(Sobel, <span class="number">127</span>, <span class="number">255</span>, cv2.THRESH_BINARY)</span><br><span class="line">    plt.subplot(<span class="number">121</span>),plt.imshow(binary, cmap=plt.cm.gray ),plt.title(<span class="string">&#x27;äºŒå€¼å›¾&#x27;</span>), plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">    plt.subplot(<span class="number">122</span>),plt.imshow(Sobel, cmap=plt.cm.gray ),plt.title(<span class="string">&#x27;Sobelç®—å­&#x27;</span>), plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure><p>â€‹ä½¿ç”¨Robertsç®—å­è¿›è¡Œè¾¹ç¼˜æå–ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">useRoberts</span>(<span class="params">grayImage</span>):</span><br><span class="line">    <span class="comment"># Robertsç®—å­</span></span><br><span class="line">    kernelx = np.array([[-<span class="number">1</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">1</span>]], dtype=<span class="built_in">int</span>)</span><br><span class="line">    kernely = np.array([[<span class="number">0</span>, -<span class="number">1</span>], [<span class="number">1</span>, <span class="number">0</span>]], dtype=<span class="built_in">int</span>)</span><br><span class="line">    x = cv2.filter2D(grayImage, cv2.CV_16S, kernelx)</span><br><span class="line">    y = cv2.filter2D(grayImage, cv2.CV_16S, kernely)</span><br><span class="line">    <span class="comment"># è½¬uint8</span></span><br><span class="line">    absX = cv2.convertScaleAbs(x)</span><br><span class="line">    absY = cv2.convertScaleAbs(y)</span><br><span class="line">    Roberts = cv2.addWeighted(absX, <span class="number">0.5</span>, absY, <span class="number">0.5</span>, <span class="number">0</span>)</span><br><span class="line">    ret, binary = cv2.threshold(Roberts, <span class="number">127</span>, <span class="number">255</span>, cv2.THRESH_BINARY)</span><br><span class="line">    plt.subplot(<span class="number">121</span>),plt.imshow(binary, cmap=plt.cm.gray ),plt.title(<span class="string">&#x27;äºŒå€¼å›¾&#x27;</span>), plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">    plt.subplot(<span class="number">122</span>),plt.imshow(Roberts, cmap=plt.cm.gray ),plt.title(<span class="string">&#x27;Robertsç®—å­&#x27;</span>), plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure><p>â€‹ä½¿ç”¨Prewittç®—å­è¿›è¡Œè¾¹ç¼˜æå–ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">usePrewitt</span>(<span class="params">grayImage</span>):</span><br><span class="line">    <span class="comment"># Prewittç®—å­</span></span><br><span class="line">    kernelx = np.array([[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>], [-<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>]], dtype=<span class="built_in">int</span>)</span><br><span class="line">    kernely = np.array([[-<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>], [-<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>], [-<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>]], dtype=<span class="built_in">int</span>)</span><br><span class="line">    x = cv2.filter2D(grayImage, cv2.CV_16S, kernelx)</span><br><span class="line">    y = cv2.filter2D(grayImage, cv2.CV_16S, kernely)</span><br><span class="line">    absX = cv2.convertScaleAbs(x)</span><br><span class="line">    absY = cv2.convertScaleAbs(y)</span><br><span class="line">    Prewitt = cv2.addWeighted(absX, <span class="number">0.5</span>, absY, <span class="number">0.5</span>, <span class="number">0</span>)</span><br><span class="line">    ret, binary = cv2.threshold(Prewitt, <span class="number">127</span>, <span class="number">255</span>, cv2.THRESH_BINARY)</span><br><span class="line">    plt.subplot(<span class="number">121</span>),plt.imshow(binary, cmap=plt.cm.gray ),plt.title(<span class="string">&#x27;äºŒå€¼å›¾&#x27;</span>), plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">    plt.subplot(<span class="number">122</span>),plt.imshow(Prewitt, cmap=plt.cm.gray ),plt.title(<span class="string">&#x27;Prewittç®—å­&#x27;</span>), plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure><p>â€‹ä½¿ç”¨cannyç®—å­è¿›è¡Œè¾¹ç¼˜æå–ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">useCanny</span>(<span class="params">gaussianBlur</span>):</span><br><span class="line">    <span class="comment">#using system topction</span></span><br><span class="line">    Canny = cv2.Canny(gaussianBlur, <span class="number">50</span>, <span class="number">150</span>)</span><br><span class="line">    ret, binary = cv2.threshold(Canny, <span class="number">127</span>, <span class="number">255</span>, cv2.THRESH_BINARY)</span><br><span class="line">    plt.subplot(<span class="number">121</span>),plt.imshow(binary, cmap=plt.cm.gray ),plt.title(<span class="string">&#x27;äºŒå€¼å›¾&#x27;</span>), plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">    plt.subplot(<span class="number">122</span>), plt.imshow(Canny, cmap=plt.cm.gray), plt.title(<span class="string">&#x27;Cannyç®—å­&#x27;</span>), plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br></pre></td></tr></table></figure><p>â€‹ä½¿ç”¨Marrè¿›è¡Œè¾¹ç¼˜æå–ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">useMarr</span>(<span class="params">binary</span>):</span><br><span class="line">    dst = cv2.Laplacian(binary, cv2.CV_16S, ksize = <span class="number">3</span>)</span><br><span class="line">    Laplacian = cv2.convertScaleAbs(dst)</span><br><span class="line">    ret, binary = cv2.threshold(Laplacian, <span class="number">127</span>, <span class="number">255</span>, cv2.THRESH_BINARY)</span><br><span class="line">    plt.subplot(<span class="number">121</span>),plt.imshow(binary, cmap=plt.cm.gray ),plt.title(<span class="string">&#x27;äºŒå€¼å›¾&#x27;</span>), plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">    plt.subplot(<span class="number">122</span>),plt.imshow(Laplacian, cmap=plt.cm.gray ),plt.title(<span class="string">&#x27;Laplacianç®—å­&#x27;</span>), plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br></pre></td></tr></table></figure><p>â€‹æœ€åè¾“å‡ºå›¾åƒï¼Œæ¯”è¾ƒç»“æœã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">plt.subplot(<span class="number">231</span>),plt.imshow(img_RGB),plt.title(<span class="string">&#x27;åŸå§‹å›¾åƒ&#x27;</span>), plt.axis(<span class="string">&#x27;off&#x27;</span>) <span class="comment">#åæ ‡è½´å…³é—­</span></span><br><span class="line">plt.subplot(<span class="number">232</span>),plt.imshow(binary, cmap=plt.cm.gray ),plt.title(<span class="string">&#x27;äºŒå€¼å›¾&#x27;</span>), plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">plt.subplot(<span class="number">233</span>),plt.imshow(Roberts, cmap=plt.cm.gray ),plt.title(<span class="string">&#x27;Robertsç®—å­&#x27;</span>), plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">plt.subplot(<span class="number">234</span>),plt.imshow(Prewitt, cmap=plt.cm.gray ),plt.title(<span class="string">&#x27;Prewittç®—å­&#x27;</span>), plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">plt.subplot(<span class="number">235</span>),plt.imshow(Sobel, cmap=plt.cm.gray ),plt.title(<span class="string">&#x27;Sobelç®—å­&#x27;</span>), plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">plt.subplot(<span class="number">236</span>),plt.imshow(Laplacian, cmap=plt.cm.gray ),plt.title(<span class="string">&#x27;Laplacianç®—å­&#x27;</span>), plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç›¸æœº </tag>
            
            <tag> ç¬”è®° </tag>
            
            <tag> å›¾åƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TransFusion</title>
      <link href="/2023/05/06/TransFusion/"/>
      <url>/2023/05/06/TransFusion/</url>
      
        <content type="html"><![CDATA[<p>Author: Bai, Xuyang; Hu, Zeyu; Zhu, Xinge; Huang, Qingqiu; Chen, Yilun; Fu, Hongbo; Tai, Chiew-Lan;<br>Code: <a href="https://github.com/XuyangBai/TransFusion">https://github.com/XuyangBai/TransFusion</a><br>Comment: soft calibration , attention<br>Completed: December 11, 2022<br>Key Words: Fusion, Object Detection<br>Link: arXiv:2203.11496<br>Score: â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸<br>Source: CVPR2022<br>Status: once</p><h2 id="abstract">Abstract</h2><p>é’ˆå¯¹ï¼šLidar-camera fusion ï¼ŒåŠ£è´¨å›¾åƒé²æ£’æ€§å·®è¿™ä¸ªé—®é¢˜ï¼Œè®¤ä¸ºæ˜¯ç”±å½“ä¸‹çš„hard-association (calibration)å¯¼è‡´çš„ã€‚</p><p>We propose TransFusion, a robust solution to LiDAR-camera fusion with a soft-association mechanism to handle inferior image conditions.</p><h2 id="introduction-related-work">Introduction&amp;Related work</h2><p>VoxelNet \ PointPillar ä»…ä»…ä½¿ç”¨Lidarä¿¡æ¯å°±å–å¾—äº†å¾ˆå¥½çš„æ•ˆæœã€‚ç”±äºç‚¹äº‘çš„ç¨€ç–æ€§ï¼Œè¦ä½¿ç”¨Fusion</p><p>èåˆçš„æ–¹æ³•ä¸€èˆ¬åˆ†æˆä¸‰ç§ï¼š1.result-levelï¼šPoinNetã€RoarNet 2.proposal-level:MV3D ã€AVOD</p><ol><li>point-levelï¼ˆæ›´å¥½çš„æ•ˆæœï¼‰ï¼šä¸€éƒ¨åˆ†å…ˆå°†ç‚¹äº‘æŠ•å°„åˆ°é¸Ÿç°å›¾ï¼ˆBEVï¼‰å¹³é¢ä¸Šï¼Œç„¶åå°†å›¾åƒç‰¹å¾ä¸BEVåƒç´ ç›¸èåˆ</li></ol><blockquote><p>PI-RCNN: An efficient multi-sensor 3d object detector with point-based attentive<br>cont-conv fusion module. AAAI, 2020.</p><p>3D-CVF: Generating joint camera and lidar features using cross-view spatial feature fusion for 3d object detection. ECCV, 2020</p></blockquote><p><strong>Contributions:</strong></p><ol><li>é‡‡ç”¨soft-association</li><li>ä½¿ç”¨äº†åŸºäºtransformerçš„èåˆæ–¹æ³•è¿›è¡Œç»†è…»åº¦èåˆæ¥è§£å†³3Dæ£€æµ‹é—®é¢˜ã€‚æœ‰å¾ˆå¥½çš„é²æ£’æ€§</li><li>æŸ¥è¯¢æ–¹æ³•ä¸Šçš„æ”¹è¿›</li><li>nuScenesçš„SOTAæ•ˆæœ</li></ol><h2 id="methodology">Methodology</h2><p><img src="https://img1.imgtp.com/2023/05/06/ewvQBfVs.png" alt="Untitled"></p><p>3D and 2D backbones to extract LiDAR BEV feature map and image feature map.æœ‰ä¸¤ä¸ªlayerç»„æˆ</p><p>ï¼ˆ1ï¼‰ç¬¬ä¸€å±‚ä½¿ç”¨ä¸€ç»„ç¨€ç–çš„object queryç”Ÿæˆåˆå§‹ 3D è¾¹ç•Œæ¡†ï¼Œä»¥<strong>input-dependent</strong>å’Œ<strong>category-aware</strong>çš„æ–¹å¼è¿›è¡Œåˆå§‹åŒ–ã€‚ ï¼ˆ2ï¼‰ç¬¬äºŒå±‚å°†ç¬¬ä¸€é˜¶æ®µçš„object queryï¼ˆå¸¦æœ‰åˆå§‹é¢„æµ‹ï¼‰ä¸å›¾åƒç‰¹å¾å¯†åˆ‡å…³è”å¹¶èåˆï¼Œäº§ç”Ÿä¸°å¯Œçš„çº¹ç†å’Œé¢œè‰²çº¿ç´¢ï¼Œä»¥è·å¾—æ›´å¥½çš„æ£€æµ‹ç»“æœã€‚å¼•å…¥äº†ç©ºé—´è°ƒåˆ¶äº¤å‰æ³¨æ„ (SMCA) æœºåˆ¶ä»¥æ¶‰åŠå±€éƒ¨è¯±å¯¼åå·®(locality inductive bias)å¹¶å¸®åŠ©ç½‘ç»œæ›´å¥½åœ°å…³æ³¨ç›¸å…³å›¾åƒåŒºåŸŸã€‚æˆ‘ä»¬è¿˜æå‡ºäº†ä¸€ç§å›¾åƒimage-guided query initializationç­–ç•¥ï¼Œä»¥æ¶‰åŠ LiDAR BEV ä¸Šçš„image guidanceã€‚è¯¥ç­–ç•¥æœ‰åŠ©äºç”Ÿæˆåœ¨ç¨€ç– LiDAR ç‚¹äº‘ä¸­éš¾ä»¥æ£€æµ‹åˆ°çš„object queryã€‚</p><h3 id="preliminary">Preliminary</h3><p>ç¬¬ä¸€å±‚è§£ç å™¨ï¼šä½¿ç”¨ä¸€ç»„ç¨€ç–çš„object queryä» LIDAR ç‚¹äº‘é¢„æµ‹åˆå§‹è¾¹ç•Œæ¡†</p><p>ä¸2Dä¸­çš„ input-dependent object queryä¸åŒï¼Œæˆ‘ä»¬ä½¿object queryinput-dependentå’Œcategory-awareï¼Œæ›´å¥½ä¸°å¯Œqueryçš„ä½ç½®å’Œç±»åˆ«ä¿¡æ¯ã€‚</p><p>object queryï¼šç”¨transformeræ¶æ„å­¦ä¹ ä¸€å°ç»„åµŒå…¥(embeddings)ï¼ˆå‘é‡é›†åˆï¼‰</p><p>åœ¨æˆ‘ä»¬çš„å·¥ä½œä¸­ï¼Œæ¯ä¸ªobject queryéƒ½åŒ…å«ä¸€ä¸ªæä¾›å¯¹è±¡å®šä½çš„query positionså’Œä¸€ä¸ªç¼–ç å®ä¾‹ä¿¡æ¯çš„query featureï¼Œä¾‹å¦‚æ¡†çš„å¤§å°ã€æ–¹å‘ç­‰ã€‚</p><h3 id="query-initialization">Query Initialization</h3><p>å¦‚æœèƒ½å¯¹object queries åˆè¾ƒå¥½çš„åˆå§‹åŒ–æ•ˆæœï¼Œå¯ä»¥å¼¥è¡¥1-layer å’Œ6-layersçš„æ•ˆæœå·®è·ã€‚ç»è¿‡æˆ‘ä»¬çš„è§‚å¯Ÿï¼Œæˆ‘ä»¬æå‡ºä¸€ä¸ª åŸºäº<strong>center-heatmap</strong> çš„ <strong>input-dependent</strong> çš„åˆå§‹åŒ–ç­–ç•¥ï¼Œä»…ä»…ä½¿ç”¨ä¸€å±‚layerå°±è·å¾—å¾ˆå¥½çš„æ•ˆæœã€‚</p><aside>ğŸ’¡ heatmapï¼šå³çƒ­åŠ›å›¾ï¼Œåœ¨ç›®æ ‡æ£€æµ‹çš„å›¾åƒå¤„ç†ä¸­ï¼Œé‡‡ç”¨äºŒç»´é«˜æ–¯æ ¸æ¥è¡¨ç¤ºå…³é”®ç‚¹ã€‚ä»¥boxçš„ä¸­å¿ƒç‚¹åæ ‡å–æ•´ä½œä¸ºé«˜æ–¯åœ†çš„åœ†å¿ƒï¼Œä»¥boxçš„å¤§å°ç¡®å®šé«˜æ–¯åœ†çš„åŠå¾„ï¼Œä»£å…¥é«˜æ–¯å…¬å¼ï¼Œå¡«å……é«˜æ–¯å‡½æ•°è®¡ç®—å€¼ï¼ˆ0-1ï¼‰ï¼Œåœ†å¿ƒçš„å€¼æœ€å¤§ï¼Œæ²¿åŠå¾„å‘å¤–é€’å‡ï¼Œåœ¨å›¾åƒä¸­ï¼Œä¸­å¿ƒç‚¹æœ€äº®ï¼Œæ²¿åŠå¾„å‘å¤–å˜æš—ã€‚çƒ­åŠ›å›¾ä¸­ï¼Œä¸æ˜¯ä¸­å¿ƒç‚¹çš„åœ°æ–¹å…¨éƒ¨è®¾ä¸º0ï¼Œå³é»‘è‰²åŒºåŸŸã€‚</aside><aside>ğŸ’¡ å…·ä½“æ¥è¯´ï¼Œç»™å®šä¸€ä¸ªdç»´LIDAR BEVç‰¹å¾å›¾ X*Y*Dï¼Œæˆ‘ä»¬é¦–å…ˆé¢„æµ‹ä¸€ä¸ªclass-specificçš„heatmap(X*Y*K)ï¼Œå…¶ä¸­ X Ã— Y æè¿°äº† BEV ç‰¹å¾å›¾çš„å¤§å°ï¼ŒK æ˜¯ç±»åˆ«çš„æ•°é‡ã€‚ç„¶åæˆ‘ä»¬å°†heatmapè§†ä¸º X Ã— Y Ã— K å¯¹è±¡å€™é€‰ï¼Œå¹¶é€‰æ‹©æ‰€æœ‰ç±»åˆ«çš„å‰ N ä¸ªå€™é€‰å¯¹è±¡ä½œä¸ºæˆ‘ä»¬çš„åˆå§‹object queryã€‚<p>ä¸ºäº†é¿å…ç©ºé—´ä¸Štoo closed queriesï¼Œæˆ‘ä»¬é€‰æ‹©å±€éƒ¨æœ€å¤§å…ƒç´ ä½œä¸ºæˆ‘ä»¬çš„object queryï¼Œå…¶å€¼å¤§äºæˆ–ç­‰äºå®ƒä»¬çš„8-connected neighborsã€‚å¦åˆ™ï¼Œéœ€è¦å¤§é‡çš„queryæ¥è¦†ç›–BEVå¹³é¢ã€‚æ‰€é€‰å€™é€‰è€…çš„positions å’Œfeaturesç”¨äºåˆå§‹åŒ– query positions and query featuresã€‚è¿™æ ·ï¼Œæˆ‘ä»¬çš„åˆå§‹object queryå°†å®šä½åœ¨æ½œåœ¨å¯¹è±¡ä¸­å¿ƒæˆ–é™„è¿‘ï¼Œä»è€Œæ— éœ€å¤šä¸ªè§£ç å™¨å±‚ æ¥å®Œå–„ä½ç½®ã€‚</p></aside><h2 id="category-aware">Category-aware</h2><p>BEV å¹³é¢ä¸Šçš„ç‰©ä½“éƒ½æ˜¯å…·æœ‰ç»å¯¹æ¯”ä¾‹çš„ï¼Œåœ¨åŒä¸€ç±»åˆ«ä¸­çš„æ¯”ä¾‹å·®å¼‚å¾ˆå°ã€‚å› æ­¤é€šè¿‡ç»™æ¯ä¸€ä¸ªç±»åˆ«embeddingçš„æ–¹å¼ä½¿å¾—object queries æ˜¯ category  aware çš„ã€‚</p><p>å…·ä½“åšæ³•æ˜¯ï¼Œé€šè¿‡å°†ç±»åˆ«çš„one-hotç¼–ç çº¿æ€§æŠ•å½±æˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">R^d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span></span></span>å‘é‡ï¼Œç„¶ååˆ©ç”¨è¿™ä¸ªç¼–ç å’Œquery featureç›¸åŠ ï¼Œè¿™æ ·çš„category-awareå¸¦æ¥äº†ä¸¤ä¸ªå¥½å¤„ï¼š</p><ol><li>ä¸€æ–¹é¢åœ¨self-attentionæ¨¡å—å»ºç«‹object-object relations \ cross-attention å»ºç«‹object-context relations æ—¶æä¾›äº†side information</li><li>å¦ä¸€æ–¹é¢ï¼Œåœ¨é¢„æµ‹é˜¶æ®µï¼Œå®ƒå¯ä»¥æä¾›æœ‰ä»·å€¼çš„å…ˆéªŒçŸ¥è¯†ï¼Œä½¿å¾—ç½‘ç»œä¸“æ³¨äºç±»åˆ«å†…çš„å·®å¼‚ï¼Œä»è€Œæœ‰åˆ©äºå±æ€§é¢„æµ‹</li></ol><h2 id="transformer-decoder-and-ffn-å‰é¦ˆç¥ç»ç½‘ç»œ">Transformer Decoder and FFN(å‰é¦ˆç¥ç»ç½‘ç»œ)</h2><h3 id="transformer-decoder">Transformer Decoder</h3><p><strong>object query</strong>å’Œ<strong>feature maps</strong> (æ¥è‡ªç‚¹äº‘æˆ–å›¾åƒ) ä¹‹é—´çš„äº¤å‰æ³¨æ„åŠ›å°†ç›¸å…³ä¸Šä¸‹æ–‡èšé›†åˆ°å€™é€‰å¯¹è±¡ä¸Šï¼Œè€Œ<strong>object queryä¹‹é—´çš„self attention</strong>åˆ™å¯¼è‡´ä¸åŒå€™é€‰å¯¹è±¡ä¹‹é—´çš„æˆå¯¹å…³ç³»ã€‚</p><p>query positionsé€šè¿‡å¤šå±‚æ„ŸçŸ¥å™¨ (MLP) åµŒå…¥åˆ°d-dimensional positional encodingä¸­ï¼Œå¹¶ä¸query featuresæŒ‰element-wiselyï¼ˆlistå¯¹åº”å…ƒç´ ç›¸åŠ ï¼‰ç›¸åŠ ã€‚è¿™ä½¿ç½‘ç»œèƒ½å¤Ÿå…±åŒæ¨ç†ä¸Šä¸‹æ–‡å’Œä½ç½®ã€‚</p><h3 id="å‰é¦ˆç½‘ç»œ-feed-forward-network-ffn"><strong>å‰é¦ˆç½‘ç»œ feed-forward network(FFN)</strong></h3><p>å°†åŒ…å«ä¸°å¯Œå®ä¾‹ä¿¡æ¯çš„Â <strong>N</strong>ä¸ª<strong>object query</strong>ç‹¬ç«‹è§£ç ä¸º<strong>æ¡†</strong>å’Œ<strong>ç±»æ ‡ç­¾</strong>ã€‚<br>æ ¹æ®Center-Pointï¼Œæˆ‘ä»¬çš„FFNé¢„æµ‹ä»query positionçš„ä¸­å¿ƒåç§»é‡center offsetä¸ºÎ´xï¼ŒÎ´yï¼Œè¾¹ç•Œæ¡†é«˜åº¦ä¸ºzï¼Œå¤§å°lï¼Œwï¼Œhä¸ºlogï¼ˆlï¼‰ï¼Œlogï¼ˆwï¼‰ï¼Œlogï¼ˆhï¼‰ï¼Œåèˆªè§’yaw angle Î±ä¸ºsinï¼ˆÎ±ï¼‰ï¼Œcos(Î±)ï¼Œé€Ÿåº¦ï¼ˆå¦‚æœå¯ç”¨ï¼‰ä¸ºv_x,v_yã€‚</p><p>æˆ‘ä»¬è¿˜é¢„æµ‹äº† K ä¸ªè¯­ä¹‰ç±»çš„æ¯ç±»æ¦‚ç‡pâˆˆ[0,1]ã€‚æ¯ä¸ªå±æ€§ç”±å•ç‹¬çš„ä¸¤å±‚ 1Ã—1 å·ç§¯è®¡ç®—ã€‚é€šè¿‡å°†æ¯ä¸ªobject queryè§£ç ä¸ºé¢„æµ‹ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ç»„é¢„æµ‹ ï¼Œå…¶ä¸­ï¼Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">b_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯ç¬¬iä¸ªqueryçš„é¢„æµ‹è¾¹ç•Œæ¡†ã€‚</p><p>æˆ‘ä»¬é‡‡ç”¨è¾…åŠ©è§£ç æœºåˆ¶ï¼Œåœ¨æ¯ä¸ªè§£ç å±‚ä¹‹åæ·»åŠ FFNå’Œç›‘ç£ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä»ç¬¬ä¸€ä¸ªè§£ç å™¨å±‚è·å¾—åˆå§‹è¾¹ç•Œæ¡†é¢„æµ‹ã€‚ æˆ‘ä»¬åˆ©ç”¨ LiDAR-camera fusion moduleä¸­çš„æ­¤ç±»åˆå§‹é¢„æµ‹æ¥é™åˆ¶äº¤å‰æ³¨æ„åŠ›.</p><h2 id="lidar-camera-fusion">LiDAR-Camera Fusion</h2><h3 id="image-feature-fetching">Image Feature Fetching.</h3><p><strong>point-levelèåˆæ–¹æ³•</strong>å¸¦æ¥æ”¹è¿›ï¼Œä½†èåˆè´¨é‡åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå—åˆ° LiDAR ç‚¹çš„ç¨€ç–æ€§çš„é™åˆ¶ã€‚å½“ä¸€ä¸ªç‰©ä½“åªåŒ…å«å°‘é‡çš„æ¿€å…‰é›·è¾¾ç‚¹æ—¶ï¼Œå®ƒåªèƒ½è·å–ç›¸åŒæ•°é‡çš„å›¾åƒç‰¹å¾ï¼Œæµªè´¹äº†é«˜åˆ†è¾¨ç‡å›¾åƒä¸°å¯Œçš„è¯­ä¹‰ä¿¡æ¯ã€‚</p><p>å› æ­¤æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨hard association.ä¿ç•™äº†æ‰€æœ‰çš„å›¾åƒç‰¹å¾$$F_C âˆˆ R^{NvÃ—HÃ—WÃ—d}$$ä½œä¸ºmemory bankï¼Œåœ¨transformer è§£ç å™¨ä¸­ä½¿ç”¨äº¤å‰æ³¨æ„åŠ›ï¼Œä»¥sparse-to-denseå’Œè‡ªé€‚åº”æ–¹æ³•å®ç°ç‰¹å¾èåˆã€‚</p><h3 id="smca-for-image-feature-fusion">SMCA for Image Feature Fusion.</h3><p>Multi-head attentionæ˜¯ä¸€ç§æµè¡Œçš„åœ¨ä¸¤ç»„è¾“å…¥ä¹‹é—´è¿›è¡Œä¿¡æ¯äº¤æ¢å’Œå»ºç«‹è½¯å…³è”çš„æœºåˆ¶ï¼Œå®ƒå·²è¢«å¹¿æ³›ç”¨äºç‰¹å¾åŒ¹é…ä»»åŠ¡ã€‚ä¸ºäº†å‡è½»ç¡¬å…³è”ç­–ç•¥å¸¦æ¥çš„å¯¹ä¼ æ„Ÿå™¨æ ¡å‡†å’ŒåŠ£è´¨å›¾åƒç‰¹å¾çš„æ•æ„Ÿæ€§ï¼Œæˆ‘ä»¬åˆ©ç”¨äº¤å‰æ³¨æ„æœºåˆ¶åœ¨æ¿€å…‰é›·è¾¾å’Œå›¾åƒä¹‹é—´å»ºç«‹è½¯å…³è”ï¼Œä½¿ç½‘ç»œèƒ½å¤Ÿè‡ªé€‚åº”åœ°ç¡®å®šåº”è¯¥ä»å›¾åƒä¸­è·å–å“ªäº›ä¿¡æ¯ã€‚</p><aside>ğŸ’¡ é¦–å…ˆåœ¨ä½¿ç”¨å…ˆå‰çš„é¢„æµ‹ä»¥åŠæ ¡å‡†çŸ©é˜µå®šä½object queryï¼Œç„¶ååœ¨object queryå’Œç›¸åº”çš„å›¾åƒç‰¹å¾å›¾ä¹‹é—´æ‰§è¡Œäº¤å‰æ³¨æ„åŠ›cross attentionã€‚ä½†æ˜¯ï¼Œç”±äº LiDAR ç‰¹å¾å’Œå›¾åƒç‰¹å¾æ¥è‡ªå®Œå…¨ä¸åŒçš„ç©ºé—´åŸŸï¼Œæ‰€ä»¥object queryå¯èƒ½ä¼šå…³æ³¨ä¸è¦é¢„æµ‹çš„è¾¹ç•Œæ¡†æ— å…³çš„è§†è§‰åŒºåŸŸï¼Œå¯¼è‡´ç½‘ç»œéœ€è¦å¾ˆé•¿æ—¶é—´æ‰èƒ½å‡†ç¡®è¯†åˆ«å›¾åƒä¸Šçš„æ­£ç¡®åŒºåŸŸã€‚</aside><p>æˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ª<strong>ç©ºé—´è°ƒåˆ¶äº¤å‰æ³¨æ„åŠ› (SMCA)</strong>Â æ¨¡å— ï¼Œå®ƒé€šè¿‡å›´ç»•æ¯ä¸ª<strong>query</strong>çš„æŠ•å½± 2D ä¸­å¿ƒçš„ 2D åœ†å½¢<strong>é«˜æ–¯æ©ç Gaussian mask</strong>å¯¹<strong>äº¤å‰æ³¨æ„åŠ›</strong>è¿›è¡Œ<strong>åŠ æƒ</strong>ã€‚2DÂ <strong>Gaussian</strong>Â æƒé‡<strong>maskÂ M</strong>çš„ç”Ÿæˆæ–¹å¼ä¸Â <strong>CenterNet</strong>Â ç±»ä¼¼ã€‚</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mtext>âˆ’</mtext><mfrac><mrow><mo stretchy="false">(</mo><mi>i</mi><mtext>âˆ’</mtext><mi>c</mi><mi>x</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false">(</mo><mi>j</mi><mtext>âˆ’</mtext><mi>c</mi><mi>y</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><mi>Ïƒ</mi><msup><mi>r</mi><mn>2</mn></msup></mrow></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">M_{ij} = exp(âˆ’\frac{(iâˆ’cx)^2+(jâˆ’cy)^2}{Ïƒr^2} )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.177108em;vertical-align:-0.686em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord">âˆ’</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord">âˆ’</span><span class="mord mathdefault">c</span><span class="mord mathdefault">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mord">âˆ’</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p><blockquote><p>(i, j) æ˜¯æƒé‡æ©ç  M çš„ç©ºé—´ç´¢å¼•</p><p>(cx, cy) æ˜¯é€šè¿‡å°†queryé¢„æµ‹æŠ•å½±åˆ°å›¾åƒå¹³é¢ä¸Šè®¡ç®—çš„ 2D ä¸­å¿ƒ</p><p>ræ˜¯ä¸‰ç»´è¾¹ç•Œæ¡†æŠ•å½±è§’çš„æœ€å°å¤–åˆ‡åœ†çš„åŠå¾„</p><p>Ïƒ æ˜¯è°ƒåˆ¶é«˜æ–¯åˆ†å¸ƒå¸¦å®½çš„è¶…å‚æ•°</p></blockquote><p>ç„¶åï¼Œè¿™ä¸ªweight mapä¸æ‰€æœ‰attention headsä¹‹é—´çš„cross-attention mapæŒ‰å…ƒç´ ç›¸ä¹˜ã€‚è¿™æ ·ï¼Œæ¯ä¸ªobject queryåªå…³æ³¨æŠ•å½±çš„ 2D æ¡†å‘¨å›´çš„ç›¸å…³åŒºåŸŸï¼Œè¿™æ ·ç½‘ç»œå°±å¯ä»¥æ›´å¥½æ›´å¿«åœ°æ ¹æ®è¾“å…¥çš„ LiDAR ç‰¹å¾å­¦ä¹ åœ¨å“ªé‡Œé€‰æ‹©å›¾åƒç‰¹å¾ã€‚æ³¨æ„åŠ›å›¾çš„å¯è§†åŒ–å¦‚å›¾ 3 æ‰€ç¤ºã€‚è¯¥ç½‘ç»œé€šå¸¸å€¾å‘äºå…³æ³¨é è¿‘å¯¹è±¡ä¸­å¿ƒçš„å‰æ™¯åƒç´ è€Œå¿½ç•¥ä¸ç›¸å…³çš„åƒç´ ï¼Œä¸ºå¯¹è±¡åˆ†ç±»å’Œè¾¹ç•Œæ¡†å›å½’æä¾›æœ‰ä»·å€¼çš„è¯­ä¹‰ä¿¡æ¯ã€‚ åœ¨ SMCA ä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨å¦ä¸€ä¸ª FFNï¼ˆä¸Šé¢ï¼‰ ä½¿ç”¨åŒ…å« LiDAR å’Œå›¾åƒä¿¡æ¯çš„object queryæ¥ç”Ÿæˆæœ€ç»ˆçš„è¾¹ç•Œæ¡†é¢„æµ‹ã€‚</p><p><img src="https://img1.imgtp.com/2023/05/06/5IKRezV8.png" alt="Untitled"></p><p>å›¾3Â ç¬¬ä¸€è¡Œæ˜¾ç¤ºè¾“å…¥å›¾åƒå’ŒæŠ•å½±åœ¨å›¾åƒä¸Šçš„<strong>object query</strong>çš„é¢„æµ‹ï¼Œç¬¬äºŒè¡Œæ˜¾ç¤ºäº¤å‰æ³¨æ„åŠ›å›¾ã€‚æˆ‘ä»¬çš„èåˆç­–ç•¥èƒ½å¤Ÿ<strong>åŠ¨æ€</strong>é€‰æ‹©ç›¸å…³çš„å›¾åƒåƒç´ ï¼Œå¹¶ä¸”ä¸å— LiDAR ç‚¹æ•°çš„é™åˆ¶ã€‚</p><h2 id="label-assignment-and-losses">Label Assignment and Losses</h2><p>ä½¿ç”¨Hungarian Algorithmï¼ˆåŒˆç‰™åˆ©ç®—æ³•ï¼‰è®¡ç®—åŒ¹é…æˆæœ¬ã€‚å…¶ä¸­åŒ¹é…æˆæœ¬ç”±åˆ†ç±»ã€å›å½’ã€å’ŒIoUæˆæœ¬çš„åŠ æƒå’Œå®šä¹‰ã€‚</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mrow><mi>m</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi></mrow></msub><mo>=</mo><msub><mi>Î»</mi><mn>1</mn></msub><msub><mi>L</mi><mrow><mi>c</mi><mi>l</mi><mi>s</mi></mrow></msub><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><mover accent="true"><mi>p</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mo>+</mo><msub><mi>Î»</mi><mn>2</mn></msub><msub><mi>L</mi><mrow><mi>r</mi><mi>e</mi><mi>g</mi></mrow></msub><mo stretchy="false">(</mo><mi>b</mi><mo separator="true">,</mo><mover accent="true"><mi>b</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mo>+</mo><msub><mi>Î»</mi><mn>3</mn></msub><msub><mi>L</mi><mrow><mi>i</mi><mi>o</mi><mi>u</mi></mrow></msub><mo stretchy="false">(</mo><mi>b</mi><mo separator="true">,</mo><mover accent="true"><mi>b</mi><mo>^</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">C_{match}=\lambda_1L_{cls}(p,\hat{p})+\lambda_2L_{reg}(b,\hat{b})+\lambda_3L_{iou}(b,\hat{b})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">h</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Î»</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">p</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">^</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.2439879999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">Î»</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">b</span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.2078799999999998em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Î»</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">b</span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><p>å…¶ä¸­ï¼ŒLclsæ˜¯äºŒå…ƒäº¤å‰ç†µæŸå¤±ï¼ŒLregæ˜¯é¢„æµ‹çš„BEVä¸­å¿ƒå’Œground truthä¸­å¿ƒä¹‹é—´çš„L1æŸå¤±ï¼ˆéƒ½åœ¨[0ï¼Œ1]ä¸­å½’ä¸€åŒ–ï¼‰ï¼ŒLiouæ˜¯é¢„æµ‹çš„æ–¹æ¡†å’Œground truth boxesä¹‹é—´çš„IoUæŸå¤±ã€‚</p><p>è€ƒè™‘åˆ°æ‰€æœ‰çš„åŒ¹é…å¯¹ï¼Œæˆ‘ä»¬ä¸ºåˆ†ç±»è®¡ç®—focal lossã€‚ç”¨L1 loss ä»…é’ˆå¯¹positive pairs è®¡ç®—è¾¹ç•Œç›’å›å½’ã€‚å¯¹äºheatmap prediction,æˆ‘ä»¬é‡‡ç”¨ penalty reduced focal loss(Center Pointé‡‡ç”¨çš„æ–¹æ³•)</p><p>å¯¹äºä¸¤ä¸ªè§£ç å±‚é‡‡ç”¨ä¸€æ ·çš„æ ‡ç­¾åˆ†é…ç­–ç•¥å’ŒæŸå¤±å…¬å¼ã€‚</p><h2 id="image-guided-query-initialization">image-guided query initialization</h2><p>ä¸ºäº†è¿›ä¸€æ­¥åˆ©ç”¨é«˜åˆ†è¾¨ç‡å›¾åƒæ£€æµ‹å°ç‰©ä½“çš„èƒ½åŠ›å¹¶ä½¿æˆ‘ä»¬çš„ç®—æ³•å¯¹ç¨€ç–çš„ LiDAR ç‚¹äº‘æ›´åŠ é²æ£’ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§Image-Guided Query Initializationç­–ç•¥ï¼Œè¯¥ç­–ç•¥åˆ©ç”¨Â <strong>LiDAR</strong>Â å’Œ<strong>camera</strong>ä¿¡æ¯æ¥é€‰æ‹©<strong>object query</strong>ã€‚</p><p><img src="https://img1.imgtp.com/2023/05/06/ZeUbu1wt.png" alt="Untitled"></p><p>æˆ‘ä»¬é¦–å…ˆæ²¿å‚ç›´ç»´åº¦æµ“ç¼©å›¾åƒç‰¹å¾ï¼Œç„¶ååˆ©ç”¨LiDAR BEVç‰¹å¾çš„äº¤å‰æ³¨æ„å°†è¿™äº›ç‰¹å¾æŠ•å°„åˆ°BEVå¹³é¢ä¸Šã€‚æ¯å¹…å›¾åƒéƒ½ç”±ä¸€ä¸ªå•ç‹¬çš„å¤šå¤´å…³æ³¨å±‚å¤„ç†ï¼Œå®ƒæ•æ‰åˆ°å›¾åƒåˆ—å’ŒBEVä½ç½®ä¹‹é—´çš„å…³ç³»ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è®ºæ–‡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬”è®° </tag>
            
            <tag> è®ºæ–‡ </tag>
            
            <tag> cvpr </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Data Fusion</title>
      <link href="/2023/05/06/Data-Fusion/"/>
      <url>/2023/05/06/Data-Fusion/</url>
      
        <content type="html"><![CDATA[<h2 id="åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ</h2><p>1.1 å¤šä¼ æ„Ÿå™¨ä¿¡æ¯èåˆæ˜¯ç”¨äºåŒ…å«å¤„äºä¸åŒä½ç½®çš„å¤šä¸ªæˆ–å¤šç§ä¼ æ„Ÿå™¨çš„ä¿¡æ¯å¤„ç†æŠ€æœ¯</p><p>1.2 æ ¹æ®èåˆå±‚æ¬¡å¯ä»¥åˆ†ä¸ºï¼šæ•°æ®çº§ã€ç‰¹å¾çº§ã€å†³ç­–çº§</p><ul><li><p>ç‰¹å¾çº§èåˆ</p><p>å…ˆä»å„ä¸ªä¼ æ„Ÿå™¨æä¾›çš„åŸå§‹æ•°æ®ä¸­æå–ä»£è¡¨æ€§ç‰¹å¾ï¼Œå†æŠŠè¿™äº›ç‰¹å¾èåˆæˆå•ä¸€ç‰¹å¾å‘é‡ï¼›å…¶ä¸­é€‰æ‹©åˆé€‚çš„ç‰¹å¾è¿›è¡Œèåˆæ˜¯å…³é”®ï¼›ç‰¹å¾ä¿¡æ¯åŒ…æ‹¬è¾¹ç¼˜ã€æ–¹å‘ã€é€Ÿåº¦ã€å½¢çŠ¶</p><ul><li><p>å¯ä»¥åˆ’åˆ†ä¸ºç›®æ ‡çŠ¶æ€èåˆå’Œç›®æ ‡ç‰¹æ€§èåˆ</p><ul><li>ç›®æ ‡çŠ¶æ€èåˆï¼šä¸»è¦åº”ç”¨äºå¤šä¼ æ„Ÿå™¨çš„ç›®æ ‡è·Ÿè¸ªé¢†åŸŸï¼›èåˆç³»ç»Ÿé¦–å…ˆå¯¹ä¼ æ„Ÿå™¨æ•°æ®è¿›è¡Œé¢„å¤„ç†ä»¥å®Œæˆæ•°æ®é…å‡†ï¼Œåœ¨æ•°æ®é…å‡†ä¹‹åï¼Œèåˆå¤„ç†ä¸»è¦å®ç°å‚æ•°å…³è”å’ŒçŠ¶æ€ä¼°è®¡ã€‚</li><li>ç›®æ ‡ç‰¹æ€§èåˆï¼šå°±æ˜¯ç‰¹å¾å±‚è”åˆè¯†åˆ«ï¼Œå®ƒçš„å®è´¨å°±æ˜¯æ¨¡å¼è¯†åˆ«é—®é¢˜ï¼›åœ¨èåˆå‰å¿…é¡»å…ˆå¯¹ç‰¹å¾è¿›è¡Œå…³è”å¤„ç†ï¼Œå†å¯¹ç‰¹å¾çŸ¢é‡åˆ†ç±»æˆæœ‰æ„ä¹‰çš„ç»„åˆ</li></ul>  <aside>  ğŸ“Œ æˆ‘æ„Ÿè§‰æ„æ€å°±æ˜¯ä¸€ä¸ªæ˜¯å…ˆæŠŠæ•°æ®é…é½ï¼Œç„¶åä¸€èµ·æ”¾è¿›å»ï¼Œä¸€ä¸ªæ˜¯è¦æŠŠæ•°æ®å…³è”æˆä¸€ä¸ªå¤§çš„ç‰¹å¾å‘é‡  </aside></li></ul></li><li><p>å†³ç­–çº§èåˆ</p><ul><li>å±äºé«˜å±‚æ¬¡çº§èåˆï¼Œæ˜¯å¯¹æ•°æ®é«˜å±‚æ¬¡çº§çš„æŠ½è±¡ï¼Œè¾“å‡ºæ˜¯ä¸€ä¸ªè”åˆå†³ç­–ç»“æœï¼Œåœ¨ç†è®ºä¸Šè¿™ä¸ªè”åˆå†³ç­–åº”æ¯”ä»»ä½•å•ä¼ æ„Ÿå™¨å†³ç­–æ›´ç²¾ç¡®æˆ–æ›´æ˜ç¡®ï¼›</li><li>å†³ç­–å±‚èåˆåœ¨ä¿¡æ¯å¤„ç†æ–¹é¢å…·æœ‰å¾ˆé«˜çš„çµæ´»æ€§ï¼Œç³»ç»Ÿå¯¹ä¿¡æ¯ä¼ è¾“å¸¦å®½è¦æ±‚å¾ˆä½ï¼Œèƒ½æœ‰æ•ˆåœ°èåˆåæ˜ ç¯å¢ƒæˆ–ç›®æ ‡å„ä¸ªä¾§é¢çš„ä¸åŒç±»å‹ä¿¡æ¯ï¼Œè€Œä¸”å¯ä»¥å¤„ç†éåŒæ­¥ä¿¡æ¯ï¼›</li><li>ç”±äºç¯å¢ƒå’Œç›®æ ‡çš„æ—¶å˜åŠ¨æ€ç‰¹æ€§ã€å…ˆéªŒçŸ¥è¯†è·å–çš„å›°éš¾ã€çŸ¥è¯†åº“çš„å·¨é‡ç‰¹æ€§ã€é¢å‘å¯¹è±¡çš„ç³»ç»Ÿè®¾è®¡è¦æ±‚ç­‰ï¼Œå†³ç­–å±‚èåˆç†è®ºä¸æŠ€æœ¯çš„å‘å±•ä»å—åˆ°ä¸€å®šçš„é™åˆ¶ï¼›</li></ul></li></ul><h2 id="ä¿¡æ¯èåˆç›¸å…³æ¡ä»¶">ä¿¡æ¯èåˆç›¸å…³æ¡ä»¶</h2><ul><li><p>2.1 èåˆçš„å…ˆå†³æ¡ä»¶</p><ul><li>è¿åŠ¨è¡¥å¿</li></ul><p>è‡ªèº«çš„è¿åŠ¨è¡¥å¿å’Œæ¥è‡ªäºå…¶ä»–ç›®æ ‡çš„è¿åŠ¨è¡¥å¿ã€‚ç®€å•è¯´å°±æ˜¯é‡‡é›†ä¸€åœˆçš„æ—¶é—´å‘¨æœŸå†…ï¼Œæ— äººè½¦è‡ªèº«ä¼šæœ‰ä¸€å®šçš„ä½ç§»ï¼ŒåŒæ—¶å…¶ä»–è¿åŠ¨ç‰©ä½“ä¹Ÿä¼šç”±äºè‡ªèº«è¿åŠ¨äº§ç”Ÿç›¸å¯¹ä½ç§»</p><ul><li>æ—¶é—´åŒæ­¥</li></ul><p>é€šè¿‡ç»Ÿä¸€çš„ä¸»æœºç»™å„ä¸ªä¼ æ„Ÿå™¨æä¾›åŸºå‡†æ—¶é—´ï¼Œå„ä¼ æ„Ÿå™¨æ ¹æ®å·²ç»æ ¡å‡†çš„æ—¶é—´å„è‡ªç‹¬ç«‹é‡‡é›†æ•°æ®å¹¶åŠ ä¸Šæ—¶é—´æˆ³ï¼Œä»¥åšåˆ°æ‰€æœ‰çš„ä¼ æ„Ÿå™¨æ—¶é—´æˆ³åŒæ­¥ï¼Œä½†é‚£æ—¶ç”±äºå„ä¸ªä¼ æ„Ÿå™¨å„è‡ªé‡‡é›†å‘¨æœŸç›¸äº’ç‹¬ç«‹ï¼Œæ— æ³•ä¿è¯åŒä¸€æ—¶åˆ»é‡‡é›†åˆ°ç›¸åŒçš„ä¿¡æ¯</p><ul><li>ç©ºé—´åŒæ­¥</li></ul><p>å°†ä¸åŒä¼ æ„Ÿå™¨åæ ‡ç³»ä¸‹çš„æµ‹é‡å€¼è½¬åŒ–åˆ°åŒä¸€ä¸ªåæ ‡ç³»ä¸­ã€‚ï¼ˆä¼ æ„Ÿå™¨æ ‡å®šï¼‰</p></li><li><p>2.2 å¤šä¼ æ„Ÿå™¨èåˆçš„åŸºæœ¬æ€è·¯</p><p>æ‘„åƒå¤´ä¸æ¿€å…‰é›·è¾¾æ•°æ®èåˆçš„åŸºæœ¬æ€è·¯</p><ul><li><p>éšœç¢ç‰©çš„æ£€æµ‹å¯ä»¥ä½¿ç”¨æ¿€å…‰é›·è¾¾è¿›è¡Œç‰©ä½“èšç±»ï¼Œä½†æ˜¯å¯¹äºè¾ƒè¿œç‰©ä½“è¿‡äºç¨€ç–çš„æ¿€å…‰çº¿æ•°èšç±»çš„æ•ˆæœè¾ƒå·®ï¼Œå› æ­¤åˆ©ç”¨è§†è§‰å›¾åƒä¿¡æ¯è¿›è¡Œç›®æ ‡æ£€æµ‹ï¼Œè¿›è€Œè·å–éšœç¢ç‰©çš„ä½ç½®ï¼ŒåŒæ—¶è§†è§‰è¿˜å¯ä»¥ç»™å‡ºéšœç¢ç‰©ç±»åˆ«ä¿¡æ¯ï¼›</p></li><li><p>èåˆçš„å…³é”®æ˜¯éœ€è¦å°†æ‘„åƒå¤´å’Œæ¿€å…‰é›·è¾¾è¿›è¡Œè”åˆæ ‡å®šï¼Œè·å–ä¸¤è€…åæ ‡ç³»çš„ç©ºé—´è½¬æ¢å…³ç³»ï¼›å¯ä»¥é€šè¿‡æ ‡å®šçš„æ–¹å¼ï¼ŒæŠŠæ¿€å…‰é›·è¾¾æŠ•å°„åˆ°å›¾åƒçš„åæ ‡ç³»ä¸­ï¼Œå»ºç«‹å›¾åƒçš„åƒç´ ç‚¹ï¼Œå’Œæ¿€å…‰é›·è¾¾æŠ•å½±åçš„ç‚¹ä¹‹é—´åšåŒ¹é…ï¼Œç„¶åé€šè¿‡æŸç§ä¼˜åŒ–æ–¹ç¨‹ï¼Œæ¥è§£å†³åŒ¹é…é—®é¢˜ï¼›</p>  <aside>  ğŸ“Œ è¿™é‡Œåº”è¯¥å°±æ˜¯å’Œè€å¸ˆæåˆ°çš„å°† æ¿€å…‰é›·è¾¾ å’Œ æ‘„åƒå¤´ çš„åƒç´ ç‚¹ æ—¶ç©ºé…å‡†  </aside></li><li><p>æ¿€å…‰é›·è¾¾å¯ä»¥å¾—åˆ°ç›®æ ‡çš„3D æ•°æ®ï¼ˆx, y , z)ï¼Œé€šè¿‡æ ‡å®šå‚æ•°ï¼Œä»¥åŠç›¸æœºæœ¬èº«çš„å†…å‚ï¼Œå¯ä»¥æŠŠæ¿€å…‰é›·è¾¾çš„3Dç‚¹æŠ•å°„åˆ°å›¾åƒä¸Šï¼Œå›¾åƒä¸Šçš„æŸäº›åƒç´ å°±ä¼šè·å¾—æ¿€å…‰é›·è¾¾çš„æ·±åº¦ä¿¡æ¯ï¼Œç„¶åä¾¿å¯ä»¥åšåŸºäºå›¾åƒçš„åˆ†å‰²æˆ–è€…æ·±åº¦å­¦ä¹ æ¨¡å‹</p></li></ul></li></ul><h2 id="ç›¸å…³è®ºæ–‡">ç›¸å…³è®ºæ–‡</h2><ul><li><p>[ ]  ä»ä¼ªæ ‡å®šå¯¹è±¡ä¸­å»ºç«‹è™šæ‹Ÿç‚¹å¯¹åº”å…³ç³»å®ç°æ¿€å…‰é›·è¾¾-ç›¸æœºç³»ç»Ÿçš„å¤–éƒ¨æ ‡å®š</p></li><li><p>[ ]  èåˆ3D-2Då’Œ3D-3Dç‚¹å¯¹åº”å…³ç³»çš„æ¿€å…‰é›·è¾¾-ç›¸æœºç³»ç»Ÿå‡ ä½•æ ‡å®š</p></li><li><p>[ ]  åŸºäºLambertianæ¨¡å‹çš„æ ‡å‡†å¼•å¯¼æ·±åº¦è¡¥å…¨ æ¿€å…‰é›·è¾¾-ç›¸æœºç³»ç»Ÿ</p></li><li><p>[ ]  ä¸€ç§åŸºäºç°åº¦åŠ æƒçª—å£çš„çº¢å¤–ä¸å¯è§å…‰å›¾åƒé…å‡†ç®—æ³•</p></li></ul><aside>âœï¸ å‰ä¸¤ç¯‡è®ºæ–‡éƒ½æ˜¯åœ¨è®²LiDSAR-Camera Calibrationï¼Œé‡ç‚¹åœ¨äºæå‡ºäº†ä»€ä¹ˆæ ·çš„æ–¹æ³•è§£å†³æ¿€å…‰é›·è¾¾å’Œæ‘„åƒæœº åƒç´ ç‚¹ä¹‹é—´çš„æ—¶ç©ºé…å‡†é—®é¢˜ã€‚ç¬¬ä¸‰ç¯‡å…³äºæ¿€å…‰é›·è¾¾å’Œæ‘„åƒæœºçš„æ·±åº¦è¡¥å…¨çš„å†…å®¹ï¼Œå±äºç«‹ä½“è®¡ç®—æœºè§†è§‰é¢†åŸŸã€‚æœ€åä¸€ç¯‡ä»…å…³äºå›¾åƒé…å‡†ç®—æ³•ï¼Œå±äºå›¾åƒèåˆçš„é¢†åŸŸã€‚</aside><h2 id="åè¯è§£é‡Š">åè¯è§£é‡Š</h2><h3 id="lidar-camera-calibration">LiDAR-camera Calibration</h3><p>æ¿€å…‰é›·è¾¾å’Œæ‘„åƒå¤´è”åˆæ ‡å®šï¼š</p><p>æ ‡å®šå°±æ˜¯æ‰¾åˆ°é›·è¾¾åˆ°ç›¸æœºçš„ç©ºé—´è½¬æ¢å…³ç³»ï¼Œåœ¨ä¸åŒçš„åæ ‡ç³»ä¹‹é—´è½¬æ¢éœ€è¦æ—‹è½¬çŸ©é˜µ R å’Œå¹³ç§»çŸ©é˜µ Tï¼Œä¸ºåç»­çš„é›·è¾¾å’Œç›¸æœºæ•°æ®èåˆåšå‡†å¤‡</p><p>é€šå¸¸ï¼Œæ ‡å®šæ¿€å…‰å’Œç›¸æœºä¹‹é—´çš„å¤–å‚æ•°æœ‰ä¸¤ç±»æ–¹æ³•ï¼šä¸€ç±»æ˜¯åˆ©ç”¨ 3D-3D çš„çº¦æŸï¼Œå³åˆ©ç”¨æ¿€å…‰æµ‹é‡çš„ä¸‰ç»´æ¿€å…‰ç‚¹ (3D) å’Œç›¸æœºæµ‹é‡çš„æ ‡å®šæ¿ä¸‰ç»´åæ ‡ (3D) ä¸¤è€…æ¥æ„å»ºçº¦æŸï¼›å¦ä¸€ç±»æ˜¯åˆ©ç”¨ 3D-2D çš„çº¦æŸï¼Œå³åˆ©ç”¨æ¿€å…‰æµ‹é‡çš„ä¸‰ç»´æ¿€å…‰ç‚¹ (3D) å’Œå›¾åƒäºŒç»´ç‰¹å¾ï¼ˆ2Dã€ç‚¹ç‰¹å¾ã€çº¿æ®µç‰¹å¾ï¼‰æ¥æ„å»ºçº¦æŸã€‚</p><h3 id="image-registration">Image Registration</h3><p>å›¾åƒé…å‡†ï¼š</p><p>å›¾åƒé…å‡†ç›®çš„åœ¨äº<strong>æ¯”è¾ƒæˆ–èåˆé’ˆå¯¹åŒä¸€å¯¹è±¡åœ¨ä¸åŒæ¡ä»¶ä¸‹è·å–çš„å›¾åƒ</strong>ï¼Œä¾‹å¦‚å›¾åƒä¼šæ¥è‡ªä¸åŒçš„é‡‡é›†è®¾å¤‡ï¼Œå–è‡ªä¸åŒçš„æ—¶é—´ï¼Œä¸åŒçš„æ‹æ‘„è§†è§’ç­‰ç­‰ï¼Œæœ‰æ—¶ä¹Ÿéœ€è¦ç”¨åˆ°é’ˆå¯¹ä¸åŒå¯¹è±¡çš„å›¾åƒé…å‡†é—®é¢˜ã€‚</p><p>å…·ä½“åœ°è¯´ï¼Œå¯¹äºä¸€ç»„å›¾åƒæ•°æ®é›†ä¸­çš„ä¸¤å¹…å›¾åƒï¼Œé€šè¿‡å¯»æ‰¾ä¸€ç§ç©ºé—´å˜æ¢æŠŠä¸€å¹…å›¾åƒï¼ˆæµ®åŠ¨å›¾åƒï¼Œmoving imageï¼‰æ˜ å°„åˆ°å¦ä¸€å¹…å›¾åƒï¼ˆå‚è€ƒå›¾åƒï¼Œfixed imageï¼‰ä¸Šï¼Œä½¿å¾—ä¸¤å›¾ä¸­å¯¹åº”äºç©ºé—´åŒä¸€ä½ç½®çš„ç‚¹ä¸€ä¸€å¯¹åº”èµ·æ¥ï¼Œä»è€Œè¾¾åˆ°ä¿¡æ¯èåˆçš„ç›®çš„ã€‚</p><p>å›¾åƒé…å‡†å¸¸ä¸ºå›¾åƒèåˆçš„ä¸€ä¸ªé¢„å¤„ç†æ­¥éª¤ã€‚ç»è¿‡ç²¾ç¡®å›¾åƒé…å‡†çš„å›¾åƒå¯¹ï¼Œé€šå¸¸å¯è·å¾—æ›´å¥½çš„èåˆæ•ˆæœã€‚</p><h3 id="depth-completion">Depth Completion</h3><p>æ·±åº¦è¡¥å…¨ï¼š</p><p>æ·±åº¦è¡¥å…¨ä»»åŠ¡çš„ç›®æ ‡æ˜¯ä»ç¨€ç–å’Œä¸è§„åˆ™ç‚¹äº‘ç”Ÿæˆå¯†é›†çš„æ·±åº¦é¢„æµ‹ï¼Œç„¶åå°†é¢„æµ‹çš„æ·±åº¦ä¿¡æ¯æ˜ å°„åˆ°2Då¹³é¢ã€‚</p><h3 id="lidar-camera-system">LiDAR-Camera System</h3><p>åŸºäºå…‰æŸæµ‹é‡çš„è·ç¦»ï¼ŒLiDARé€šè¿‡ç”Ÿæˆç¨€ç–çš„ç‚¹äº‘æ¥æ£€æµ‹å‘¨å›´çš„ç¯å¢ƒã€‚å•çœ¼ç›¸æœºåœ¨å…¶è§†åœºï¼ˆFOVï¼‰å†…æ•è·2Då¯†é›†çš„RGBä¿¡æ¯ã€‚é€šè¿‡èåˆLiDARæ•°æ®å’Œå›¾åƒï¼ŒLiDAR-ç›¸æœºç³»ç»Ÿå¯ä»¥å¤„ç†é«˜çº§æ„ŸçŸ¥è§†è§‰ä»»åŠ¡ï¼Œå¦‚3Dç‰©ä½“æ£€æµ‹ã€‚</p><p>ç„¶è€Œï¼ŒLiDAR-ç›¸æœºç³»ç»Ÿçš„ä¼ æ„Ÿå™¨èåˆéœ€è¦ç›¸æœºå’ŒLiDARåæ ‡ç³»çš„åˆšæ€§è½¬æ¢ã€‚è¿™ç§åˆšæ€§è½¬æ¢è¢«å®šä¹‰ä¸ºLiDAR-ç›¸æœºç³»ç»Ÿçš„å¤–åœ¨å‚æ•°ã€‚å®ƒå¯ä»¥ç”±ä¸€ä¸ªæ—‹è½¬çŸ©é˜µRå’Œä¸€ä¸ªå¹³ç§»çŸ¢é‡Tè¡¨ç¤ºã€‚Rå’ŒTæ˜¯LiDAR-ç›¸æœºç³»ç»Ÿçš„å¤–åœ¨å‚æ•°ã€‚å¤–éƒ¨æ ‡å®šçš„ç›®çš„æ˜¯ä¼°è®¡å®ƒä»¬ã€‚</p><h3 id="pose-estimation">Pose Estimation</h3><h3 id="pnp-é—®é¢˜-epnp-ç®—æ³•">PnP é—®é¢˜ ã€EPnP ç®—æ³•</h3><p>PnP(Perspective-n-Point)æ˜¯æ±‚è§£3Dåˆ°2Dç‚¹å¯¹è¿åŠ¨çš„æ–¹æ³•ï¼Œç›®çš„æ˜¯æ±‚è§£ç›¸æœºåæ ‡ç³»ç›¸å¯¹ä¸–ç•Œåæ ‡ç³»çš„ä½å§¿ã€‚å®ƒæè¿°äº†å·²çŸ¥nä¸ª3Dç‚¹çš„åæ ‡(ç›¸å¯¹ä¸–ç•Œåæ ‡ç³»)ä»¥åŠè¿™äº›ç‚¹çš„åƒç´ åæ ‡æ—¶ï¼Œå¦‚ä½•ä¼°è®¡ç›¸æœºçš„ä½å§¿(å³æ±‚è§£ä¸–ç•Œåæ ‡ç³»åˆ°ç›¸æœºåæ ‡ç³»çš„æ—‹è½¬çŸ©é˜µRå’Œå¹³ç§»å‘é‡t)ã€‚</p><h2 id="å®éªŒè¦æ±‚">å®éªŒè¦æ±‚</h2><p><strong>ç›®çš„è¦æ±‚ï¼š</strong></p><ol><li>åŸ¹å…»å­¦ç”Ÿçš„è°ƒæŸ¥ç ”ç©¶ã€æ”¶é›†ä¿¡æ¯ã€æŸ¥æ‰¾æ–‡çŒ®çš„èƒ½åŠ›</li><li>æ£€éªŒã€å·©å›ºã€æå‡å­¦ç”Ÿå¯¹è®¡ç®—æœºè§†è§‰ã€æ·±åº¦å­¦ä¹ çš„åŸºæœ¬çŸ¥è¯†ã€åŸºæœ¬ç†è®ºä¸åŸºæœ¬æŠ€èƒ½çš„æŒæ¡ç¨‹åº¦ï¼›</li><li>ç†Ÿæ‚‰ç›¸æœºä¸æ¿€å…‰é›·è¾¾ç›¸å…³çš„è½¯ç¡¬ä»¶çš„ä½¿ç”¨</li></ol><p>è¦æ±‚å­¦ç”Ÿç‹¬ç«‹è§‚å¯Ÿã€åˆ†æã€åˆ¤æ–­ã€æå‡ºç§‘å­¦é—®é¢˜ï¼Œç”¨å‘æ•£æ€ç»´å’Œé›†ä¸­æ€ç»´ï¼Œæ„æ€å¤šç§è§£å†³æ–¹æ¡ˆå¹¶ç»§è€Œä¼˜é€‰å†³ç­–ï¼Œè§£å†³é—®é¢˜ï¼Œæ•´ç†åŠ å·¥ï¼Œå½¢æˆè®ºæ–‡</p><p>**ä¸»è¦å†…å®¹ï¼š**é’ˆå¯¹æ— äººè‰‡åœ¨æ°´é¢ç¯å¢ƒä¸‹çš„ç›®æ ‡æ£€æµ‹ä»»åŠ¡ã€‚</p><ol><li>ç†Ÿæ‚‰ç›¸æœºä»¥åŠæ¿€å…‰é›·è¾¾çš„ç¡¬ä»¶çŸ¥è¯†ï¼Œåœ¨å¼€å‘æ¿ä¸Šå®ç°å¯¹ç›¸æœºä¸æ¿€å…‰é›·è¾¾çš„è°ƒç”¨</li><li>å®Œæˆç›¸æœºä¸æ¿€å…‰é›·è¾¾çš„æ ‡å®šï¼Œå®ç°ç©ºé—´å¯¹é½</li><li>æ ¹æ®æ°´é¢ç¯å¢ƒå•ä¸€ã€ç‰¹å¾ä¿¡æ¯å¼±çš„ç‰¹ç‚¹è®¾è®¡æ°´é¢3Dç›®æ ‡æ£€æµ‹æ¨¡å‹ï¼Œç»†åŒ–æ¿€å…‰é›·è¾¾ä¸ç›¸æœºçš„ä½ç½®é…å‡†ï¼Œå¹¶åŸºäºå¯¹æ¿€å…‰é›·è¾¾ä¸ç›¸æœºç‰¹å¾å±‚èåˆï¼Œå®ç°æ°´é¢ç›®æ ‡3Dæ£€æµ‹ã€‚å¹¶åœ¨å…¬å¼€æ•°æ®é›†ä¸Šå¯¹ç½‘ç»œè¿›è¡Œé¢„è®­ç»ƒã€‚</li><li>æ”¶é›†çœŸå®æ°´é¢ç‚¹äº‘ä¸å›¾åƒæ•°æ®ï¼Œå°†é¢„è®­ç»ƒæ¨¡å‹è¿ç§»åˆ°æ°´é¢åœºæ™¯å¹¶æµ‹è¯•ã€‚è¿›ä¸€æ­¥åŸºäºå¡å°”æ›¼æ»¤æ³¢æ–¹æ³•ï¼Œé€šè¿‡æ¿€å…‰é›·è¾¾ä¸ç‚¹äº‘çš„å†³ç­–èåˆè¿›æå‡ç›®æ ‡æ£€æµ‹çš„å‡†ç¡®ç‡ã€‚</li><li>æµ‹è¯•ä¸æ¨¡å‹è°ƒæ•´ï¼Œå¯¹ç»“æœè¿›è¡Œåˆ†æä¸æ€»ç»“ï¼Œå®Œæˆè®ºæ–‡æ”¥å†™</li></ol><p><strong>é¢„æœŸç›®æ ‡ï¼š</strong></p><ol><li>å®ç°ç®—æ³•çš„è®¾è®¡ï¼Œå®ç°åŒç›®ç›¸æœºä¸æ¿€å…‰é›·è¾¾çš„ä¼˜åŠ¿äº’è¡¥ï¼Œåœ¨ç‰¹å¾çº§ä¸å†³ç­–çº§å®ç°æ¿€å…‰é›·è¾¾ä¸ç›¸æœºçš„èåˆï¼Œèƒ½å‡†ç¡®åœ°å¯¹æ°´é¢ä¸åŒå°ºå¯¸çš„ç›®æ ‡è¿›è¡Œæ£€æµ‹ï¼Œå¹¶å¾—åˆ°ç›®æ ‡èˆ¹åªçš„ç›¸å¯¹ä½ç½®ã€‚</li><li>ç®—æ³•åœ¨ä¸€å®šç¨‹åº¦ä¸Šé€‚åº”æ°´é¢ç¯å¢ƒçš„ç‰¹æ®Šæ€§ï¼Œåœ¨é¢ ç°¸æƒ…å†µä¸‹ä¹Ÿæœ‰ä¸€å®šæ•ˆæœã€‚</li><li>ç®—æ³•é€Ÿç‡åŸºæœ¬æ»¡è¶³æ— äººè‰‡å®æ—¶è¿ä½œéœ€æ±‚ã€‚</li></ol><p><strong>å‚è€ƒèµ„æ–™ï¼š</strong></p><p>[1] Y. LiÂ <em>et al</em>., â€œDeepFusion: Lidar-Camera Deep Fusion for Multi-Modal 3D Object Detection,â€Â <em>2022 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>,2022, pp. 17161-17170, doi: 10.1109/CVPR52688.2022.01667.</p><p>[2] Pei An <em>et al</em>., â€œGeometric calibration for LiDAR-camera system fusing 3D-2D and 3D-3D point correspondences,â€ Opt. ExpressÂ 28, 2122-2141 (2020)</p><p>[3] Pei An <em>et al</em>., â€œLiDAR-camera system extrinsic calibration by establishing virtual point correspondences from pseudo calibration objects,â€ Opt. ExpressÂ 28, 18261-18282 (2020)</p><h2 id="ä¸åŒçš„èåˆç­–ç•¥">ä¸åŒçš„èåˆç­–ç•¥</h2><p><strong>ç‰©ä½“æ£€æµ‹çš„ç­–ç•¥åˆ†ä¸ºï¼šå†³ç­–å±‚èåˆï¼Œå†³ç­–+ç‰¹å¾å±‚èåˆï¼Œä»¥åŠç‰¹å¾å±‚èåˆ</strong>ã€‚åœ¨å†³ç­–å±‚èåˆä¸­ï¼Œå›¾åƒå’Œç‚¹äº‘åˆ†åˆ«å¾—åˆ°ç‰©ä½“æ£€æµ‹ç»“æœï¼ˆBoundingBoxï¼‰ï¼Œè½¬æ¢åˆ°ç»Ÿä¸€åæ ‡ç³»åå†è¿›è¡Œåˆå¹¶ã€‚è¿™ç§ç­–ç•¥ä¸­ç”¨åˆ°çš„å¤§éƒ½æ˜¯ä¸€äº›ä¼ ç»Ÿçš„æ–¹æ³•ï¼Œæ¯”å¦‚IoUè®¡ç®—ï¼Œå¡å°”æ›¼æ»¤æ³¢ç­‰ï¼Œä¸æ·±åº¦å­¦ä¹ å…³ç³»ä¸å¤§ã€‚ä¸‹é¢é‡ç‚¹æ¥è®²è®²åä¸¤ç§èåˆç­–ç•¥ã€‚</p><h3 id="2-1-å†³ç­–-ç‰¹å¾å±‚èåˆ"><strong>2.1 å†³ç­–+ç‰¹å¾å±‚èåˆ</strong></h3><p>è¿™ç§ç­–ç•¥çš„ä¸»è¦æ€è·¯æ˜¯å°†<strong>å…ˆé€šè¿‡ä¸€ç§æ•°æ®ç”Ÿæˆç‰©ä½“çš„å€™é€‰æ¡†ï¼ˆProposalï¼‰</strong>ã€‚å¦‚æœé‡‡ç”¨å›¾åƒæ•°æ®ï¼Œé‚£ä¹ˆç”Ÿæˆçš„å°±æ˜¯2Då€™é€‰æ¡†ï¼Œå¦‚æœé‡‡ç”¨ç‚¹äº‘æ•°æ®ï¼Œé‚£ä¹ˆç”Ÿæˆçš„å°±æ˜¯3Då€™é€‰æ¡†ã€‚<strong>ç„¶åå°†å€™é€‰æ¡†ä¸å¦å¤–ä¸€ç§æ•°æ®ç›¸ç»“åˆæ¥ç”Ÿæˆæœ€ç»ˆçš„ç‰©ä½“æ£€æµ‹ç»“æœ</strong>ï¼ˆä¹Ÿå¯ä»¥å†é‡å¤åˆ©ç”¨ç”Ÿæˆå€™é€‰æ¡†çš„æ•°æ®ï¼‰ã€‚è¿™ä¸ªç»“åˆçš„è¿‡ç¨‹å°±æ˜¯å°†å€™é€‰æ¡†å’Œæ•°æ®ç»Ÿä¸€åˆ°ç›¸åŒçš„åæ ‡ç³»ä¸‹ï¼Œå¯ä»¥æ˜¯3Dç‚¹äº‘åæ ‡ï¼ˆæ¯”å¦‚F-PointNetï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯2Då›¾åƒåæ ‡ï¼ˆæ¯”å¦‚IPODï¼‰ã€‚</p><p><strong>F-PointNet[2]ç”±å›¾åƒæ•°æ®ç”Ÿæˆ2Dç‰©ä½“å€™é€‰æ¡†ï¼Œç„¶åå°†è¿™äº›å€™é€‰æ¡†æŠ•å½±åˆ°3Dç©ºé—´</strong>ã€‚æ¯ä¸ª2Då€™é€‰æ¡†åœ¨3Dç©ºé—´å¯¹åº”ä¸€ä¸ªè§†æ¤ä½“ï¼ˆFrustumï¼‰ï¼Œå¹¶å°†è½åˆ°è§†æ¤ä½“ä¸­æ‰€æœ‰ç‚¹åˆå¹¶èµ·æ¥ä½œä¸ºè¯¥å€™é€‰æ¡†çš„ç‰¹å¾ã€‚è§†æ¤ä½“ä¸­çš„ç‚¹å¯èƒ½æ¥è‡ªå‰æ™¯çš„é®æŒ¡ç‰©ä½“æˆ–è€…èƒŒæ™¯ç‰©ä½“ï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œ3Då®ä¾‹åˆ†å‰²æ¥å»é™¤è¿™äº›å¹²æ‰°ï¼Œåªä¿ç•™ç‰©ä½“ä¸Šçš„ç‚¹ï¼Œç”¨æ¥è¿›è¡Œåç»­çš„ç‰©ä½“æ¡†ä¼°è®¡ï¼ˆç±»ä¼¼PointNetä¸­çš„å¤„ç†æ–¹å¼ï¼‰ã€‚è¿™ç§åŸºäºè§†æ¤çš„æ–¹æ³•ï¼Œå…¶ç¼ºç‚¹åœ¨äºæ¯ä¸ªè§†æ¤ä¸­åªèƒ½å¤„ç†ä¸€ä¸ªè¦æ£€æµ‹çš„ç‰©ä½“ï¼Œè¿™å¯¹äºæ‹¥æŒ¤çš„åœºæ™¯å’Œå°ç›®æ ‡ï¼ˆæ¯”å¦‚è¡Œäººï¼‰æ¥è¯´æ˜¯ä¸èƒ½æ»¡è¶³è¦æ±‚çš„ã€‚</p><p><img src="https://pic4.zhimg.com/80/v2-90fb34ae1106462e0a6025020cb8fe73_720w.webp" alt="https://pic4.zhimg.com/80/v2-90fb34ae1106462e0a6025020cb8fe73_720w.webp"></p><p>F-PointNetç½‘ç»œç»“æ„å›¾</p><p>é’ˆå¯¹è§†æ¤çš„ä¸Šè¿°é—®é¢˜ï¼Œ<strong>IPOD[3]æå‡ºé‡‡ç”¨2Dè¯­ä¹‰åˆ†å‰²æ¥æ›¿æ¢2Dç‰©ä½“æ£€æµ‹</strong>ã€‚é¦–å…ˆï¼Œå›¾åƒä¸Šçš„è¯­ä¹‰åˆ†å‰²ç»“æœè¢«ç”¨æ¥å»é™¤ç‚¹äº‘ä¸­çš„èƒŒæ™¯ç‚¹ï¼Œè¿™æ˜¯é€šè¿‡å°†<strong>ç‚¹äº‘æŠ•å½±åˆ°2Då›¾åƒç©ºé—´</strong>æ¥å®Œæˆçš„ã€‚æ¥ä¸‹æ¥ï¼Œåœ¨æ¯ä¸ªå‰æ™¯ç‚¹å¤„ç”Ÿæˆå€™é€‰ç‰©ä½“æ¡†ï¼Œå¹¶é‡‡ç”¨NMSå»é™¤é‡å çš„å€™é€‰æ¡†ï¼Œæœ€åæ¯å¸§ç‚¹äº‘å¤§çº¦ä¿ç•™500ä¸ªå€™é€‰æ¡†ã€‚åŒæ—¶ï¼ŒPointNet++ç½‘æ ¼è¢«ç”¨æ¥è¿›è¡Œç‚¹ç‰¹å¾æå–ã€‚æœ‰äº†å€™é€‰æ¡†å’Œç‚¹ç‰¹å¾ï¼Œæœ€åä¸€æ­¥é‡‡ç”¨ä¸€ä¸ªå°è§„æ¨¡çš„PointNet++æ¥é¢„æµ‹ç±»åˆ«å’Œå‡†ç¡®çš„ç‰©ä½“æ¡†ï¼ˆå½“ç„¶è¿™é‡Œä¹Ÿå¯ä»¥ç”¨åˆ«çš„ç½‘ç»œï¼Œæ¯”å¦‚MLPï¼‰ã€‚IPODåœ¨è¯­ä¹‰åˆ†å‰²çš„åŸºç¡€ä¸Šç”Ÿæˆäº†ç¨ å¯†çš„å€™é€‰ç‰©ä½“æ¡†ï¼Œå› æ­¤åœ¨å«æœ‰å¤§é‡ç‰©ä½“å’Œäº’ç›¸é®æŒ¡çš„åœºæ™¯ä¸­æ•ˆæœæ¯”è¾ƒå¥½ã€‚</p><p><img src="https://pic3.zhimg.com/80/v2-6b0a3c68cd36530e8c55c93147bd5bee_720w.webp" alt="https://pic3.zhimg.com/80/v2-6b0a3c68cd36530e8c55c93147bd5bee_720w.webp"></p><p>IPODç½‘ç»œç»“æ„å›¾</p><p>ä¸Šé¢ä¸¤ä¸ªæ–¹æ³•åˆ†åˆ«é€šè¿‡2Då›¾åƒä¸Šçš„ç‰©ä½“æ£€æµ‹å’Œè¯­ä¹‰åˆ†å‰²ç»“æœæ¥ç”Ÿæˆå€™é€‰æ¡†ï¼Œç„¶ååªåœ¨ç‚¹äº‘æ•°æ®ä¸Šè¿›è¡Œåç»­çš„å¤„ç†ã€‚<strong>SIFRNet[4]æå‡ºåœ¨è§†æ¤ä½“ä¸Šèåˆç‚¹äº‘å’Œå›¾åƒç‰¹å¾</strong>ï¼Œä»¥å¢å¼ºè§†æ¤ä½“æ‰€åŒ…å«çš„ä¿¡æ¯é‡ï¼Œç”¨æ¥è¿›ä¸€æ­¥æé«˜ç‰©ä½“æ¡†é¢„æµ‹çš„è´¨é‡ã€‚</p><p><img src="https://pic1.zhimg.com/80/v2-45b55a9b33b0645add1187ce290e83d4_720w.webp" alt="https://pic1.zhimg.com/80/v2-45b55a9b33b0645add1187ce290e83d4_720w.webp"></p><p>SIFRNetç½‘ç»œç»“æ„å›¾</p><p>è¿‘å¹´æ¥ï¼Œéšç€3Dç‰©ä½“æ£€æµ‹æŠ€æœ¯çš„å¿«é€Ÿå‘å±•ï¼Œ<strong>ç‰©ä½“å€™é€‰æ¡†çš„é€‰å–ä¹Ÿä»é€æ¸ä»2Då‘3Dè½¬å˜</strong>ã€‚**MV3D[5]**æ˜¯åŸºäº3Då€™é€‰æ¡†çš„ä»£è¡¨æ€§å·¥ä½œã€‚é¦–å…ˆï¼Œ<strong>å®ƒå°†3Dç‚¹äº‘æ˜ å°„åˆ°BEVè§†å›¾ï¼Œå¹¶åŸºäºæ­¤è§†å›¾ç”Ÿæˆ3Dç‰©ä½“å€™é€‰æ¡†</strong>ã€‚ç„¶åï¼Œå°†è¿™äº›3Då€™é€‰æ¡†æ˜ å°„åˆ°ç‚¹äº‘çš„å‰è§†å›¾ä»¥åŠå›¾åƒè§†å›¾ï¼Œå¹¶å°†ç›¸åº”çš„ç‰¹å¾è¿›è¡Œèåˆã€‚ç‰¹å¾èåˆæ˜¯ä»¥å€™é€‰æ¡†ä¸ºåŸºç¡€ï¼Œå¹¶é€šè¿‡ROI poolingæ¥å®Œæˆçš„ã€‚</p><p><img src="https://pic4.zhimg.com/80/v2-6c0177ef8bfd90bd77368d4ddb01cdf3_720w.webp" alt="https://pic4.zhimg.com/80/v2-6c0177ef8bfd90bd77368d4ddb01cdf3_720w.webp"></p><p>MV3Dç½‘ç»œç»“æ„å›¾</p><p>**AVOD[6]**çš„æ€è·¯ä¹Ÿæ˜¯åœ¨3Då€™é€‰æ¡†çš„åŸºç¡€ä¸Šèåˆå›¾åƒå’Œç‚¹äº‘ç‰¹å¾ã€‚<strong>ä½†æ˜¯åŸå§‹å€™é€‰æ¡†çš„ç”Ÿæˆå¹¶ä¸æ˜¯é€šè¿‡ç‚¹äº‘å¤„ç†å¾—åˆ°ï¼Œè€Œæ˜¯é€šè¿‡å…ˆéªŒçŸ¥è¯†åœ¨BEVè§†å›¾ä¸‹å‡åŒ€é‡‡æ ·ç”Ÿæˆçš„</strong>ï¼ˆé—´éš”0.5ç±³ï¼Œå¤§å°ä¸ºå„ä¸ªç‰©ä½“ç±»çš„å‡å€¼ï¼‰ã€‚ç‚¹äº‘æ•°æ®ç”¨æ¥è¾…åŠ©å»é™¤ç©ºçš„å€™é€‰æ¡†ï¼Œè¿™æ ·æœ€ç»ˆæ¯å¸§æ•°æ®ä¼šäº§ç”Ÿ8ä¸‡åˆ°10ä¸‡ä¸ªå€™é€‰æ¡†ã€‚è¿™äº›å€™é€‰æ¡†é€šè¿‡èåˆçš„å›¾åƒå’Œç‚¹äº‘ç‰¹å¾è¿›è¡Œè¿›ä¸€æ­¥ç­›é€‰åï¼Œä½œä¸ºæœ€ç»ˆçš„å€™é€‰å†é€å…¥ç¬¬äºŒé˜¶æ®µçš„æ£€æµ‹å™¨ã€‚<strong>å› æ­¤ï¼Œä¹Ÿå¯ä»¥è®¤ä¸ºAVODçš„å€™é€‰æ¡†æ˜¯åŒæ—¶åœ¨å›¾åƒå’Œç‚¹äº‘ä¸Šå¾—åˆ°çš„</strong>ã€‚</p><p><img src="https://pic4.zhimg.com/80/v2-06bd200bf426fc4b5fe3b6a4a8e37ba7_720w.webp" alt="https://pic4.zhimg.com/80/v2-06bd200bf426fc4b5fe3b6a4a8e37ba7_720w.webp"></p><p>AVODç½‘ç»œç»“æ„å›¾</p><h3 id="2-2-ç‰¹å¾å±‚èåˆ"><strong>2.2 ç‰¹å¾å±‚èåˆ</strong></h3><p>å†³ç­–+ç‰¹å¾å±‚èåˆçš„ç‰¹ç‚¹æ˜¯ä»¥ç‰©ä½“å€™é€‰æ¡†ä¸ºä¸­å¿ƒæ¥èåˆä¸åŒçš„ç‰¹å¾ï¼Œèåˆçš„è¿‡ç¨‹ä¸­ä¸€èˆ¬ä¼šç”¨åˆ°ROI poolingï¼ˆæ¯”å¦‚åŒçº¿æ€§æ’å€¼ï¼‰ï¼Œè€Œè¿™ä¸ªæ“ä½œä¼šå¯¼è‡´ç©ºé—´ç»†èŠ‚ç‰¹å¾çš„ä¸¢å¤±ã€‚**å¦å¤–ä¸€ç§æ€è·¯æ˜¯ç‰¹å¾å±‚èåˆï¼Œä¹Ÿå°±æ˜¯ç›´æ¥èåˆå¤šç§ç‰¹å¾ã€‚**æ¯”å¦‚è¯´å°†ç‚¹äº‘æ˜ å°„åˆ°å›¾åƒç©ºé—´ï¼Œä½œä¸ºå¸¦æœ‰æ·±åº¦ä¿¡æ¯çš„é¢å¤–é€šé“ä¸å›¾åƒçš„RGBé€šé“è¿›è¡Œåˆå¹¶ã€‚è¿™ç§æ€è·¯ç®€å•ç›´æ¥ï¼Œå¯¹äº2Dç‰©ä½“æ£€æµ‹æ¥è¯´æ•ˆæœä¸é”™ã€‚ä½†æ˜¯èåˆçš„è¿‡ç¨‹ä¸¢å¤±äº†å¾ˆå¤š3Dç©ºé—´ä¿¡æ¯ï¼Œå› æ­¤å¯¹äº3Dç‰©ä½“æ£€æµ‹æ¥è¯´æ•ˆæœå¹¶ä¸å¥½ã€‚ç”±äº3Dç‰©ä½“æ£€æµ‹é¢†åŸŸçš„è¿…é€Ÿå‘å±•ï¼Œ<strong>ç‰¹å¾å±‚èåˆä¹Ÿæ›´å€¾å‘äºåœ¨3Dåæ ‡ä¸‹å®Œæˆï¼Œè¿™æ ·å¯ä»¥ä¸º3Dç‰©ä½“æ£€æµ‹æä¾›æ›´å¤šä¿¡æ¯</strong>ã€‚</p><p>**ContFuse[7]é‡‡ç”¨è¿ç»­å·ç§¯ï¼ˆContinuous Convolutionï¼‰æ¥èåˆç‚¹äº‘å’Œå›¾åƒç‰¹å¾ã€‚èåˆè¿‡ç¨‹åœ¨BEVè§†å›¾ä¸‹å®Œæˆã€‚**å¯¹äºBEVä¸Šçš„ä¸€ä¸ªåƒç´ ï¼ˆç½‘æ ¼ï¼‰ï¼Œé¦–å…ˆåœ¨ç‚¹äº‘æ•°æ®ä¸­æ‰¾åˆ°å…¶Kä¸ªæœ€é‚»è¿‘çš„ç‚¹ï¼Œç„¶åå°†è¿™äº›3Dç©ºé—´ä¸­çš„ç‚¹æ˜ å°„åˆ°å›¾åƒç©ºé—´ï¼Œä»¥æ­¤å¾—åˆ°æ¯ä¸ªç‚¹çš„å›¾åƒç‰¹å¾ã€‚åŒæ—¶ï¼Œæ¯ä¸ªç‚¹çš„å‡ ä½•ç‰¹å¾åˆ™æ˜¯è¯¥ç‚¹åˆ°ç›¸åº”BEVåƒç´ çš„XYåç§»é‡ã€‚å°†å›¾åƒç‰¹å¾å’Œå‡ ä½•ç‰¹å¾åˆå¹¶ä½œä¸ºç‚¹ç‰¹å¾ï¼Œç„¶åæŒ‰ç…§è¿ç»­å·ç§¯çš„åšæ³•å¯¹å…¶è¿›è¡ŒåŠ æƒæ±‚å’Œï¼ˆæƒé‡ä¾èµ–äºXYåç§»é‡ï¼‰ï¼Œä»¥å¾—åˆ°ç›¸åº”BEVåƒç´ å¤„çš„ç‰¹å¾å€¼ã€‚å¯¹BEVçš„æ¯ä¸ªåƒç´ è¿›è¡Œç±»ä¼¼å¤„ç†ï¼Œå°±å¾—åˆ°äº†ä¸€ä¸ªBEVç‰¹å¾å›¾ã€‚è¿™æ ·å°±å®Œæˆäº†å›¾åƒç‰¹å¾åˆ°BEVè§†å›¾çš„è½¬æ¢ï¼Œä¹‹åå°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„ä¸æ¥è‡ªç‚¹äº‘çš„BEVç‰¹å¾è¿›è¡Œèåˆã€‚ContFuseä¸­åœ¨å¤šä¸ªç©ºé—´åˆ†è¾¨ç‡ä¸‹è¿›è¡Œäº†ä¸Šè¿°çš„ç‰¹å¾èåˆï¼Œä»¥æé«˜å¯¹ä¸åŒå¤§å°ç‰©ä½“çš„æ£€æµ‹èƒ½åŠ›ã€‚</p><p><img src="https://pic1.zhimg.com/80/v2-3947a9429eb1c72edf07a8ef296c1ac0_720w.webp" alt="https://pic1.zhimg.com/80/v2-3947a9429eb1c72edf07a8ef296c1ac0_720w.webp"></p><p>åˆ©ç”¨è¿ç»­å·ç§¯å°†å›¾åƒç‰¹å¾æŠ•å½±åˆ°BEVè§†å›¾</p><p>**PointPainting[8]**æŠŠç‚¹äº‘æŠ•å½±åˆ°å›¾åƒè¯­ä¹‰åˆ†å‰²çš„ç»“æœä¸­ï¼Œè¿™ä¸IPODä¸­çš„åšæ³•ç±»ä¼¼ã€‚ä½†æ˜¯ï¼Œ**PointPaintingæ²¡æœ‰åˆ©ç”¨è¯­ä¹‰åˆ†å‰²çš„ç»“æœæ¥åˆ†ç¦»å‰æ™¯ç‚¹ï¼Œè€Œæ˜¯ç›´æ¥å°†è¯­ä¹‰åˆ†å‰²çš„ä¿¡æ¯é™„åŠ åˆ°ç‚¹äº‘ä¸Šã€‚**è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œèåˆä¹‹åçš„æ•°æ®è¿˜æ˜¯ç‚¹äº‘ï¼ˆä½†æ˜¯å…·æœ‰æ›´ä¸ºä¸°å¯Œçš„è¯­ä¹‰ä¿¡æ¯ï¼‰ï¼Œå¯ä»¥é‡‡ç”¨ä»»ä½•ç‚¹äº‘ç‰©ä½“æ£€æµ‹ç½‘ç»œæ¥å¤„ç†ï¼Œæ¯”å¦‚PointRCNNï¼ŒVoxelNetï¼ŒPointPillarç­‰ç­‰ã€‚</p><p><img src="https://pic4.zhimg.com/80/v2-6df5b45a9eda063e9db991b0ae8290a7_720w.webp" alt="https://pic4.zhimg.com/80/v2-6df5b45a9eda063e9db991b0ae8290a7_720w.webp"></p><p>PointPaintingçš„èåˆæµç¨‹å›¾</p><p>PointPaintingä¸­é™„åŠ ç»™ç‚¹äº‘çš„æ˜¯2Då›¾åƒçš„è¯­ä¹‰ä¿¡æ¯ï¼Œè¿™å·²ç»æ˜¯é«˜åº¦æŠ½è±¡ä¹‹åçš„ä¿¡æ¯ï¼Œè€ŒåŸå§‹çš„å›¾åƒç‰¹å¾åˆ™è¢«ä¸¢å¼ƒäº†ã€‚ä»èåˆçš„è§’åº¦æ¥çœ‹ï¼Œåº•å±‚ç‰¹å¾çš„èåˆå¯ä»¥æ›´å¤§ç¨‹åº¦çš„ä¿ç•™ä¿¡æ¯ï¼Œåˆ©ç”¨ä¸åŒç‰¹å¾ä¹‹é—´çš„äº’è¡¥æ€§ï¼Œç†è®ºä¸Šè¯´ä¹Ÿå°±æ›´æœ‰å¯èƒ½æå‡èåˆçš„æ•ˆæœã€‚**MVX-Net[9]**åˆ©ç”¨ä¸€ä¸ªå®ç°è®­ç»ƒå¥½çš„2Då·ç§¯ç½‘ç»œæ¥æå–å›¾åƒç‰¹å¾ï¼Œç„¶åé€šè¿‡ç‚¹äº‘å’Œå›¾åƒä¹‹é—´çš„æ˜ å°„å…³ç³»å°†å›¾åƒç‰¹å¾é™„åŠ åˆ°æ¯ä¸ªç‚¹ä¸Šã€‚ä¹‹åå†é‡‡ç”¨VoxelNetæ¥å¤„ç†èåˆåçš„ç‚¹ç‰¹å¾ã€‚é™¤äº†è¿™ç§ç‚¹èåˆç­–ç•¥ï¼ŒMVX-Netè¿˜æå‡ºäº†åœ¨voxelå±‚æ¬¡ä¸Šèåˆï¼Œå…¶ä¸»è¦çš„ä¸åŒå°±åœ¨äºå°†voxelè€Œä¸æ˜¯pointæŠ•å½±åˆ°å›¾åƒç©ºé—´ï¼Œå› æ­¤å›¾åƒç‰¹å¾æ˜¯è¢«é™„åŠ åœ¨voxelä¹‹ä¸Šã€‚ä»å®éªŒç»“æœæ¥çœ‹ï¼Œpointèåˆæ¯”voxelèåˆç»“æœç•¥å¥½ï¼Œè¿™ä¹Ÿè¿›ä¸€æ­¥è¯´æ˜äº†è¾ƒä½çš„èåˆå±‚æ¬¡å¯èƒ½ä¼šå¸¦æ¥æ›´å¥½çš„æ•ˆæœã€‚</p><p><img src="https://pic1.zhimg.com/80/v2-0c67ac7786073e73df84c03c29804144_720w.webp" alt="https://pic1.zhimg.com/80/v2-0c67ac7786073e73df84c03c29804144_720w.webp"></p><p>MVX-Netä¸­çš„Pointèåˆæ–¹æ³•</p><p>**è¯­ä¹‰åˆ†å‰²ä»»åŠ¡ä¸­çš„èåˆä¸€èˆ¬éƒ½æ˜¯åœ¨ç‰¹å¾å±‚ä¸Šè¿›è¡Œï¼Œä¹‹å‰ä»‹ç»çš„ç‰¹å¾èåˆæ–¹æ³•ç†è®ºä¸Šæ¥è¯´å¯ä»¥ç”¨æ¥è¿›è¡Œè¯­ä¹‰åˆ†å‰²ã€‚**æ¯”å¦‚è¯´ï¼ŒContFuseåœ¨BEVç½‘æ ¼ä¸Šèåˆäº†å›¾åƒå’Œç‚¹äº‘ç‰¹å¾ï¼Œè¿™ä¸ªç‰¹å¾å°±å¯ä»¥ç”¨æ¥è¿›è¡Œç½‘æ ¼çº§åˆ«çš„è¯­ä¹‰åˆ†å‰²ï¼Œè€ŒPointPaintingå°†å›¾åƒç‰¹å¾é™„åŠ åˆ°ç‚¹äº‘ä¸Šï¼Œåç»­å¯ä»¥é‡‡ç”¨ä»»ä½•åŸºäºç‚¹äº‘è¯­ä¹‰åˆ†å‰²çš„ç®—æ³•æ¥å¯¹æ¯ä¸ªç‚¹è¿›è¡Œè¯­ä¹‰åˆ†ç±»ï¼Œç”šè‡³ä¹Ÿå¯ä»¥è¿›è¡Œå®ä¾‹åˆ†å‰²å’Œå…¨æ™¯åˆ†å‰²ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç›¸æœº </tag>
            
            <tag> æ¿€å…‰é›·è¾¾ </tag>
            
            <tag> ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Image Gallery</title>
      <link href="/2023/05/06/Image-Gallery/"/>
      <url>/2023/05/06/Image-Gallery/</url>
      
        <content type="html"><![CDATA[<div class="gallery-group-main">  <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://i.loli.net/2019/11/10/T7Mu8Aod3egmC4Q.png' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">å£ç´™</div>  <p>æ”¶è—çš„ä¸€äº›å£çº¸</p>  <a href='/Gallery/wallpaper'></a>  </figcaption>  </figure>    <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://i.loli.net/2019/12/25/8t97aVlp4hgyBGu.jpg' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">æ¼«å¨</div>  <p>å…³äºæ¼«å¨çš„å›¾ç‰‡</p>  <a href='/Gallery/marvel'></a>  </figcaption>  </figure>    <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://i.loli.net/2019/12/25/hOqbQ3BIwa6KWpo.jpg' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">OH MY GIRL</div>  <p>å…³äºOH MY GIRLçš„å›¾ç‰‡</p>  <a href='/Gallery/ohmygirl'></a>  </figcaption>  </figure>  </div>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2023/05/05/hello-world/"/>
      <url>/2023/05/05/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to Fanferâ€™s Blog(<a href="https://fanfer.top">https://fanfer.top</a>)! This is your very first post.</p><h2 id="quick-start">Quick Start</h2><h3 id="create-a-new-post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="run-server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="generate-static-files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="deploy-to-remote-sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p><h2 id="basic-usage">basic usage</h2><h3 id="å›¾åºŠæ›´æ–°">å›¾åºŠæ›´æ–°</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="comment"># å°†æ›´æ”¹æäº¤</span></span><br><span class="line">$ git add .</span><br><span class="line">$ git commit -m <span class="string">&quot;æ›´æ–°å›¾ç‰‡&quot;</span></span><br><span class="line">$ <span class="comment"># æ¨é€è‡³githubä»“åº“</span></span><br><span class="line">$ git push</span><br></pre></td></tr></table></figure><h3 id="éƒ¨ç½²æ›´æ–°">éƒ¨ç½²æ›´æ–°</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo clean; hexo generate; hexo deploy </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬”è®° </tag>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
